{"last_chapter_rule":"","pageList":[{"col_type":"movie_3","name":"è§„åˆ™å¤„ç†","path":"data","rule":"js:\nlet ParseRlue = $.require(\"ParseRlue\");\n\nfunction toRedirectTreating(config) {\n    return $.require(\"redirect\").doubleTreating(config);\n}\n\nfunction toRedirect(aliUrl, sharePwd) {\n    return $.require(\"redirect\").getModeUrl(aliUrl, sharePwd);\n}\n\nfunction getCompleteRule(rule) {\n    if (rule.ruleType === \"JSON\") {\n        let find = rule.find;\n        rule.find = (s, page) => {\n            let url = String(rule.basicUrl).replace(\"**\", encodeURIComponent(s)).replace(\"fypage\", page + \"\");\n            return ParseRlue.parseSearchJson(url, find);\n        }\n    } else if (rule.ruleType === \"HTML\") {\n        let find = rule.find;\n        rule.find = (s, page) => {\n            let url = String(rule.basicUrl).replace(\"**\", encodeURIComponent(s)).replace(\"fypage\", page + \"\");\n            return ParseRlue.parseSearchHtml(url, find);\n        }\n    } else {\n        let find = new Function(\"s\", \"page\", \"user\", \"basicUrl\", rule.find);\n        rule.find = (s, page) => find(s, page, rule.user || {}, rule.basicUrl || \"\");\n        /*if (rule.findAliUrl) {\n            rule.findAliUrl = new Function(\"input\", \"basicUrl\", rule.findAliUrl);\n        }*/\n    }\n    return rule;\n}\n$.exports.carryRule = function(rule, s, page, searchMode) {\n    rule = getCompleteRule(rule);\n    let list = rule.find(s, page);\n    if (!list) return [];\n\n    let descTips = \"â€œâ€œâ€â€\" + rule.name.fontcolor(\"#f13b66a\") + \"&nbsp;\";\n    let resList = [];\n\n    for (let it of list) {\n        if (it.skip) {\n            resList.push(it);\n            continue;\n        }\n        if (searchMode && !searchContains(it.title, s, true)) continue;\n        if (rule.findAliUrl) {\n            it.url = $(it.url).lazyRule(toRedirectTreating, {\n                findAliUrl: rule.findAliUrl,\n                basicUrl: rule.basicUrl,\n                name: rule.name,\n                author: rule.author,\n                aliUrl: it.url,\n                ruleType: rule.ruleType\n            });\n        } else {\n            it.url = $(\"#noLoading#\").lazyRule(toRedirect, it.url, it.sharePwd || \"\");\n        }\n        let title = it.title || \"\";\n        resList.push({\n            title: title.includes(\"â€œâ€œâ€â€\") ? title : \"â€œâ€œâ€â€\" + title.replace(new RegExp(\"<em>|</em>\", \"g\"), \"\").replace(new RegExp(\"(\" + s + \")\", \"gi\"), \"<strong><span style=\\\"color: #1E90FF\\\">$1</span></strong>\"),\n            desc: descTips + (it.desc || \"\"),\n            url: it.url,\n            pic_url: it.pic_url,\n            col_type: it.pic_url ? \"movie_1_vertical_pic\" : \"text_1\",\n            extra: Object.assign({\n                inheritTitle: false,\n                noPic: true\n            }, it.extra)\n        });\n    }\n    return resList;\n}\n$.exports.carrySRule = function(rule, s, page, searchMode) {\n    rule = getCompleteRule(rule);\n    let list = rule.find(s, page);\n    if (!list) return [];\n    let resList = [];\n    for (let it of list) {\n        if (it.skip) {\n            resList.push(it);\n            continue;\n        }\n        if (searchMode && !searchContains(it.title, s, true)) continue;\n        if (rule.findAliUrl) {\n            it.url = $(it.url).lazyRule(toRedirectTreating, {\n                findAliUrl: rule.findAliUrl,\n                basicUrl: rule.basicUrl,\n                name: rule.name,\n                author: rule.author,\n                aliUrl: it.url,\n                ruleType: rule.ruleType\n            });\n        } else {\n            it.url = $(\"#noLoading#\").lazyRule(toRedirect, it.url, it.sharePwd || \"\");\n        }\n        resList.push({\n            title: it.title,\n            desc: it.desc || \"\",\n            url: it.url,\n            pic_url: it.pic_url,\n            extra: Object.assign({\n                inheritTitle: false,\n                noPic: true\n            }, it.extra)\n        });\n    }\n    return resList;\n}\nlet size = 10;\n\nlet rules;\n\nfunction getRules(group) {\n    let rulesTmp;\n    if (!rules) {\n        rules = $.require(\"configs\").getUsefulJson();\n    }\n    if (group) {\n        rulesTmp = rules.filter(v => v.group === group);\n    } else {\n        rulesTmp = rules;\n    }\n    return rulesTmp;\n}\n$.exports.getAllData = function(group) {\n    return getRules(group);\n};\n$.exports.getData = function(page, rule, group) {\n    if (rule) {\n        if (page != null && page > 1) {\n            return getRules().filter(i => i.name == rule && i.page);\n        }\n        return getRules().filter(i => i.name == rule);\n    }\n    let rulesTmp = getRules(group);\n    let start = (page - 1) * size;\n    if (rulesTmp.length < start + 1) {\n        return [];\n    }\n    let len = size;\n    if (rulesTmp.length < page * size) {\n        len = rulesTmp.length - start;\n    }\n    return rulesTmp.slice(start, start + len);\n};\n$.exports.getNames = function(group) {\n    return getRules(group).map(it => [it.name, it.basicUrl]);\n};\n\n$.exports.getGroupNames = function() {\n    return Array.from(new Set(getRules().map(v => v.group))).filter(v => v);\n};\n$.exports.findModulo = function(input) {\n    let oriMods = [2, 3];\n    let mods = oriMods.map(v => input % v);\n    let zeroMods = mods.indexOf(0);\n\n    if (zeroMods > -1) {\n        return oriMods[zeroMods];\n    } else {\n        return oriMods[mods.indexOf(Math.max.apply(null, mods))];\n    }\n};"},{"col_type":"movie_3","name":"æœç´¢é¡µé¢","path":"sou","rule":"js:\nconst alitest = $.require(\"alitest\");\n\nfunction setClip() {\n    function getCopy() {\n        try {\n            const Context = android.content.Context;\n            const context = getCurrentActivity();\n            // è·å–ç³»ç»Ÿå‰ªè´´æ¿\n            let clipboard = context.getSystemService(Context.CLIPBOARD_SERVICE);\n            // è¿”å›æ•°æ®\n            let clipData = clipboard.getPrimaryClip();\n            if (clipData != null && clipData.getItemCount() > 0) {\n                // ä»æ•°æ®é›†ä¸­è·å–ï¼ˆç²˜è´´ï¼‰ç¬¬ä¸€æ¡æ–‡æœ¬æ•°æ®\n                let text = clipData.getItemAt(0).getText();\n                if (text != null) {\n                    return String(text.toString());\n                }\n            }\n            return null;\n        } catch (e) {\n            return null;\n        }\n    }\n    let text = getCopy() || \"\";\n    let url = alitest.matchAliUrl(text);\n    if (url) {\n        let cache = getItem(\"clipboardCache\", \"\");\n        if (url !== cache) {\n            d.push({\n                title: 'â€œâ€œâ€â€<font color=\"#13B61B\">â– </font><b>æ¸©é¦¨æç¤º<b>',\n                desc: \"æ£€æµ‹åˆ°å‰ªè´´æ¿å«æœ‰é˜¿é‡Œé“¾æ¥æ˜¯å¦æ‰“å¼€?\\n\" + url,\n                url: $(\"#noLoading#\").lazyRule((input, id) => {\n                    deleteItem(id + \"clipboard\");\n                    return \"hiker://page/aliyun?page=fypage&realurl=\" + encodeURIComponent(input) + \"&sharePwd=\";\n                }, url, id),\n                col_type: \"text_1\",\n                extra: {\n                    id: id + \"clipboard\",\n                    pageTitle: \"æ‰“å¼€é“¾æ¥\"\n                }\n            });\n            setItem(\"clipboardCache\", url);\n        }\n    }\n}\n\nfunction setPrepose() {\n    if (openMode == \"æœ¬åœ°è§£æ\") {\n        let aliTokensFilepath = $.require(\"hiker://page/tokenPath\").aliTokensFilepath;\n        let a = fetch(aliTokensFilepath);\n        if (!a || a == \"\") {\n            d.push({\n                title: '<font color=\"#13B61B\">â– </font><b>æ¸©é¦¨æç¤º<b>',\n                col_type: \"rich_text\",\n            });\n            d.push({\n                url: $(\"#noLoading#\").lazyRule(() => $.require(\"loginMode\")),\n                col_type: \"text_1\",\n                title: \"æœªæ£€æµ‹åˆ°ç™»å½•ä¿¡æ¯ï¼Œç‚¹æˆ‘è·³è½¬ç™»å½•è´¦å·é¡µé¢ï¼Œç™»å½•é˜¿é‡Œäº‘ç›˜è´¦å·åæ–¹å¯ä½¿ç”¨æœ¬åœ°è§£ææ¨¡å¼\",\n                extra: {\n                    pageTitle: \"ç™»å½•é˜¿é‡Œäº‘ç›˜\"\n                }\n            });\n        }\n    }\n    addListener(\"onClose\", $.toString(() => {\n        clearMyVar(\"s\");\n    }));\n    addListener(\"onRefresh\", $.toString(() => {\n        if (!getMyVar(\"refs\", \"\")) {\n            clearMyVar(\"s\");\n        }\n    }));\n}\n\nfunction setHead() {\n    d.push({\n        title: \"æœç´¢ï¼š\" + [\"é»˜è®¤\", \"ç²¾å‡†\"][searchMode],\n        url: $(\"#noLoading#\").lazyRule(() => {\n            setSearchMode(getSearchMode() ? 0 : 1);\n            refreshPage(false);\n            return \"hiker://empty\"\n        }),\n        col_type: \"icon_3_round_fill\",\n        pic_url: \"hiker://images/icon_search6\"\n    });\n    d.push({\n        title: \"æˆ‘çš„é˜¿é‡Œ\",\n        url: \"hiker://page/myaliyun?page=fypage\",\n        col_type: \"icon_3_round_fill\",\n        pic_url: \"hiker://images/icon_cloud6\",\n        extra: {\n            isHome: true\n        }\n    });\n    d.push({\n        title: \"è®¾ç½®|\" + openMode,\n        url: $([\"æ¨¡å¼ï¼šæœ¬åœ°è§£æ\", \"æ¨¡å¼ï¼šå®˜æ–¹APP\", \"ç™»å½•é˜¿é‡Œè´¦å·\", \"ç™»å½•ä¿¡æ¯\", \"è§„åˆ™ç®¡ç†\", \"æ”¯æŒä½œè€…\", \"ä½¿ç”¨ä»£ç†æœç´¢\", \"æ’­æ”¾æ¨¡å¼\", \"è·å–å¼¹å¹•æœç´¢è§„åˆ™\"], 1, \"äº‘ç®€è®¾ç½®\").select((ids) => {\n            if (\"è§„åˆ™ç®¡ç†\" == input) {\n                return \"hiker://page/ruleManage#noRecordHistory##noHistory#\";\n            }\n            if (\"æ”¯æŒä½œè€…\" == input) {\n                return \"hiker://page/Donate.v#noRecordHistory##noHistory#\";\n            }\n            if (\"ç™»å½•é˜¿é‡Œè´¦å·\" == input) {\n                return $.require(\"loginMode\");\n            }\n            if (\"ä½¿ç”¨ä»£ç†æœç´¢\" == input) {\n                let isdDelegate = !!getItem(\"isdDelegate\", \"\");\n                return $(\"å¼€å¯åå°ç¨‹åºåº•éƒ¨æœç´¢æ¡†å°†ä½¿ç”¨ä»£ç†æœç´¢\\nå½“å‰:\" + isdDelegate + \"\\nç‚¹å‡»ç¡®å®šå³å¯\" + (isdDelegate ? \"å…³é—­\" : \"å¼€å¯\")).confirm((isdDelegate) => {\n                    setItem(\"isdDelegate\", isdDelegate ? \"\" : \"1\");\n                    return \"toast://\" + (isdDelegate ? \"å·²å…³é—­\" : \"å·²å¼€å¯\");\n                }, isdDelegate);\n            }\n            if (\"è·å–å¼¹å¹•æœç´¢è§„åˆ™\" === input) {\n                let rule = {\n                    \"js\": JSON.stringify(\"hiker://page/loadDm?rule=\" + MY_RULE.title + \"&title=\") + \"+encodeURIComponent(playdata.title.split('-')[0]);\",\n                    \"name\": MY_RULE.title + \"å¼¹å¹•æœç´¢\"\n                };\n                return \"rule://\" + base64Encode(\"ï¿¥projection_screenï¿¥\" + JSON.stringify(rule));\n            }\n            if (\"æ’­æ”¾æ¨¡å¼\" === input) {\n                let modes = [\"è½¬ç \", \"åŸç”»\", \"åŸè½¬\"];\n                let mode = getItem(\"aliyun_playMode\", modes[0]);\n                let index = modes.indexOf(mode);\n                return $(modes, 1, \"æ’­æ”¾æ¨¡å¼\", index).select(() => {\n                    setItem(\"aliyun_playMode\", input);\n                    return \"toast://åˆ‡æ¢æˆåŠŸ\";\n                });\n            }\n            if (\"ç™»å½•ä¿¡æ¯\" == input) {\n                const {\n                    openTokensFilepath,\n                    aliTokensFilepath\n                } = $.require(\"tokenPath\");\n                if (!fileExist(aliTokensFilepath)) return \"toast://è¿˜æœªç™»é™†\";\n                let ali = request(aliTokensFilepath);\n                try {\n                    ali = JSON.parse(ali);\n                } catch (e) {\n                    deleteFile(aliTokensFilepath);\n                    return \"toast://è·å–å¤±è´¥\";\n                }\n                confirm({\n                    title: 'ç™»å½•ä¿¡æ¯',\n                    content: \"ç”¨æˆ·:\" + (ali.nick_name || ali.user_name || \"Tokenç™»å½•\") + \"\\nToken:\" + ali.refresh_token + \"\\n(å–æ¶ˆï¼šæ³¨é”€ç™»å½•ï¼›ç¡®å®šï¼šå¤åˆ¶Token)\",\n                    confirm: $.toString((token) => {\n                        return \"copy://\" + token;\n                    }, ali.refresh_token),\n                    cancel: $.toString((path1, path2) => {\n                        return $(\"ç¡®è®¤æ³¨é”€ç™»å½•\").confirm((path1, path2) => {\n                            deleteFile(path1);\n                            deleteFile(path2);\n                            refreshPage();\n                            return \"toast://å·²æˆåŠŸé€€å‡ºç™»é™†\";\n                        }, path1, path2);\n                    }, aliTokensFilepath, openTokensFilepath)\n                });\n                return;\n            }\n            input = input.replace(\"æ¨¡å¼ï¼š\", \"\");\n            setItem(\"openMode\", input);\n            updateItem(ids, {\n                title: \"è®¾ç½®|\" + input\n            });\n            if (input == \"å®˜æ–¹APP\") {\n                return \"toast://ä¿®æ”¹æˆåŠŸï¼Œè¯·ç¡®ä¿æ‰‹æœºæœ‰å®‰è£…é˜¿é‡Œäº‘ç›˜ç­‰å®˜æ–¹APP\";\n            }\n        }, id + \"mode\"),\n        col_type: \"icon_3_round_fill\",\n        pic_url: \"hiker://images/icon_menu6\",\n        extra: {\n            id: id + \"mode\"\n        }\n    });\n\n    d.push({\n        title: 'æœç´¢',\n        desc: 'è¯·è¾“å…¥å…³é”®è¯/é“¾æ¥',\n        col_type: 'input',\n        url: $.toString(() => {\n            input = input.trim();\n            if ($.require(\"alitest\").test(input)) {\n                clearMyVar(\"s\");\n                return \"hiker://page/aliyun?page=fypage&realurl=\" + encodeURIComponent(input) + \"&sharePwd=\";\n            }\n            putMyVar(\"s\", input);\n            refreshPage();\n            return \"hiker://empty\";\n        }),\n        extra: {\n            onChange: \"putMyVar('refs',input)\",\n            id: id + \"ss\",\n            defaultValue: s,\n            pageTitle: \"æ‰“å¼€é“¾æ¥\"\n        }\n    });\n}\n\nfunction setRuleItem() {\n    let rules = $.require(\"data\").getNames(ruleGroup);\n    d.push({\n        title: \"ğŸŒŸ\",\n        url: \"hiker://collection?rule=\" + MY_RULE.title,\n        col_type: \"scroll_button\",\n    }, {\n        title: \"ğŸ“Œ\" + ruleGroup,\n        url: $(\"#noLoading#\").lazyRule(() => {\n            let group = $.require(\"data\").getGroupNames();\n            let ruleGroup = getItem(\"ruleGroup\", \"\");\n            let index = group.indexOf(ruleGroup) + 1;\n            group.unshift(\"ğŸ’¡å…¨éƒ¨ğŸ’¡\");\n            let selectNum = $.require(\"data\").findModulo(group.length);\n            return $(group, selectNum, \"è¯·é€‰æ‹©åˆ†ç»„\", index).select(() => {\n                if (!MY_INDEX) {\n                    setItem(\"ruleGroup\", \"\");\n                } else {\n                    setItem(\"ruleGroup\", input);\n                }\n                clearItem(\"rule\");\n                refreshPage();\n            });\n        }),\n        col_type: \"scroll_button\"\n    }, {\n        title: \"\" == r ? \"â€œâ€œå…¨éƒ¨â€â€\" : \"å…¨éƒ¨\",\n        url: $(\"#noLoading#\").lazyRule((s, id) => {\n            let qr = getItem(\"rule\", \"\");\n            clearItem(\"rule\");\n            if (s) {\n                refreshPage();\n            } else {\n                updateItem(\"å…¨éƒ¨\" + id, {\n                    title: \"â€œâ€œå…¨éƒ¨â€â€\"\n                });\n                if (qr) {\n                    updateItem(id + qr, {\n                        title: qr\n                    });\n                }\n            }\n            return \"hiker://empty\";\n        }, s, id),\n        col_type: \"scroll_button\",\n        extra: {\n            id: \"å…¨éƒ¨\" + id\n        }\n    });\n    for (let [it, basicUrl] of rules) {\n        d.push({\n            title: it == r ? \"â€œâ€œ\" + it + \"â€â€\" : it,\n            url: $((getHome(basicUrl) || \"\") + \"#noLoading#\").lazyRule((r, s, id) => {\n                let qr = getItem(\"rule\", \"\");\n                setItem(\"rule\", r);\n                if (s) {\n                    refreshPage();\n                } else {\n                    updateItem(qr ? (id + qr) : (\"å…¨éƒ¨\" + id), {\n                        title: qr || \"å…¨éƒ¨\"\n                    });\n                    updateItem(id + r, {\n                        title: \"â€œâ€œ\" + r + \"â€â€\"\n                    });\n                }\n                return \"hiker://empty\";\n            }, it, s, id),\n            col_type: \"scroll_button\",\n            extra: {\n                id: id + it\n            }\n        });\n    }\n\n}\n\nfunction record() {\n    let history = storage0.getItem(\"searchHistory\", []);\n    let ii = history.indexOf(s);\n    if (ii > -1) {\n        history.splice(ii, 1);\n    }\n    if (history.length > 20) {\n        history.splice(history.length - 1, 1);\n    }\n    history.unshift(s);\n    storage0.setItem(\"searchHistory\", history);\n}\n\nfunction searchEnd() {\n    let p = MY_PAGE;\n    let data = $.require(\"data\").getData(p, r, ruleGroup);\n    let pageid = id + \"ypj-page\" + p;\n    if (data.length > 0) {\n        d.push({\n            title: \"åŠ è½½ç¬¬\" + p + \"é¡µä¸­ï¼Œè¿›åº¦ï¼š1/\" + data.length,\n            col_type: \"text_center_1\",\n            extra: {\n                id: pageid\n            }\n        });\n    }\n    setResult(d);\n    if (data.length > 0) {\n        //å¤šçº¿ç¨‹åŠ è½½        \n        let realPage = \"\" == r ? 1 : p;\n        let tasks = data.map(it => {\n            return {\n                func: function(rule) {\n                    try {\n                        return $.require(\"data\").carryRule(rule, s, realPage, searchMode);\n                    } catch (e) {\n                        log(rule.name + \":\" + e.toString());\n                        /*if(data.length===1&&p===1){\n                            return [{\n                                title:\"â€œâ€œ\"+rule.name+\" ERRORâ€â€\",\n                                desc: e.toString(),\n                                col_type:\"text_center_1\",\n                                url:\"hiker://empty\",\n                                extra:{\n                                    lineVisible: false\n                                }\n                            }];\n                        }*/\n                    }\n                    //return rule.find(s, realPage);\n                },\n                param: it,\n                id: \"rule@\" + it.name\n            }\n        });\n\n        batchExecute(tasks, {\n            func: function(param, id, error, result) {\n                param.i += 1;\n                if (Array.isArray(result)) {\n                    deleteItem(\"_nothave\");\n                    addItemBefore(pageid, result);\n                }\n                if (param.i === param.all) {\n                    if (!result || !result.length) {\n                        deleteItem(\"_nothave\");\n                        addItemBefore(pageid, {\n                            col_type: \"text_center_1\",\n                            url: \"hiker://empty\",\n                            title: \"â€œâ€œâ€â€\" + \"~~~ä»€ä¹ˆèµ„æºéƒ½æ²¡æœ‰å“¦~~~\".fontcolor(\"Gray\"),\n                            extra: {\n                                lineVisible: false,\n                                id: \"_nothave\"\n                            }\n                        });\n                    }\n                    deleteItem(pageid);\n                } else {\n                    updateItem(pageid, {\n                        title: \"åŠ è½½ç¬¬\" + MY_PAGE + \"é¡µä¸­ï¼Œè¿›åº¦ï¼š\" + (param.i + 1) + \"/\" + param.all,\n                        col_type: \"text_center_1\",\n                        url: \"hiker://empty\"\n                    });\n                }\n            },\n            param: {\n                all: data.length,\n                i: 0,\n            }\n        })\n    }\n}\n\nfunction setHistory() {\n    d.push({\n        title: '<span style=\"color:#ff6601\"><b>å†å²è®°å½•</b></span>',\n        pic_url: \"hiker://images/icon_clock\",\n        col_type: \"avatar\",\n        url: $([\"æ¸…é™¤æœç´¢è®°å½•\", \"æ‰“å¼€è§‚çœ‹è®°å½•\"]).select((id) => {\n            if (input === \"æ¸…é™¤æœç´¢è®°å½•\") {\n                return $(\"ç¡®å®šæ¸…é™¤å…¨éƒ¨æœç´¢è®°å½•ï¼Ÿ\").confirm((id) => {\n                    clearItem(\"searchHistory\");\n                    deleteItemByCls(id + \":key\");\n                    addItemAfter(id + \":searchHistory\", {\n                        col_type: \"text_center_1\",\n                        url: \"hiker://empty\",\n                        title: \"â€œâ€œâ€â€\" + \"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰å“¦~~~\".fontcolor(\"Gray\"),\n                        extra: {\n                            cls: id + \":key\",\n                            lineVisible: false\n                        }\n                    });\n                }, id);\n            } else {\n                return \"hiker://history?rule=\" + MY_RULE.title;\n            }\n        }, id),\n        extra: {\n            id: id + \":searchHistory\",\n        }\n    });\n\n    let history = storage0.getItem(\"searchHistory\", []);\n    let i = 0;\n    for (let key of history) {\n        d.push({\n            title: key,\n            url: $(\"#noLoading#\").lazyRule((id, key) => {\n                let extra = findItem(id + \"ss\").extra;\n                extra.defaultValue = key;\n                updateItem({\n                    extra: extra\n                });\n                return \"hiker://empty\";\n            }, id, key),\n            col_type: \"flex_button\",\n            extra: {\n                id: id + \":key:\" + key,\n                cls: id + \":key\",\n                longClick: [{\n                    title: \"åˆ é™¤å…³é”®è¯:\" + key,\n                    js: $.toString((id, key, i) => {\n                        let history = storage0.getItem(\"searchHistory\", []);\n                        history.splice(i, 1);\n                        storage0.setItem(\"searchHistory\", history);\n                        deleteItem(id + \":key:\" + key);\n                        //toast();\n                    }, id, key, i)\n                }]\n            }\n        });\n        i++;\n    }\n    if (history.length === 0) {\n        d.push({\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            title: \"â€œâ€œâ€â€\" + \"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰å“¦~~~\".fontcolor(\"Gray\"),\n            extra: {\n                cls: id + \":key\",\n                lineVisible: false\n            }\n        });\n    }\n}\n\nfunction setTrendingTabEnd() {\n    let hotClass = {\n        \"ç™¾åº¦\": {\n            \"ç”µè§†å‰§\": \"teleplay\",\n            \"ç”µå½±\": \"movie\"\n        },\n        \"å¤¸å…‹\": {\n            \"ç”µè§†å‰§\": \"ç”µè§†å‰§\",\n            \"ç”µå½±\": \"ç”µå½±\",\n            \"åŠ¨æ¼«\": \"åŠ¨æ¼«\",\n            \"ç»¼è‰º\": \"ç»¼è‰º\"\n        }\n    };\n    let dataSource = Object.keys(hotClass);\n    let selectsource = getItem(\"dataSource\", dataSource[0]);\n    let hotkeys = Object.keys(hotClass[selectsource]);\n    let selectkey = getItem(\"hotkey\", hotkeys[0]);\n    let tabkey = hotClass[selectsource][selectkey];\n\n    d.push({\n        title: '<span style=\"color:#ff6601\"><b>' + selectsource + selectkey + 'çƒ­æœ</b></span>',\n        url: $(hotkeys, 1, \"åˆ‡æ¢çƒ­æœ\").select(() => {\n            setItem(\"hotkey\", input);\n            refreshPage(false);\n            return \"toast://å·²åˆ‡æ¢ä¸º\" + input;\n        }),\n        col_type: \"avatar\",\n        pic_url: \"hiker://images/icon_fire\",\n        extra: {\n            longClick: [{\n                title: \"åˆ‡æ¢æ•°æ®æº\",\n                js: $.toString((dataSource) => {\n                    return $(dataSource, 1, \"åˆ‡æ¢æ•°æ®æº\").select(() => {\n                        setItem(\"dataSource\", input);\n                        clearItem(\"hotkey\");\n                        refreshPage(false);\n                        return \"toast://å·²åˆ‡æ¢ä¸º\" + input;\n                    });\n                }, dataSource)\n            }]\n        }\n    });\n    d.push({\n        title: \"æ­£åœ¨åŠ è½½...\",\n        url: \"hiker://empty\",\n        col_type: \"text_center_1\",\n        extra: {\n            id: id + \":hotkey\",\n            lineVisible: false\n        }\n    });\n    setResult(d);\n    let sd = [];\n    let setSearchKey = name => {\n        putMyVar('s', name);\n        refreshPage();\n        return 'hiker://empty'\n    };\n\n    let getTitle = (i, name) => {\n        let color;\n        switch (i) {\n            case 0:\n                color = \"#ff3300\";\n                break;\n            case 1:\n                color = \"#ff6600\";\n                break;\n            case 2:\n                color = \"#ff9900\"\n                break;\n            default:\n                color = \"black\";\n        }\n        return \"â€œâ€œâ€â€\" + String(i + 1).fontcolor(color) + \"\\t\\t\\t\" + name;\n    }\n    try {\n        switch (selectsource) {\n            case \"ç™¾åº¦\":\n                var json = request('https://top.baidu.com/api/board?platform=wise&tab=' + tabkey + '&tag=%7B%22category%22:%22%E5%85%A8%E9%83%A8%E7%B1%BB%E5%9E%8B%22%7D', {\n                    headers: {\n                        'User-Agent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Mobile Safari/537.36',\n                        'Host': 'top.baidu.com',\n                        'Accept': 'application/json, text/plain, */*',\n                        'Accept-Language': 'zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7',\n                        'Accept-Encoding': 'gzip, deflate, br',\n                        'Referer': 'https://top.baidu.com/board?tab=novel',\n                    }\n                });\n                //var s = Date.now();\n                var list = JSON.parse(json).data.cards[0].content;\n                for (let i = 0; i < list.length; i++) {\n                    let item = list[i];\n                    let name = item.word + ' (' + item.show[2] + ')';\n                    let des = item.desc;\n                    sd.push({\n                        title: getTitle(i, name),\n                        url: $('#noLoading#').lazyRule(setSearchKey, item.word),\n                        desc: des,\n                        img: item.img,\n                        col_type: \"movie_1_vertical_pic\"\n                    });\n                }\n                break;\n            case \"å¤¸å…‹\":\n                var json = request(\"https://news.myquark.cn/v2/toplist/movie?&channel=\" + tabkey + \"&rank_type=%E6%9C%80%E7%83%AD\");\n                var xmlData = (JSON.parse(json).data || \"\").replace(/title>/g, \"h_title>\").replace(/src>/g, \"h_src>\").replace(/area>/g, \"h_area\");\n                var list = pdfa(xmlData, \"body&&item\");\n                var getText = t => t;\n                var trend = [\"ã„§\", \"â†‘\", \"â†“\"];\n                //var s = Date.now();\n                for (let i = 0; i < list.length; i++) {\n                    let item = list[i];\n                    let name = pdfh(item, \"h_title&&Text\");\n                    let des = \"çƒ­åº¦ï¼š\" + pdfh(item, \"hot_score&&Text\") + \" \" + trend.at(pdfh(item, \"hot_trend&&Text\")) +\n                        \"\\nè¯„åˆ†ï¼š\" + pdfh(item, \"score_avg&&Text\").replace(/^0$/, \"æš‚æ— è¯„åˆ†\") +\n                        \"\\n\" + pdfh(item, \"year&&Text\") + \"Â·\" + pdfh(item, \"h_area&&Text\") + \"Â·\" + pdfh(item, \"category&&Text\").replace(\",\", \"Â·\");\n                    sd.push({\n                        title: getTitle(i, name),\n                        url: $('#noLoading#').lazyRule(setSearchKey, name),\n                        desc: des,\n                        img: pdfh(item, \"h_src&&Text\"),\n                        col_type: \"movie_1_vertical_pic\"\n                    });\n                }\n                break;\n        }\n        addItemAfter(id + \":hotkey\", sd);\n    } catch (e) {\n        log(e.toString());\n    } finally {\n        deleteItem(id + \":hotkey\");\n    }\n}\nlet r = getItem(\"rule\", \"\");\nlet hideSetting = MY_PARAMS.hideSetting || getParam(\"hideSetting\", \"\") === \"true\";\nlet s = getMyVar('s', '') || MY_PARAMS.searchTerms || decodeURIComponent(getParam(\"searchTerms\", \"\"));\nlet searchMode = getSearchMode();\nlet openMode = getItem(\"openMode\", \"æœ¬åœ°è§£æ\");\nlet id = Date.now() + MY_RULE.title;\nlet ruleGroup = getItem(\"ruleGroup\", \"\");\nlet d = [];\nif (MY_PAGE === 1) {\n    setPrepose();\n    if (!hideSetting) {\n        setClip();\n        setHead();\n    }\n    setRuleItem();\n    if (!s) {\n        setHistory();\n    }\n}\nif (s) {\n    record();\n    searchEnd();\n} else if (MY_PAGE === 1) {\n    setTrendingTabEnd();\n} else {\n    setResult([]);\n}"},{"col_type":"movie_3","name":"ç½‘é¡µæµè§ˆ","path":"ysfx","rule":"js:\nvar d = [];\n\nlet openMode = getItem(\"openMode\");\nlet rule = MY_RULE.title;\nlet url = decodeURIComponent(getParam(\"webUrl\",\"\"));\n\nfunction intercept(rule, origin, openMode) {\n    let host = origin.replace(new RegExp(\"http://|https://\"), \"\").split(\"/\")[0];\n    let hosts = host.split(\".\");\n    if (hosts.length > 2) {\n        host = hosts[hosts.length - 2] + \".\" + hosts[hosts.length - 1];\n    }\n    if (input.startsWith(\"magnet\")) {\n        confirm({\n            title: \"æ¸©é¦¨æç¤º\",\n            content: \"æ£€æµ‹åˆ°æ–°çš„ç£é“¾åœ°å€ï¼Œç‚¹å‡»ç¡®å®šæŒ‰é’®å³å¯æ’­æ”¾ï¼Œç‚¹å‡»å–æ¶ˆæŒ‰é’®å¯ä»¥å¤åˆ¶é“¾æ¥\",\n            confirm: $.toString((mag) => {\n                return mag;\n            }, input),\n            cancel: $.toString((mag) => {\n                return \"copy://\" + mag\n            }, input)\n        });\n        return true;\n    } else if ($.require(\"alitest?rule=\"+rule).test(input) && openMode != \"å®˜æ–¹APP\") {\n        log(input);\n        if (input.includes('checkurl?url=') && input.includes('&urlrefer')) {\n            input = decodeURIComponent(input.split('&urlrefer')[0].split('checkurl?url=')[1]);\n            //log('è´´å§'+input);\n        }\n        return $.toString((url, rule) => {\n            fy_bridge_app.open(JSON.stringify({\n                title: \"é˜¿é‡Œäº‘ç›˜\",\n                url: \"hiker://page/aliyun?page=fypage&realurl=\" + encodeURIComponent(url) + \"&rule=\" + rule,\n            }))\n        }, input, rule);\n    } else if(input.includes(\"quark.cn/s/\")&&fetch(\"hiker://home@Quark.ç®€\") != \"null\"){\n        return $.toString((url) => {\n            fy_bridge_app.open(JSON.stringify({\n                title: \"å¤¸å…‹ç½‘ç›˜\",\n                url: \"hiker://page/quarkList?rule=Quark.ç®€&realurl=\" + encodeURIComponent(url) + \"&sharePwd=\",\n            }))\n        },input);\n    } else if (/\\.(mp3|flac|m4a)$/.test(input)) {\n        log(input);\n        return $.toString((url, rule) => {\n            fy_bridge_app.playVideo(url);\n        }, input, rule);\n    } else if (!input.includes(host) && input.startsWith(\"http\")) {\n        log(input);\n        return $.toString((url, rule) => {\n            fy_bridge_app.open(JSON.stringify({\n                title: \"è¯¦æƒ…\",\n                url: \"hiker://page/ysfx?webUrl=\"+encodeURIComponent(url)+\"&rule=\"+rule,\n            }))\n        }, input, rule);\n    } else if (!input.startsWith(\"http\")) {\n        log(input);\n        //èƒ½å”¤èµ·APPçš„ç™½åå•\n        let white = [\n            \"qklink\",\n            \"bdnetdisk\",\n            \"xunleiapp\",\n            \"smartdrive\"\n        ];\n        let inWhite = white.filter(it => input.startsWith(it)).length > 0;\n        if (!inWhite) {\n            return false;\n        }\n        return $.toString((url, rule) => {\n            fy_bridge_app.openThirdApp && fy_bridge_app.openThirdApp(url);\n        }, input, rule);\n    }\n}\n\nfunction loadJs() {\n    try {\n        if (document.title && document.title.length) {\n            let r = $$$().lazyRule((t) => {\n                setPageTitle(t);\n            }, document.title);\n            fy_bridge_app.parseLazyRule(r);\n        }\n    } catch (e) {\n        fy_bridge_app.log(e.toString());\n    }\n}\n\nd.push({\n    url: url,\n    col_type: \"x5_webview_single\",\n    desc: \"100%&&float\",\n    extra: {\n        urlInterceptor: $.toString(intercept, rule, getHome(url), openMode),\n        js: $.toString(loadJs),\n        canBack: true,\n        jsLoadingInject: true,\n        floatVideo: true\n    }\n});\n\nsetResult(d);"},{"col_type":"movie_3","name":"é˜¿é‡ŒLazy","path":"alilazy","rule":"const AliAccessApi = $.require(\"aliPlayApi\");\nconst {\n    openTokensFilepath,\n    aliTokensFilepath\n} = $.require(\"tokenPath\");\n\nfunction aliM3u8Proxy(fileId, shareId, sharePwd, shareToken, aliToken, title) {\n    let playmode = (MY_PARAMS.mode&&MY_PARAMS.mode[0])||\"\";\n    let suffix = playmode ? \"media.m3u8\" : \"ref_task.m3u8\";\n    let urlname = playmode ? \"url\" : \"preview_url\";\n    let cacheFilePath = \"hiker://files/_cache/\" + fileId + MY_PARAMS.timestamp[0]+ \".m3u8\"\n    //è¿‡æœŸè·å–æ’­æ”¾åŸå§‹é“¾æ¥\n    function getAliPlayUrl(fileId, line) {\n        let aliurl;\n        try {\n            const AliAccessApi = $.require(\"hiker://page/aliPlayApi?rule=\" + title);\n            let aliAccessApi = AliAccessApi.createDefault(shareId, sharePwd, shareToken, aliToken, null, title);\n            let playUrlList = (MY_PARAMS.mode ? aliAccessApi.getAllVideoTemPlayUrl(fileId, true).preview : aliAccessApi.getShareVideoPreview(fileId)) || [];\n\n            aliurl = playUrlList.find(v => v.template_id == line)[urlname];\n        } catch (e) {\n            log(e.toString());\n            throw e;\n        }\n        return aliurl;\n    }\n\n    function getM3u8Content(playurl) {\n        //media.m3u8\n        let home = playurl.split(suffix)[0];\n        let f = fetch(playurl, {\n            headers: {\n                \"User-Agent\": PC_UA,\n                \"Referer\": \"https://www.aliyundrive.com/\"\n            },\n            timeout: 3000\n        }).split(\"\\n\");\n        let ff = f.map(it => {\n            if (it.startsWith(\"media-\")) {\n                return \"/proxy?url=\" + base64Encode(home + it)+\"&timestamp=\"+MY_PARAMS.timestamp[0]+\"&mode=\"+playmode;\n            }\n            return it;\n        }).join(\"\\n\");\n\n        writeFile(cacheFilePath, ff);\n        return ff;\n    }\n\n    function updateTsUrl(url) {\n        let fid = url.split('&f=')[1].split('&')[0];\n        //log('sfid-' + fid);\n        let f = fetch(cacheFilePath).split(\"\\n\");\n        f.forEach(it => {\n            if (it && it.startsWith('/proxy?url=')) {\n                let furl = base64Decode(it.replace('/proxy?url=', '').split(\"&\")[0]);\n                if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\n                    url = furl;\n                }\n            }\n        })\n        let expires = url.split('x-oss-expires=')[1].split('&')[0];\n        const lasttime = parseInt(expires) - Date.now() / 1000;\n        if (lasttime < 60) {\n            //log('è¿‡æœŸæ›´æ–°')\n            let line = url.split('/media')[0]; //å–ä¹‹å‰æ’­æ”¾çš„tsæ®µçº¿è·¯\n            line = line.substring(line.lastIndexOf('/') + 1);\n            let f = getM3u8Content(getAliPlayUrl(fid, line)).split(\"\\n\");\n            f.forEach(it => {\n                if (it && it.startsWith('/proxy?url=')) {\n                    let furl = base64Decode(it.replace('/proxy?url=', ''));\n                    if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\n                        url = furl;\n                    }\n                }\n            })\n\n        }\n        return url;\n    }\n    try {\n        let url = base64Decode(MY_PARAMS.url[0]);\n        if (url.includes(\".ts\")) {\n            return JSON.stringify({\n                statusCode: 302,\n                headers: {\n                    \"Location\": updateTsUrl(url),\n                    \"User-Agent\": PC_UA,\n                    \"Referer\": \"https://www.aliyundrive.com/\"\n                }\n            });\n        } else {\n            let templateId = MY_PARAMS.templateId[0];\n            if(fileExist(cacheFilePath)){\n                return getM3u8Content(getAliPlayUrl(fileId, templateId));\n            }else{\n                return getM3u8Content(url);\n            }\n        }\n    } catch (e) {\n        log(\"#ä»£ç†æ’­æ”¾å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n    }\n}\nconst transcoding = {\n    UHD: \"4K è¶…æ¸…\",\n    QHD: \"2K è¶…æ¸…\",\n    FHD: \"1080 å…¨é«˜æ¸…\",\n    HD: \"720 é«˜æ¸…\",\n    SD: \"540 æ ‡æ¸…\",\n    LD: \"360 æµç•…\"\n};\n\nfunction getVideo(aliAccessApi, fileId) {\n\n    let playUrlList = aliAccessApi.getShareVideoPreview(fileId) || [];\n\n    let serverAddress = startProxyServer($.toString(aliM3u8Proxy, fileId, aliAccessApi.shareId, aliAccessApi.sharePwd, aliAccessApi.shareToken, aliAccessApi.aliToken, MY_RULE.title));\n\n    if (playUrlList.length > 0) {\n        let urls = [],\n            names = [];\n        playUrlList.forEach((item) => {\n            urls.push(serverAddress + \"?url=\" + base64Encode(item.preview_url) + \"&timestamp=\"+Date.now()+\"&templateId=\" + item.template_id + \"#.m3u8\");\n            names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\n        });\n        let heads = new Array(playUrlList.length).fill({\n            'Referer': 'https://www.aliyundrive.com/'\n        });\n        return {\n            urls: urls,\n            names: names,\n            headers: heads,\n        };\n    } else {\n        return {};\n    }\n\n}\n\nfunction getSourceTransfer(aliAccessApi, fileId) {\n    let playUrlInfo = aliAccessApi.getAllVideoTemPlayUrl(fileId);\n    let playUrlList = playUrlInfo.preview;\n\n    let serverAddress = startProxyServer($.toString(aliM3u8Proxy, fileId, aliAccessApi.shareId, aliAccessApi.sharePwd, aliAccessApi.shareToken, aliAccessApi.aliToken, MY_RULE.title));\n    if (playUrlList.length > 0) {\n        let urls = [],\n            names = [];\n        playUrlList.forEach((item) => {\n            urls.push(serverAddress + \"?url=\" + base64Encode(item.url) + \"&mode=1&timestamp=\"+Date.now()+\"&templateId=\" + item.template_id + \"#.m3u8\");\n            names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\n        });\n        urls.push(playUrlInfo.origin);\n        names.push(\"åŸç”»\");\n        let heads = new Array(playUrlList.length).fill({\n            'Referer': 'https://www.aliyundrive.com/'\n        });\n        return {\n            urls: urls,\n            names: names,\n            headers: heads,\n        };\n    } else {\n        return {};\n    }\n}\n\nfunction getPlayFormat(playUrl, title) {\n    return {\n        names: [title],\n        urls: [playUrl + \"#isVideo=true##ignoreMusic=true#\"],\n        headers: [{\n            'Referer': 'https://www.aliyundrive.com/',\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36\"\n        }]\n    };\n}\n\n\n$.exports = function(shareId, sharePwd, shareToken, fileId, cate, zimu) {\n    if (!fileExist(aliTokensFilepath)) {\n        toast(\"è¯·å…ˆç™»é™†ç™»å½•è´¦å·\");\n        return \"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\";\n    }\n    let aliToken = $.require(aliTokensFilepath);\n    if (cate === \"video\") {\n        let playList = [];\n        let aliAccessApi;\n        let playMode = getItem(\"aliyun_playMode\", \"è½¬ç \");\n        try {\n            aliAccessApi = AliAccessApi.createDefault(shareId, sharePwd, shareToken, aliToken);\n            if (playMode === \"è½¬ç \") {\n                playList = getVideo(aliAccessApi, fileId) || {};\n            } else if (playMode === \"åŸç”»\") {\n                playList = getPlayFormat(aliAccessApi.getVideoTemPlayUrl(fileId), playMode);\n            } else if (playMode === \"æé€ŸåŸç”»\") {\n                playList = getPlayFormat(aliAccessApi.getVideoTemPlayUrl(fileId) + \"#fastPlayMode##threads=\" + getItem(\"speedThread\", \"10\") + \"#\", playMode);\n            } else if (playMode === \"åŸè½¬\") {\n                playList = getSourceTransfer(aliAccessApi, fileId);\n            }\n        } catch (e) {\n            log(\"#\" + playMode + \"æ’­æ”¾å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n            if (e.code === \"InvalidParameter.RefreshToken\") {\n                toast(\"ç™»é™†è¿‡æœŸï¼Œè¯·é‡æ–°ç™»é™†\");\n                return \"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\";\n            } else if (e.code === \"QuotaExhausted.Drive\") {\n                return \"toast://ç½‘ç›˜ç©ºé—´ä¸è¶³ï¼Œæ— æ³•æ’­æ”¾è¯·æ¸…ç†ã€‚\";\n            }\n            return \"toast://æ’­æ”¾å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å·²æ‰“å°ã€‚\\nè¯·æŸ¥çœ‹æ—¥å¿—(LOG)\";\n        }\n        let mountsub = storage0.getMyVar('mountzimu', {});\n        if (Object.keys(mountsub).length > 0) {\n            zimu = mountsub;\n        }\n        let subtitle;\n        if (Object.keys(zimu || {}).length > 0 && playList && playList.urls && playList.urls.length > 0) {\n            java.lang.Thread.sleep(100);\n            try {\n                var zmurl = aliAccessApi.getVideoTemPlayUrl(zimu.file_id);\n                let path = 'hiker://files/cache/äº‘ç›˜å›/sub.' + zimu.ext;\n                downloadFile(zmurl, path, {\n                    'Referer': 'https://www.aliyundrive.com/'\n                });\n                subtitle = getPath(path);\n            } catch (e) {\n                toast(\"å­—å¹•åŠ è½½å¤±è´¥\");\n                log(e.message);\n            }\n        }\n        let dmlist = storage0.getMyVar(\"dmlist\", []);\n        let dmlist_cache = getMyVar(\"dmlist_cache\", \"\");\n        if (dmlist_cache && dmlist_cache.startsWith(fileId + \"#\")) {\n            playList.danmu = dmlist_cache.replace(fileId + \"#\", \"\");\n        } else if (dmlist.length > 0) {\n            playList.danmu = \"hiker://files/cache/danmu/\" + dmlist.splice(0, 1)[0];\n            putMyVar(\"dmlist_cache\", fileId + \"#\" + playList.danmu);\n            storage0.putMyVar(\"dmlist\", dmlist);\n            if (dmlist.length === 0) {\n                toast(\"å¼¹å¹•åˆ—è¡¨å·²å…¨éƒ¨æŒ‚è½½\");\n            }\n        } /*else {\n            playList.danmu = getVar(\"dm_share\", \"\");\n        }*/\n        playList.subtitle = subtitle;\n        return JSON.stringify(playList);\n    }\n\n    let aliAccessApi = AliAccessApi.createDefault(shareId, sharePwd, shareToken, aliToken, null);\n    let url = aliAccessApi.getVideoTemPlayUrl(fileId);\n\n    if (cate === \"image\") {\n        return url + \"#.jpg\";\n    } else if (cate === \"audio\") {\n        return url + \"#isMusic=true#\";\n    } else {\n        return \"download://\" + url;\n    }\n}"},{"col_type":"movie_3","name":"é˜¿é‡Œåˆ—è¡¨","path":"aliyun","rule":"js:\n//@author LoyDgIk\nconst AliShareApi = $.require(\"AliApi\");\n\n\nlet openAPIList = [\"alist\", \"drive\", \"tvbox\", \"XBY\", \"TV\"];\n\nlet realurl = decodeURIComponent(getParam(\"realurl\", \"\")).split(\"?\")[0];\nlet urlData = realurl.split(\"/\");\n//https://www.aliyundrive.com/s/{shareId}/folder/{fileId}?;\n\nlet shareId = MY_PARAMS.shareId || urlData[4];\nlet sharePwd = getParam(\"sharePwd\", MY_PARAMS.sharePwd || \"\");\nlet shareToken = getParam(\"shareToken\", MY_PARAMS.shareToken);\n\nlet fileId = (urlData[5] === \"folder\" ? urlData[6] : void 0) || MY_PARAMS.fileId;\nlet searchKey = decodeURIComponent(getParam(\"searchKey\", \"\")) || undefined;\nlet isSearch = !!searchKey;\n\nlet pageId = String(Date.now()).slice(6);\n\nlet skipFile = isSearch && getItem(\"skipFile\", \"0\") === \"1\";\n\nfunction formatDate(_date, fmt) {\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\n    return $.dateFormat(date, fmt || \"yyyy-MM-dd HH:mm:ss\")\n}\n\nfunction formatSize(size) {\n    if (!size) {\n        return '';\n    }\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    let i = 0;\n    while (size >= 1024) {\n        size /= 1024;\n        i++;\n    }\n    size = i ? Number(size.toFixed(2)) : size;\n    return `${size} ${units[i]}`;\n}\n\nfunction setMyPaCache(key, value) {\n    MY_PARAMS[key] = value;\n}\n\nfunction saveMyPaCache() {\n    setPageParams(MY_PARAMS);\n}\n\nfunction setMarker(marker) {\n    setMyPaCache(\"marker\", marker);\n}\n\nfunction setToken(shareToken) {\n    setMyPaCache(\"shareToken\", shareToken);\n}\nif (MY_PARAMS.noPic) {\n    setPagePicUrl();\n    setMyPaCache(\"noPic\", false);\n}\n/*\nfunction setVideoItemCache(videoItemCache) {\n    setMyPaCache(\"videoItemCache\", videoItemCache);\n}\n\nfunction setSubtitleCache(subtitleCache) {\n    setMyPaCache(\"subtitleCache\", subtitleCache);\n}*/\n\nlet iconType = \"ai|apk|avi|css|dmg|exe|flv|gif|hiker|html|iso|jpg|js|json|log|mov|mp3|mp4|otf|php|png|ppt|psd|table|txt|wav|xls|zip|css|doc|epub|exc|htm|xlsx\".split('|');\n\nfunction getIcon(ext, type) {\n    let root = \"https://gitcode.net/qq_32394351/dr/-/raw/master/img/æ–‡ä»¶ç±»å‹2/\";\n    if (type === \"folder\") {\n        return root + \"æ–‡ä»¶å¤¹.svg\";\n    }\n    if (iconType.includes((ext || \"\").toLowerCase())) {\n        return root + ext + \".svg\";\n    }\n    return root + \"æ–‡ä»¶.svg\";\n\n}\n\nfunction load(items) {\n    let aliShareApi = new AliShareApi(shareId, sharePwd, shareToken, (shareToken) => {\n        setToken(shareToken);\n        MY_PARAMS.shareToken = shareToken;\n    });\n    let orders = {\n        \"åç§°æ­£åº\": \"name#ASC\",\n        \"åç§°å€’åº\": \"name#DESC\",\n        \"æ—¶é—´æ­£åº\": \"updated_at#ASC\",\n        \"æ—¶é—´å€’åº\": \"updated_at#DESC\",\n        \"å¤§å°æ­£åº\": \"size#ASC\",\n        \"å¤§å°å€’åº\": \"size#DESC\"\n    };\n    let playMode = getItem(\"aliyun_playMode\", \"è½¬ç \");\n    let ordersKeys = Object.keys(orders);\n    let orderName = getItem(\"aliyun_order\", ordersKeys[0]);\n    let order = orders[orderName].split(\"#\");\n    let styles = [\"text_1\", \"movie_2\", \"card_pic_3\", \"avatar\", \"è¿½å‰§\", \"çœ‹å›¾\"];\n    let style = getItem(\"aliyun_style\", styles[0]);\n    if (MY_PAGE === 1) {\n        if (!getMyVar(\"mountzimu\", \"\")) {\n            storage0.putMyVar(\"mountzimu\", {});\n            addListener(\"onClose\", $.toString(() => {\n                clearMyVar(\"mountzimu\");\n                clearMyVar(\"aliShareToken\");\n                clearVar(\"dm_share\");\n                clearMyVar(\"dmlist\");\n                clearMyVar(\"listSearchKey\");\n                clearMyVar(\"dm_listUrlList\");\n            }));\n        }\n        setMarker();\n        if (realurl && !isSearch) {\n            let shareInfo = aliShareApi.getShareInfo();\n            let fileInfo = shareInfo.file_infos || [];\n            if (fileInfo.length === 1 && fileInfo[0].type === \"folder\" && !fileId) {\n                fileId = fileInfo[0].file_id;\n                setMyPaCache(\"fileId\", fileId);\n                setPageTitle(fileInfo[0].file_name);\n            } else {\n                setPageTitle(shareInfo.share_name);\n            }\n            let deadline = \"æ°¸ä¹…æœ‰æ•ˆ\";\n\n            if (shareInfo.expiration) {\n                deadline = \"æœ‰æ•ˆè‡³ï¼š\" + formatDate(shareInfo.expiration);\n                //shareInfo.updated_at\n            }\n            items.push({\n                title: (shareInfo.creator_name || shareInfo.creator_phone) + \"&nbsp;&nbsp;\" + deadline.small(),\n                url: realurl + \"#noHistory#\",\n                img: shareInfo.avatar || \"hiker://images/icon_unknown\",\n                col_type: \"avatar\"\n            });\n        }\n        if (!isSearch) {\n            items.push({\n                title: \"æœç´¢\",\n                url: $.toString(() => {\n                    input = input.trim();\n                    if (!input) return \"toast://è¯·è¾“å…¥å…³é”®è¯\";\n                    return \"hiker://page/aliyun#noHistory##fullTheme#?page=fypage&searchKey=\" + encodeURIComponent(input);\n                }),\n                col_type: \"input\",\n                extra: {\n                    onChange: \"putMyVar('listSearchKey',input)\",\n                    sharePwd: sharePwd,\n                    shareId: shareId,\n                    shareToken: shareToken\n                }\n            });\n        } else {\n            items.push({\n                title: \"â€œâ€œ\" + searchKey + \"â€â€çš„æœç´¢ç»“æœ\",\n                url: \"hiker://empty\",\n                col_type: \"text_center_1\",\n                extra: {\n                    lineVisible: false\n                }\n            });\n        }\n        let funcItems = [];\n        funcItems.push({\n            title: style,\n            url: $(styles, 1, \"æ’å¸ƒæ ·å¼\").select(() => {\n                setItem(\"aliyun_style\", input);\n                refreshPage();\n                return \"toast://å·²åˆ‡æ¢\";\n            }),\n            pic_url: \"http://123.56.105.145/img/ali_icon.svg\"\n        }, {\n            title: orderName,\n            url: $(ordersKeys, 2, \"æ’åºæ–¹å¼\").select(() => {\n                setItem(\"aliyun_order\", input);\n                refreshPage();\n                return \"toast://åˆ‡æ¢æˆåŠŸ\";\n            }),\n            pic_url: \"http://123.56.105.145/img/ali_sort.svg\"\n        }, {\n            title: playMode,\n            url: $([\"è½¬ç \", \"åŸç”»\", \"åŸè½¬\", \"æé€ŸåŸç”»\"], 1, \"æ’­æ”¾æ¨¡å¼\").select(() => {\n                setItem(\"aliyun_playMode\", input);\n                refreshPage();\n                return \"toast://åˆ‡æ¢æˆåŠŸ\";\n            }),\n            pic_url: \"http://123.56.105.145/img/ali_play.svg\",\n        });\n        if ([\"åŸè½¬\",\"åŸç”»\",\"æé€ŸåŸç”»\"].includes(playMode)) {\n            funcItems.push({\n                title: openAPIList[getItem(\"openApiMode\", \"0\")],\n                url: $(openAPIList, 1, \"åŸç”»API(ä¸è¦é¢‘ç¹åˆ‡æ¢)\").select((openAPIList) => {\n                    setItem(\"openApiMode\", String(openAPIList.indexOf(input)));\n                    deleteFile($.require(\"tokenPath\").openTokensFilepath);\n                    refreshPage(false);\n                    return \"toast://å·²åˆ‡æ¢ä¸º\" + input;\n                }, openAPIList),\n                pic_url: \"http://123.56.105.145/img/ali_api.svg\",\n            });\n        }\n        if (!isSearch) {\n            funcItems.push({\n                title: \"åŠŸèƒ½\",\n                url: $([\"è½¬å­˜äº‘ç›˜\", \"ç™»é™†è´¦å·\", \"å¤åˆ¶åˆ†äº«é“¾æ¥\", \"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\", \"è·å–å¼¹å¹•æœç´¢è§„åˆ™\", \"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\", \"æ¨é€åˆ°TVBox\", \"è®¾ç½®æ”¶è—å°é¢\", \"è·å–æŠ•å±IP\" , \"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\" , \"è½¬å­˜å½“å‰æ–‡ä»¶å¤¹\"], 2, \"æ›´å¤šåŠŸèƒ½\").select((shareId, sharePwd, fileId) => {\n                    switch (input) {\n                        case \"è½¬å­˜äº‘ç›˜\":\n                            return `smartdrive://share/browse?shareId=${shareId}&sharePwd=${sharePwd||\"\"}`;\n                        case \"ç™»é™†è´¦å·\":\n                            return \"hiker://page/login#noRecordHistory##noHistory#\";\n                        case \"å¤åˆ¶åˆ†äº«é“¾æ¥\":\n                            return $([\"å¤åˆ¶é“¾æ¥\", \"å¤åˆ¶æµ·é˜”å£ä»¤\"], 1, \"åˆ†äº«æ–¹å¼\").select((url) => {\n                                if (input === \"å¤åˆ¶é“¾æ¥\") {\n                                    return \"copy://\" + url;\n                                } else {\n                                    return \"copy://é˜¿é‡Œäº‘ç›˜åˆ†äº«å£ä»¤ã€Œ\" + getPageTitle() + \"ã€\\n\" + url + \" @import=js:`hiker://page/aliyun?realurl=${input.trim()}&rule=\" + MY_RULE.title + \"`;\";\n                                }\n                            }, \"https://www.aliyundrive.com/s/\" + shareId + (fileId ? \"/folder/\" + fileId : \"\"));\n                        case \"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\":\n                            return \"hiker://page/dmMount#noHistory##noRecordHistory#\";\n                        case \"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\":\n                            let zm = storage0.getMyVar(\"mountzimu\", {});\n                            let tip = zm.name ? \"å½“å‰å­—å¹•æ–‡ä»¶\\n\" + zm.name + \".\" + zm.ext : \"è¿˜æœªæ‰‹åŠ¨æŒ‚è½½å­—å¹•\";\n                            confirm({\n                                title: 'æ‰‹åŠ¨æŒ‚è½½å­—å¹•',\n                                content: tip + \"\\n(ç‚¹å‡»å–æ¶ˆå¯ä»¥æ¸…é™¤æŒ‚è½½å­—å¹•)\",\n                                cancel: () => {\n                                    clearMyVar(\"mountzimu\");\n                                    return \"toast://å·²æ¸…é™¤æ‰‹åŠ¨æŒ‚è½½å­—å¹•\";\n                                }\n                            });\n                            return;\n                        case \"è·å–å¼¹å¹•æœç´¢è§„åˆ™\":\n                            let rule = {\n                                \"js\": JSON.stringify(\"hiker://page/loadDm?rule=\" + MY_RULE.title + \"&title=\") + \"+encodeURIComponent(playdata.title.split('-')[0]);\",\n                                \"name\": MY_RULE.title + \"å¼¹å¹•æœç´¢\"\n                            };\n                            return \"rule://\" + base64Encode(\"ï¿¥projection_screenï¿¥\" + JSON.stringify(rule));\n                        case \"æ¨é€åˆ°TVBox\":\n                            return \"hiker://page/tvboxPush#noHistory##noRecordHistory#\";\n                        case \"è®¾ç½®æ”¶è—å°é¢\":\n                            return $([\"è®¾ç½®å°é¢åœ°å€\", \"æœç´¢å°é¢\"], 1).select(() => {\n                                if (input === \"è®¾ç½®å°é¢åœ°å€\") {\n                                    return $(\"\", \"è¯·è¾“å…¥å›¾ç‰‡åœ°å€\").input(() => {\n                                        input = input.trim();\n                                        if (!input) return \"toast://è¯·è¾“å…¥åœ°å€\";\n                                        setPagePicUrl(input);\n                                        return \"toast://ä¿®æ”¹æˆåŠŸ\";\n                                    });\n                                } else {\n                                    return \"hiker://page/frontCover#noHistory##noRecordHistory#\";\n                                }\n                            });\n                        case \"è·å–æŠ•å±IP\":\n                            let ip = $.require(\"aliUtil\").getIPv4Address();\n                            if (ip.startsWith(\"192.168.\")) {\n                                return $(ip + \"\\nè¯¥IPé€‚ç”¨äºæµé‡+çƒ­ç‚¹çš„æŠ•å±\\nè¯·æ›¿æ¢é“¾æ¥ä¸­çš„0.0.0.0\").confirm((ip) => {\n                                    return \"copy://\" + ip;\n                                }, ip);\n                            } else {\n                                return $(ip + \"\\nè·å–å¤±è´¥éç¨³å®šIP,è¯·å¼€å¯çƒ­ç‚¹å†ä½¿ç”¨,è¯¥IPå¯èƒ½ä¼šå˜,ä¸èƒ½æŠ•å±\").confirm(() => {});\n                            }\n                        case \"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\":\n                            return $(getItem(\"speedThread\", \"10\"), \"è¯·è¾“å…¥3-32ä¹‹é—´çš„æ•´æ•°\").input(() => {\n                                let speedThread = parseInt(input);\n                                if (speedThread < 3 || speedThread > 32) {\n                                    return \"toast://è®¾ç½®ä¸åˆæ³•\";\n                                }\n                                setItem(\"speedThread\", String(speedThread));\n                                return \"toast://è®¾ç½®æˆåŠŸ\";\n                            });\n                        case \"è½¬å­˜å½“å‰æ–‡ä»¶å¤¹\":\n                            return \"hiker://page/myaliyun#noHistory##noRecordHistory#?page=fypage\";\n                    }\n                }, shareId, sharePwd, fileId),\n                pic_url: \"http://123.56.105.145/img/ali_fileinto.svg\",\n                extra: {\n                    pageId: pageId,\n                    fileId: fileId,\n                    shareId: shareId,\n                    shareToken: shareToken,\n                    sharePwd: sharePwd,\n                    transfer: true,\n                    folderName: getPageTitle()\n                }\n            });\n        } else {\n            funcItems.push({\n                title: [\"ALL\", \"è·³è¿‡æ–‡ä»¶\"][Number(skipFile)],\n                url: $(\"#noLoading#\").lazyRule((skipFile) => {\n                    setItem(\"skipFile\", String(skipFile ? \"0\" : \"1\"));\n                    refreshPage(false);\n                    return \"hiker://empty\";\n                }, skipFile),\n                pic_url: \"hiker://images/icon_search6\",\n            });\n        }\n        let funStyle = [\"\", \"\", \"\", \"icon_small_3\", \"icon_round_small_4\", \"icon_5\"][funcItems.length];\n        items.push.apply(items, funcItems.map(v => (v.col_type = funStyle) && v));\n        items.push({\n            col_type: \"line_blank\"\n        });\n    }\n    let rescod = {};\n    let marker = MY_PARAMS.marker;\n    if (isSearch) {\n        rescod = aliShareApi.getSearchListFile(searchKey, marker, order[0], order[1]);\n    } else {\n        rescod = aliShareApi.getListFile(fileId, marker, order[0], order[1]);\n    }\n    if (rescod.next_marker) {\n        setMarker(rescod.next_marker);\n    } else {\n        setMarker();\n    }\n\n    var conts = rescod.items;\n    //å­—å¹•åŒ¹é…å‡†å¤‡\n    let subExts = [\"vtt\", \"srt\", \"ass\"];\n    var zimulist = [];\n    conts.forEach((item) => {\n        if (subExts.includes(item.file_extension && item.file_extension.toLowerCase())) {\n            let name = item.name.replace('.' + item.file_extension, '');\n            zimulist.push({\n                ext: item.file_extension,\n                file_id: item.file_id,\n                name: name\n            });\n        }\n    });\n    //å¤„ç†å¤¸é¡µåŒ¹é…å­—å¹•\n    /*\n    let hasSub = zimulist.length > 0;\n    if (hasSub&&rescod.next_marker) {\n        if (zimulist.length > 4) {\n            setSubtitleCache(zimulist.slice(-4));\n        } else {\n            setSubtitleCache(zimulist);\n        }\n    }\n    let lastItem = conts.at(-1);\n    if (hasSub&&lastItem&&lastItem.category === \"video\") {\n        setVideoItemCache(conts.splice(conts.length-1,1));\n    }\n    if (MY_PAGE > 1) {\n        let subtitleCache = MY_PARAMS.subtitleCache || [];\n        zimulist = zimulist.concat(subtitleCache);\n        let videoItemCache = MY_PARAMS.videoItemCache || [];\n        conts = videoItemCache.concat(conts);\n        setSubtitleCache();\n        setVideoItemCache();\n    }*/\n    //ç®€ä½“ä¼˜å…ˆ\n    zimulist.sort((a, b) => (b.name.endsWith(\".sc\") || b.name.endsWith(\".chs\")) - (a.name.endsWith(\".sc\") || a.name.endsWith(\".chs\")));\n    //end\n    let titleHead = {\n        video: \"ğŸ¬\",\n        audio: \"ğŸµ\",\n        doc: \"ğŸ“‘\",\n        image: \"ğŸ–¼\",\n        zip: \"ğŸ“¦\",\n        folder: \"ğŸ“‚\"\n    };\n\n    function getHead(type, ext) {\n        let head = titleHead[type];\n        if (subExts.includes(ext)) {\n            head = \"ğŸ•¸\";\n        }\n        return head || \"â“\";\n    }\n\n    function getPreviewPic(fileItem) {\n        if (fileItem.thumbnail) {\n            return $(\"https://empty?\" + fileItem.file_id).image((pic) => {\n                try {\n                    return fetch(pic, {\n                        inputStream: true\n                    });\n                } catch (e) {\n                    return null;\n                }\n            }, fileItem.thumbnail);\n        }\n    }\n    let folderStyle, fileStyle;\n    let filterType = [];\n    if (style === \"è¿½å‰§\") {\n        folderStyle = \"avatar\";\n        fileStyle = \"movie_2\";\n        filterType.push(\"video\");\n        items.push({\n            title: \"â€œâ€œâ€â€\" + \"è¿½å‰§æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œè§†é¢‘\".small().fontcolor(\"grey\"),\n            url: \"hiker://empty\",\n            col_type: \"text_center_1\",\n            extra: {\n                lineVisible: false\n            }\n        });\n    } else if (style === \"çœ‹å›¾\") {\n        folderStyle = \"avatar\";\n        fileStyle = \"card_pic_3\";\n        filterType.push(\"image\");\n        items.push({\n            title: \"â€œâ€œâ€â€\" + \"çœ‹å›¾æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œå›¾ç‰‡\".small().fontcolor(\"grey\"),\n            url: \"hiker://empty\",\n            col_type: \"text_center_1\",\n            extra: {\n                lineVisible: false\n            }\n        });\n    } else {\n        folderStyle = fileStyle = style;\n    }\n    let noSkipFile = !skipFile;\n    for (let i = 0; i < conts.length; i++) {\n        let fileItem = conts[i];\n        let cate = fileItem.category;\n        let desc = formatDate(fileItem.updated_at);\n        let pic_url = getIcon(fileItem.file_extension, fileItem.type);\n\n        if (fileItem.type === \"folder\") {\n            let title = (folderStyle === \"text_1\" ? titleHead.folder : \"\") + fileItem.name;\n            items.push({\n                title: title,\n                url: 'hiker://page/aliyun?page=fypage',\n                col_type: folderStyle,\n                desc: formatDate(fileItem.updated_at),\n                pic_url: pic_url,\n                extra: {\n                    shareId: shareId,\n                    shareToken: MY_PARAMS.shareToken,\n                    fileId: fileItem.file_id,\n                    sharePwd: sharePwd,\n                    pageTitle: fileItem.name,\n                    transfer: true,\n                    noPic: true,\n                    longClick: [{\n                        title: \"è½¬å­˜\",\n                        js: JSON.stringify(\"hiker://page/myaliyun#noHistory##noRecordHistory#?page=fypage\")\n                    }]\n                }\n            });\n        } else if (noSkipFile) {\n            if (filterType.length > 0 && !filterType.includes(cate)) {\n                continue;\n            }\n            let subtitle, cls, longc = [{\n                title: \"è½¬å­˜\",\n                js: JSON.stringify(\"hiker://page/myaliyun#noHistory##noRecordHistory#?page=fypage\")\n            }];\n            let title = fileItem.name;\n            let nameNotExt = fileItem.name.replace('.' + fileItem.file_extension, '');\n            if (subExts.includes(fileItem.file_extension)) {\n                longc.push({\n                    title: \"æŒ‚è½½å­—å¹•\",\n                    js: $.toString((zm) => {\n                        storage0.putMyVar('mountzimu', zm);\n                        return 'toast://æŒ‚è½½å®Œæˆï¼Œå½“å‰å­—å¹•æ–‡ä»¶: ' + zm.name + '.' + zm.ext;\n                    }, {\n                        ext: fileItem.file_extension,\n                        file_id: fileItem.file_id,\n                        name: nameNotExt\n                    }),\n                });\n            }\n            if (cate === \"video\") {\n                if (zimulist.length) {\n                    subtitle = zimulist.find(v => v.name.includes(nameNotExt));\n                }\n                cls = \"playlist v\" + pageId;\n            }\n            if (fileStyle === \"text_1\") {\n                desc += \"\\t\\t\" + formatSize(fileItem.size);\n                title = getHead(cate, fileItem.file_extension) + title;\n            } else if ([\"video\", \"image\"].includes(cate)) {\n                pic_url = getPreviewPic(fileItem) || pic_url;\n            }\n            items.push({\n                title: title,\n                url: $(\"#noPre#\").lazyRule((shareId, sharePwd, shareToken, fileId, cate, subtitle) => {\n                    return $.require(\"hiker://page/alilazy\")(shareId, sharePwd, shareToken, fileId, cate, subtitle);\n                }, shareId, sharePwd, MY_PARAMS.shareToken, fileItem.file_id, cate, subtitle),\n                desc: desc,\n                pic_url: pic_url,\n                extra: {\n                    id: fileItem.file_id,\n                    transfer: true,\n                    shareInfo: {\n                        pageId: pageId,\n                        fileId: fileItem.file_id,\n                        shareId: shareId,\n                        shareToken: shareToken,\n                        sharePwd: sharePwd,\n                    },\n                    longClick: longc,\n                    cls: cls,\n                    //inheritTitle: false,\n                    pageTitle: fileItem.name\n                },\n                col_type: fileStyle\n            });\n        }\n    }\n    if (conts.length === 0) {\n        items.push({\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            title: \"â€œâ€œâ€â€\" + \"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\".fontcolor(\"Gray\"),\n            extra: {\n                lineVisible: false,\n            }\n        });\n    }\n}\n\nlet items = [];\ntry {\n    if (MY_PAGE > 1 && !MY_PARAMS.marker) {\n        items.push({\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            title: \"â€œâ€œâ€â€\" + \"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\".fontcolor(\"Gray\"),\n            extra: {\n                lineVisible: false,\n            }\n        });\n    } else {\n        load(items);\n    }\n} catch (e) {\n    if (e.name === \"AliError\") {\n        if (e.code === \"InvalidResource.SharePwd\") {\n            items.push({\n                title: \"è¯·è¾“å…¥æå–ç \",\n                desc: sharePwd ? \"â€œâ€œæå–ç é”™è¯¯â€â€\" : \"\",\n                url: $().input((MY_PARAMS) => {\n                    setPageParams(Object.assign({}, MY_PARAMS, {\n                        sharePwd: input\n                    }));\n                    refreshPage();\n                }, MY_PARAMS),\n                col_type: \"text_center_1\"\n            });\n        } else {\n            if (e.significance === 1) {\n                items.push({\n                    title: \"â€œâ€œâ€â€\" + e.message.big().big().fontcolor(\"red\"),\n                    url: \"hiker://empty\",\n                    col_type: 'text_center_1',\n                });\n            } else if (e.significance === 3) {\n                items.push({\n                    title: \"â€œâ€œâ€â€\" + e.message.big().fontcolor(\"green\"),\n                    url: \"hiker://empty\",\n                    col_type: 'text_center_1'\n                });\n            }\n        }\n\n    } else {\n        log(\"åˆ—è¡¨åŠ è½½å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n        items.push({\n            title: 'æ¬§æ¬§ï¼ŒæŠ¥é”™äº†ã€‚åœ¨åˆ·æ–°å‡ æ¬¡ï¼Ÿæˆ–è€…æ›´æ¢æ–‡ä»¶å¤¹ã€‚',\n            url: \"hiker://empty\",\n            desc: e.toString(),\n            col_type: 'text_center_1'\n        });\n        //throw e;\n    }\n}\nsaveMyPaCache();\nsetResult(items);"},{"col_type":"movie_3","name":"ç™»å½•è´¦å·","path":"login","rule":"js:\nvar d = [];\nsetPageTitle(\"ç™»å½•é˜¿é‡Œäº‘ç›˜\");\nlet index = Number(getParam(\"index\", \"1\"));\nif (Number.isNaN(index)) {\n    index = 1;\n}\n\n\nfunction getQRCode() {\n    let json = fetch(\"https://passport.aliyundrive.com/newlogin/qrcode/generate.do?appName=aliyun_drive&fromSite=52&appName=aliyun_drive&appEntrance=web&isMobile=false&lang=zh_CN&returnUrl=&bizParams=&_bx-v=2.2.3\");\n    let qr = JSON.parse(json);\n    if (!openAppIntent('com.alicloud.databox', 'com.taobao.login4android.scan.QrScanActivity', {\n            \"key_scanParam\": json\n        })) {\n        createQRCode(qr.content.data.codeContent, false);\n    }\n    return qr;\n}\n\nfunction backHome(t, i) {\n    back(i);\n    toast(t);\n}\n\nfunction fromAppGetToken(qr) {\n    let qr = getQRCode();\n    if (!qr) return backHome(\"è·å–å¤±è´¥\");\n    let ckk = qr.content.data;\n    let body = {\n        ck: ckk.ck,\n        t: ckk.t + \"\",\n        appName: \"aliyun_drive\",\n        appEntrance: \"web\",\n        isMobile: false,\n        lang: \"zh_CN\",\n        navPlatform: \"MacIntel\",\n        returnUrl: \"\",\n        navlanguage: \"zh-CN\",\n        fromSite: 52,\n        bizParams: \"\"\n\n    };\n    /*\n     {\n        NEW: \"å¾…æ‰«æ\",\n        CANCELED: \"å–æ¶ˆ\",\n        SCANED:\"å·²æ‰«æ\",\n        CANCELED: \"å®Œæˆ\"\n    }*/\n    let errorCount = 0;\n    for (let i = 0; i < 30; i++) {\n        try {\n            let result = JSON.parse(post(\"https://passport.aliyundrive.com/newlogin/qrcode/query.do?appName=aliyun_drive&fromSite=52&_bx-v=2.2.3\", {\n                body: body\n            }));\n            let qrCodeStatus = result.content.data.qrCodeStatus;\n\n            if (qrCodeStatus === \"CONFIRMED\") {\n                if (result.content.data.bizExt) {\n                    let info = JSON.parse(base64Decode(result.content.data.bizExt));\n                    let aliTokensFilepath = $.require(\"hiker://page/tokenPath\").aliTokensFilepath;\n                    let aliToken = {\n                        refresh_token: info.pds_login_result.refreshToken\n                    };\n                    writeFile(aliTokensFilepath, JSON.stringify(aliToken));\n                    addItemAfter(\"loginy\", {\n                        title: \"ç™»å½•æˆåŠŸ(ç‚¹å‡»è¿”å›)\",\n                        url: $(\"#noLoading#\").lazyRule(() => {\n                            back(false);\n                            return \"hiker://empty\";\n                        }),\n                        col_type: \"text_center_1\",\n                    });\n                    backHome(\"ç™»å½•æˆåŠŸ\", true);\n                } else {\n                    backHome(\"ç™»å½•å¤±è´¥,è¯·å°è¯•å…¶ä»–çš„æ–¹æ³•\");\n                }\n                return;\n            } else if (qrCodeStatus === \"CANCELED\") {\n                backHome(\"å–æ¶ˆç™»å½•æˆæƒ\");\n                return;\n            }\n            if ([\"NEW\", \"SCANED\"].includes(qrCodeStatus)) {\n                java.lang.Thread.sleep(2500);\n            } else {\n                backHome(\"è¶…æ—¶\");\n                return;\n            }\n        } catch (e) {\n            errorCount++;\n            if (errorCount > 4) {\n                throw e;\n            }\n        }\n    }\n\n}\nif (index > -1) {\n    let loginUrls = [\"https://www.aliyundrive.com/sign\", \"https://auth.aliyundrive.com/v2/oauth/authorize?login_type=custom&response_type=code&redirect_uri=https%3A%2F%2Fwww.aliyundrive.com%2Fsign%2Fcallback&client_id=25dzX3vbYqktVxyX&state=%7B%22origin%22%3A%22*%22%7D#/login\"];\n    let url = loginUrls[index];\n    let isRefresh = !getParam(\"noRefresh\");\n    let aliTokensFilepath = $.require(\"tokenPath\").aliTokensFilepath;\n\n    var js = $.toString((isRefresh, aliTokensFilepath) => {\n        setInterval(() => {\n            var token = JSON.parse(localStorage.getItem('token'));\n            if (token && token.user_id) {\n                let token_url = aliTokensFilepath;\n                fy_bridge_app.writeFile(token_url, JSON.stringify(token));\n                localStorage.clear();\n                fy_bridge_app.back(isRefresh);\n                fy_bridge_app.toast('TOKENè·å–æˆåŠŸï¼Œè¯·å‹¿æ³„æ¼ä¸ªäººéšç§ï¼ï¼ï¼');\n                return;\n            }\n        }, 300);\n    }, isRefresh, aliTokensFilepath);\n\n    d.push({\n        url: url,\n        col_type: 'x5_webview_single',\n        desc: '100%&&float',\n        extra: {\n            canBack: false,\n            js: js,\n            urlInterceptor: $.toString(() => true)\n        }\n    });\n    setResult(d);\n} else {\n    \n    d.push({\n        col_type: \"text_center_1\",\n        title: \"â€œâ€œâ€â€\" + \"ç­‰å¾…æˆæƒ...\".big().big(),\n        desc: \"å¦‚æœå‡çº§äº†å®˜æ–¹Appï¼Œæ— æ³•è‡ªåŠ¨è°ƒèµ·æˆæƒï¼Œè¯·æ‰«ç ç™»å½•\",\n        url: \"hiker://empty\",\n        extra: {\n            id: \"loginy\",\n        }\n    });\n    setResult(d);\n    try {\n        fromAppGetToken();\n    } catch (e) {\n        backHome(\"å†…éƒ¨é”™è¯¯:\" + e.toString());\n    }\n}"},{"col_type":"movie_3","name":"é˜¿é‡Œåˆ—è¡¨API","path":"AliApi","rule":"js:\n//@author LoyDgIk\nfunction AliError(errorCode, message, significance) {\n    let errorType = AliError.errorCodeMap.get(errorCode) || [];\n    this.code = errorCode;\n    this.message = errorType[0] || message || \"\";\n    this.name = \"AliError\";\n    this.significance = errorType[1] || significance || 1;\n}\nAliError.errorCodeMap = new Map([\n    [\"ShareLink.Cancelled\", [\"åˆ†äº«é“¾æ¥å·²å¤±æ•ˆ\"]],\n    [\"ShareLink.Forbidden\", [\"è¿è§„èµ„æºå·²è¢«å°ç¦\"]],\n    [\"NotFound.ShareLink\", [\"ä¸å­˜åœ¨è¯¥é“¾æ¥è¯·æ ¸å¯¹\"]],\n    [\"AccessTokenInvalid\", [\"è®¿é—®ä»¤ç‰Œå¤±æ•ˆï¼Œè¯·é‡æ–°ç™»é™†\"]],\n    [\"ShareLinkTokenInvalid\", [\"åˆ†äº«ä»¤ç‰Œå¤±æ•ˆ\"]],\n    [\"ParamFlowException\", [\"è®¿é—®è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•\", 3]]\n]);\n\nAliError.prototype = Object.assign(new Error(), {\n    constructor: AliError\n});\n\nfunction postApi(api, body, headers) {\n    let result = request('https://api.aliyundrive.com' + api, {\n        headers: Object.assign({\n            'Content-Type': 'application/json',\n        }, headers),\n        body: JSON.stringify(body),\n        method: 'POST'\n    });\n    result = JSON.parse(result);\n    if (result.code) {\n        throw new AliError(result.code, result.message);\n    }\n    return result;\n}\n\nfunction AliShareApi(shareId, sharePwd, shareToken, refreshCallBack) {\n    this.shareId = shareId;\n    this.sharePwd = sharePwd;\n    this.refreshCallBack = refreshCallBack || (() => void 0);\n    this.shareToken = shareToken || this.getShareToken();\n}\nObject.assign(AliShareApi.prototype, {\n    getShareToken() {\n        let result = postApi(\"/v2/share_link/get_share_token\", {\n            \"share_id\": this.shareId,\n            \"share_pwd\": this.sharePwd,\n        });\n        this.shareToken = result.share_token;\n        this.refreshCallBack(result.share_token, this);\n        return result.share_token;\n    },\n    postTokenApi(api, body, headers, isRetry) {\n        let result;\n        try {\n            result = postApi(api, body, Object.assign({\n                \"X-Share-Token\": this.shareToken || this.getShareToken()\n            }, headers));\n        } catch (e) {\n            if ((e.code === \"AccessTokenInvalid\" || e.code === \"ShareLinkTokenInvalid\") && !isRetry) {\n                this.getShareToken();\n                return this.postTokenApi(api, body, headers, true);\n            }\n            throw e;\n        }\n        return result;\n    },\n    getListFile(fileId, marker, orderBy, orderDirection) {\n        let result = this.postTokenApi(\"/adrive/v3/file/list\"/*\"/adrive/v2/file/list_by_share\"*/, {\n            \"share_id\": this.shareId,\n            \"parent_file_id\": fileId || \"root\",\n            \"limit\": 100,\n            \"image_thumbnail_process\": \"image/resize,w_160/format,jpeg\",\n            \"image_url_process\": \"image\\/resize,w_1920/format,jpeg\",\n            \"video_thumbnail_process\": \"video/snapshot,t_1000,f_jpg,ar_auto,w_300\",\n            \"order_by\": orderBy || \"name\",\n            \"order_direction\": orderDirection || \"ASC\",\n            \"marker\": marker\n        });\n        return result;\n    },\n    getShareInfo() {\n        let result = postApi(\"/adrive/v3/share_link/get_share_by_anonymous?share_id=\" + this.shareId, {\n            \"share_id\": this.shareId,\n        });\n        return result;\n    },\n    getSearchListFile(key, marker, orderBy, orderDirection) {\n        let result = this.postTokenApi(\"/recommend/v1/shareLink/search\", {\n            \"share_id\": this.shareId,\n            \"keyword\": key,\n            \"limit\": 100,\n            \"order_by\": orderBy + \" \" + orderDirection,\n            \"marker\": marker || undefined\n        });\n        if (Object.keys(result).length === 0) {\n            result.items = [];\n        }\n        return result;\n    }\n});\n$.exports = AliShareApi;"},{"col_type":"movie_3","name":"é˜¿é‡Œæ’­æ”¾API","path":"aliPlayApi","rule":"//@author LoyDgIk\n\nfunction AliAccessApi({\n    shareId,\n    sharePwd,\n    shareToken,\n    aliTokens,\n    openTokens,\n    openSuffix,\n    refreshShareCallBack,\n    refreshAccessCallBack,\n    refreshOpenCallBack\n}) {\n    this.openSuffix = openSuffix || \"\";\n    this.shareId = shareId;\n    this.sharePwd = sharePwd;\n    this.shareToken = shareToken;\n    this.refreshShareCallBack = refreshShareCallBack || (() => void 0);\n    this.refreshAccessCallBack = refreshAccessCallBack || (() => void 0);\n    this.refreshOpenCallBack = refreshOpenCallBack || (() => void 0);\n    this.aliTokens = aliTokens || {};\n    if (!this.aliTokens.refresh_token) {\n        throw new Error(\"æœªç™»é™†\");\n    }\n    if (!this.aliTokens.access_token) {\n        this.refreshAccessToken();\n    }\n    this.defDriveId = this.aliTokens.resource_drive_id || this.aliTokens.default_drive_id;\n    this.reaccessTk = (this.aliTokens.token_type || \"Bearer\") + ' ' + this.aliTokens.access_token;\n    Object.defineProperty(this, \"shareToken\", {\n        get() {\n            return this._shareToken || this.getShareToken();\n        },\n        set(v) {\n            this._shareToken = v;\n        }\n    });\n    Object.defineProperty(this, \"openTools\", {\n        get() {\n            if (this._openTools) return this._openTools;\n            let OpenApiTools;\n            switch (getItem(\"openApiMode\", \"0\")) {\n                case \"1\":\n                    OpenApiTools = $.require(\"openApi_aliyundrive\" + this.openSuffix);\n                    break;\n                case \"2\":\n                    OpenApiTools = $.require(\"openApi_tvbox\" + this.openSuffix);\n                    break;\n                case \"3\":\n                    OpenApiTools = $.require(\"openApi_XBY\" + this.openSuffix);\n                    break;\n                case \"4\":\n                    OpenApiTools = $.require(\"openApi_tv\" + this.openSuffix);\n                    break;\n                case \"0\":\n                default:\n                    OpenApiTools = $.require(\"openApi_alist\" + this.openSuffix);\n            }\n            this._openTools = new OpenApiTools(this);\n            return this._openTools;\n        }\n    });\n    Object.defineProperty(this, \"openTokens\", {\n        get() {\n            if (this._openTokens) return this._openTokens;\n            this._openTokens = Object.assign({\n                'RefreshTokenOpen': '',\n                'AccessTokenOpen': '',\n                'BindRefreshToken': '',\n            }, openTokens);\n            if (openTokens !== null && !this._openTokens.AccessTokenOpen) {\n                this.refreshOpenToken();\n            }\n            return this._openTokens;\n        }\n    });\n}\nObject.assign(AliAccessApi.prototype, {\n    _openTools: void 0,\n    _openTokens: void 0,\n    _shareToken: void 0,\n    waitSleep(time) {\n        java.lang.Thread.sleep(time || 600);\n        return this;\n    },\n    postApi(api) {\n        return httpRequest.post(api.startsWith(\"http\") ? api : 'https://api.aliyundrive.com' + api).bodyToString(true).error((err) => {\n            throw err;\n        }).errorType((err, res) => {\n            let result = {};\n            try {\n                result = JSON.parse(res.body);\n            } catch (e) {\n                return err;\n            }\n            let rbody = (result.code ? result : (result && result.responses && result.responses[0] && result.responses[0].body)) || {};\n            if (rbody.code) {\n                let msg = rbody.display_message || rbody.message;\n                let error = new Error(api + \"=>\" + rbody.code + \":\" + msg);\n                error.code = rbody.code;\n                error.judgeMsg = msg;\n                return error;\n            }\n            return err;\n        });\n    },\n    setMyDrividType(isBackup) {\n        this.myDrividType = !!isBackup;\n        return this;\n    },\n    trySolve(e) {\n        if (e.code === \"ShareLinkTokenInvalid\" || e.code === \"InvalidParameterNotMatch.ShareId\") {\n            this.waitSleep(20).getShareToken();\n            return true;\n        } else if (e.code === \"AccessTokenInvalid\" || e.code === \"AccessTokenExpired\") {\n            this.waitSleep(20).refreshAccessToken();\n            return true;\n        } else if (e.code === \"ForbiddenNoPermission.File\" || (e.code === \"BadRequest\" && e.judgeMsg === \"ä»…å¯ä¿å­˜åˆ°è½¬å­˜ç©ºé—´\")) {\n            this.aliTokens.resource_drive_id = undefined;\n            this.waitSleep(20).refreshAccessToken();\n            return true;\n        }\n        return false;\n    },\n    tryOpenApiSolve(e) {\n        if (e.code === \"AccessTokenInvalid\" || e.code === \"AccessTokenExpired\") {\n            this.waitSleep(20).refreshOpenToken();\n            return true;\n        } else {\n            this.waitSleep(20).refreshAccessToken();\n            this.waitSleep(20).refreshOpenToken();\n            return true;\n        }\n        return false;\n    },\n    getShareToken() {\n        if (!this.shareId) return;\n        let result = this.postApi(\"/v2/share_link/get_share_token\").body({\n            \"share_id\": this.shareId,\n            \"share_pwd\": this.sharePwd,\n        }).start(true);\n        this.shareToken = result.share_token;\n        this.refreshShareCallBack(result.share_token, this);\n        return result.share_token;\n    },\n    refreshAccessToken() {\n        let result = this.postApi(\"https://auth.aliyundrive.com/v2/account/token\")\n            .body({\n                \"grant_type\": \"refresh_token\",\n                \"refresh_token\": this.aliTokens.refresh_token,\n            }).headers({\n                \"User-Agent\": PC_UA,\n                \"Referer\": \"https://www.aliyundrive.com/\"\n            }).error((e) => {\n                if (e.code === \"InvalidParameter.RefreshToken\") {\n                    e.message = \"#ç™»é™†è¿‡æœŸè¯·é‡æ–°ç™»é™†#\\n\" + e.message;\n                    throw e;\n                }\n            }).start(true);\n        delete result.user_data;\n        let originDefdDriveId = this.aliTokens.default_drive_id;\n        this.aliTokens = Object.assign(this.aliTokens, result);\n        this.reaccessTk = this.aliTokens.token_type + ' ' + this.aliTokens.access_token;\n        try {\n            if ((originDefdDriveId !== this.aliTokens.default_drive_id) || this.aliTokens.resource_drive_id === undefined) {\n                let resource_drive_id = this.getUserInfo().resource_drive_id;\n                this.aliTokens.resource_drive_id = resource_drive_id;\n                if (resource_drive_id) {\n                    this.defDriveId = resource_drive_id;\n                } else {\n                    this.defDriveId = this.aliTokens.default_drive_id;\n                }\n            }\n        } catch (e) {\n            log(\"ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥ï¼š\" + e.toString());\n        }\n        this.refreshAccessCallBack(result, this);\n        return this.aliTokens;\n    },\n    getUserInfo() {\n        let info = this.postApi(\"https://user.aliyundrive.com/v2/user/get\").headers({\n            \"User-Agent\": PC_UA,\n            \"authorization\": this.reaccessTk,\n            \"Referer\": \"https://www.aliyundrive.com/\"\n        }).errorWithRetry((e, _, http) => {\n            this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'authorization': this.reaccessTk\n                }\n            });\n            return true;\n        }).start(true);\n        return info;\n    },\n    cacheOpenToken(openResult) {\n        this.openTokens.RefreshTokenOpen = openResult.refresh_token;\n        this.openTokens.AccessTokenOpen = openResult.token_type + \" \" + openResult.access_token;\n        this.openTokens.BindRefreshToken = this.aliTokens.refresh_token;\n        this.refreshOpenCallBack(openResult, this);\n    },\n    refreshOpenToken() {\n        try {\n            let openResult;\n            if (this.openTokens.RefreshTokenOpen && this.openTokens.BindRefreshToken === this.aliTokens.refresh_token) {\n                openResult = this.openTools.refreshOpenToken() || {};\n            } else {\n                openResult = this.openTools.getOpenToken() || {};\n            }\n            if (openResult.refresh_token) {\n                this.cacheOpenToken(openResult);\n                return this.openTokens;\n            } else {\n                throw new Error(\"è¿”å›ç»“æœæ— Token\");\n            }\n        } catch (e) {\n            throw new Error(\"OpenTokenè·å–å¤±è´¥:\" + e.toString());\n        }\n    },\n    _cloudFileOperate(body, cloudFileId, operateUrl) {\n        let result = this.postApi('https://api.aliyundrive.com/adrive/v2/batch').body({\n            \"requests\": [{\n                \"body\": body,\n                \"headers\": {\n                    \"Content-Type\": \"application/json\"\n                },\n                \"id\": cloudFileId || \"0\",\n                \"method\": \"POST\",\n                \"url\": operateUrl\n            }],\n            \"resource\": \"file\"\n        }).headers({\n            'User-Agent': PC_UA,\n            'Referer': 'https://www.aliyundrive.com/',\n            'authorization': this.reaccessTk,\n            //getAccessToken\n            'x-canary': 'client=web,app=share,version=v2.3.1',\n            'x-share-token': this.shareToken\n        }).errorWithRetry((e, _, http) => {\n            if (e.code === \"QuotaExhausted.Drive\") {\n                throw e;\n            }\n\n            if (!this.trySolve(e)) {\n                this.waitSleep(20).refreshAccessToken();\n            }\n            let body = http.options.body.requests[0].body;\n            if (body.drive_id) {\n                body.drive_id = this.getMyDrivid();\n            }\n            if (body.to_drive_id) {\n                body.to_drive_id = this.getMyDrivid();\n            }\n            http.mergeHeadAndBody({\n                headers: {\n                    'authorization': this.reaccessTk,\n                    'x-share-token': this.shareToken\n                }\n            });\n            return true;\n        }).start(true);\n        return result;\n    },\n    copyFileToCloudFile(fileId, parentFileId, retry) {\n        let result = this._cloudFileOperate({\n            \"file_id\": fileId,\n            \"share_id\": this.shareId,\n            \"auto_rename\": true,\n            \"to_parent_file_id\": parentFileId || \"root\",\n            \"to_drive_id\": this.getMyDrivid()\n        }, \"0\", \"/file/copy\");\n        let body = result && result.responses && result.responses[0] && result.responses[0].body || {};\n        if (!body.file_id && !retry) {\n            this.waitSleep(20).getShareToken();\n            this.waitSleep(20).refreshAccessToken();\n            return this.waitSleep(20).copyFileToCloudFile(fileId, parentFileId, true);\n        } else if (!body.file_id) {\n            let e = new Error(\"æ–‡ä»¶å¤åˆ¶å¤±è´¥:\\n\" + JSON.stringify(result));\n            e.code = body.code;\n            throw e;\n        }\n        return result.responses[0].body.file_id;\n    },\n    openCloudFileToDownUrl(cloudFileId) {\n        let fileInfo = this.postApi('https://open.aliyundrive.com/adrive/v1.0/openFile/getDownloadUrl').body({\n            'file_id': cloudFileId,\n            'drive_id': this.getMyDrivid()\n        }).headers({\n            'User-Agent': PC_UA,\n            'Referer': 'https://www.aliyundrive.com/',\n            'authorization': this.openTokens.AccessTokenOpen\n        }).errorWithRetry(2, (e, _, http) => {\n            //this.waitSleep(30).trySolve(e);\n            this.waitSleep(30).tryOpenApiSolve(e);\n            http.mergeHeadAndBody({\n                body: {\n                    'drive_id': this.getMyDrivid(),\n                },\n                headers: {\n                    'authorization': this.openTokens.AccessTokenOpen\n                }\n            });\n            return true;\n        }).start(true);\n        if (!fileInfo.url || fileInfo.code) throw new Error(\"ä¸‹è½½é“¾æ¥è·å–å¤±è´¥\\n\" + fileInfo.code + \":\" + fileInfo.message);\n        return fileInfo.url;\n    },\n    deleteeCloudFile(cloudFileId) {\n        let result = this._cloudFileOperate({\n            \"drive_id\": this.getMyDrivid(),\n            \"file_id\": cloudFileId\n        }, cloudFileId, \"/file/delete\");\n        return result;\n    },\n    getVideoCloudPreview(cloudFileId) {\n        let fileInfo = this.postApi('https://open.aliyundrive.com/adrive/v1.0/openFile/getVideoPreviewPlayInfo').body({\n            'file_id': cloudFileId,\n            'drive_id': this.getMyDrivid(),\n            \"category\": \"live_transcoding\",\n            \"template_id\": \"\",\n            \"get_subtitle_info\": true,\n            \"url_expire_sec\": 14400,\n            \"with_play_cursor\": true\n        }).headers({\n            'User-Agent': PC_UA,\n            'Referer': 'https://www.aliyundrive.com/',\n            'authorization': this.openTokens.AccessTokenOpen\n        }).errorWithRetry(2, (e, _, http) => {\n            //this.waitSleep(30).trySolve(e);\n            this.waitSleep(30).tryOpenApiSolve(e);\n            http.mergeHeadAndBody({\n                body: {\n                    'drive_id': this.getMyDrivid(),\n                },\n                headers: {\n                    'authorization': this.openTokens.AccessTokenOpen\n                }\n            });\n            return true;\n        }).start(true);\n        return fileInfo.video_preview_play_info.live_transcoding_task_list.reverse();\n    },\n    getAllVideoTemPlayUrl(fileId, onlyPreview) {\n        let cloudFileId = this.copyFileToCloudFile(fileId);\n        this.waitSleep(20);\n        let playUrl = onlyPreview ? undefined : this.openCloudFileToDownUrl(cloudFileId);\n        this.waitSleep(50);\n        let preview = this.getVideoCloudPreview(cloudFileId);\n        this.waitSleep(50);\n        try {\n            this.deleteeCloudFile(cloudFileId);\n        } catch (e) {\n            log(\"#æ–‡ä»¶åˆ é™¤å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n        }\n        return {\n            origin: playUrl,\n            preview\n        };\n    },\n    getVideoTemPlayUrl(fileId) {\n        let cloudFileId = this.copyFileToCloudFile(fileId);\n        this.waitSleep(20);\n        let playUrl = this.openCloudFileToDownUrl(cloudFileId);\n        this.waitSleep(50);\n        try {\n            this.deleteeCloudFile(cloudFileId);\n        } catch (e) {\n            log(\"#æ–‡ä»¶åˆ é™¤å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n        }\n        return playUrl;\n    },\n    getFileToDownUrl(fileId) {\n        let downloadInfo = this.postApi(\"/v2/file/get_share_link_download_url\").body({\n            \"expire_sec\": 600,\n            \"file_id\": fileId,\n            \"share_id\": this.shareId\n        }).headers({\n            \"X-Share-Token\": this.shareToken,\n            \"authorization\": this.aliTokens.access_token\n        }).errorWithRetry((e, _, http) => {\n            this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    \"X-Share-Token\": this.shareToken,\n                    \"authorization\": this.aliTokens.access_token\n                }\n            });\n            return true;\n        }).start(true);\n        return downloadInfo.download_url;\n    },\n    \n    getSign() {\n        if (!this.aliTokens.device_id) {\n            this.waitSleep(20).refreshAccessToken();\n        }\n        let calculateNewSign = () => {\n            let sign = justTestSign(\"5dde4e1bdf9e4966b387ba58f4b3fdc3\", this.aliTokens.device_id, this.aliTokens.user_id).split(\"##\");\n            return {\n                signature: sign.at(0),\n                pubKey: sign.at(-1)\n            };\n        };\n        let newSign = calculateNewSign();\n        let result = this.postApi('/users/v1/users/device/create_session').body({\n            \"deviceName\": \"Edgeæµè§ˆå™¨\",\n            \"modelName\": \"Windowsç½‘é¡µç‰ˆ\",\n            \"pubKey\": newSign.pubKey,\n        }).headers({\n            'User-Agent': PC_UA,\n            'Referer': 'https://www.aliyundrive.com',\n            'Authorization': this.reaccessTk,\n            'X-Share-Token': this.shareToken,\n            'x-device-id': this.aliTokens.device_id,\n            'x-signature': newSign.signature\n        }).errorWithRetry(3, (e, _, http) => {\n            if (e.message === \"x-device-id empty\") {\n                this.waitSleep(20).refreshAccessToken();\n            }\n            this.trySolve(e);\n            this.waitSleep(50);\n            newSign = calculateNewSign();\n            http.mergeHeadAndBody({\n                body: {\n                    \"pubKey\": newSign.pubKey\n                },\n                headers: {\n                    'Authorization': this.reaccessTk,\n                    'X-Share-Token': this.shareToken,\n                    'x-device-id': this.aliTokens.device_id,\n                    'x-signature': newSign.signature\n                }\n            });\n            return true;\n        }).error((err, res) => {\n            return {};\n        }).success((body) => {\n            return body;\n        }).start(true);\n        if (result.success) {\n            return newSign;\n        } else {\n            throw new Error(\"Signè·å–å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚\\ncode:\" + (result.code || \"\") + \"\\nmessage:\" + (result.message || \"\"));\n        }\n    },\n    getShareVideoPreview(fileId) {\n        let sign = this.getSign();\n        let json = this.postApi('https://api.aliyundrive.com/v2/file/get_share_link_video_preview_play_info').body({\n            \"category\": \"live_transcoding\",\n            \"file_id\": fileId,\n            \"get_preview_url\": true,\n            \"share_id\": this.shareId,\n            \"template_id\": \"\",\n            \"get_subtitle_info\": true\n        }).headers({\n            'content-type': 'application/json;charset=UTF-8',\n            \"origin\": \"https://www.aliyundrive.com\",\n            \"referer\": \"https://www.aliyundrive.com/\",\n            \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.41\",\n            \"x-canary\": \"client=web,app=adrive,version=v3.1.0\",\n            \"x-share-token\": this.shareToken,\n            \"fileid\": this.aliTokens.user_id,\n            'Authorization': this.reaccessTk,\n            'x-device-id': this.aliTokens.device_id,\n            'x-signature': sign.signature\n        }).errorWithRetry((e, _, http) => {\n            this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'Authorization': this.reaccessTk,\n                    'X-share-token': this.shareToken,\n                    'x-device-id': this.aliTokens.device_id,\n                    'x-signature': sign.signature\n                }\n            });\n            return true;\n        }).start(true);\n        return json.video_preview_play_info.live_transcoding_task_list.reverse();\n    },\n    getMyDrivid() {\n        return (this.myDrividType ? this.aliTokens.default_drive_id : this.aliTokens.resource_drive_id) || this.defDriveId;\n    },\n    getListFile(fileId, marker, orderBy, orderDirection) {\n        let result = this.postApi(\"https://open.aliyundrive.com/adrive/v1.0/openFile/list\").body({\n            \"drive_id\": this.getMyDrivid(),\n            \"parent_file_id\": fileId || \"root\",\n            \"limit\": 100,\n            \"all\": true,\n            \"url_expire_sec\": 86400,\n            \"image_thumbnail_process\": \"image/resize,w_400/format,jpeg\",\n            \"image_url_process\": \"image/resize,w_1920/format,jpeg\",\n            \"video_thumbnail_process\": \"video/snapshot,t_1000,f_jpg,ar_auto,w_300\",\n            \"order_by\": orderBy || \"name\",\n            \"order_direction\": orderDirection || \"ASC\",\n            \"marker\": marker\n        }).headers({\n            'User-Agent': PC_UA,\n            'Referer': 'https://www.aliyundrive.com/',\n            'authorization': this.openTokens.AccessTokenOpen\n        }).errorWithRetry(2, (e, _, http) => {\n\n            this.waitSleep(30).tryOpenApiSolve(e);\n            http.mergeHeadAndBody({\n                body: {\n                    'drive_id': this.getMyDrivid(),\n                },\n                headers: {\n                    'authorization': this.openTokens.AccessTokenOpen\n                }\n            });\n            return true;\n        }).start(true);\n        return result;\n    },\n    getSearchListFile(key, marker, orderBy, orderDirection, mode) {\n        let type = \"\";\n        if (mode === 1) {\n            type = \"type=\\\"file\\\" and \";\n        } else if (mode === 2) {\n            type = \"type=\\\"folder\\\" and \";\n        }\n        let result = this.postApi(\"https://api.alipan.com/adrive/v3/file/search\").body({\n            \"drive_id\": this.getMyDrivid(),\n            \"query\": type + \"name match \" + JSON.stringify(key),\n            \"limit\": 100,\n            \"order_by\": orderBy + \" \" + orderDirection,\n            \"marker\": marker || undefined\n        }).headers({\n            'User-Agent': PC_UA,\n            'Referer': 'https://www.aliyundrive.com/',\n            'authorization': this.reaccessTk\n        }).errorWithRetry(2, (e, _, http) => {\n            this.waitSleep(20).refreshAccessToken();\n            //this.waitSleep(30).tryOpenApiSolve(e);\n            http.mergeHeadAndBody({\n                body: {\n                    'drive_id': this.getMyDrivid(),\n                },\n                headers: {\n                    'authorization': this.reaccessTk\n                }\n            });\n            return true;\n        }).start(true);\n        if (Object.keys(result).length === 0) {\n            result.items = [];\n        }\n        return result;\n    },\n    signInReward() {\n        let silData = this.postApi('https://member.aliyundrive.com/v1/activity/sign_in_list').body({\n            'grant_type': 'refresh_token',\n            'refresh_token': this.aliTokens.refresh_token\n        }).headers({\n            'Authorization': this.reaccessTk,\n            'Content-Type': 'application/json'\n        }).errorWithRetry((e, _, http) => {\n            this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'Authorization': this.reaccessTk,\n\n                },\n                body: {\n                    'refresh_token': this.aliTokens.refresh_token\n                }\n            });\n            return true;\n        }).start(true);\n        let day = silData.result.signInCount;\n        let isReward = silData.result.signInLogs[day - 1].isReward;\n        if (isReward) {\n            let reward = silData.result.signInLogs[day - 1].reward;\n            if (reward) {\n                let rewnotice = reward.notice;\n                return \"ä»Šå¤©å·²ç»ç­¾åˆ°ï¼Œè¯·ä¸è¦é‡å¤ç­¾åˆ°ï¼\\n\" + rewnotice;\n            } else {\n                //æ²¡æœ‰å¥–åŠ±ï¼Œåªæœ‰å¹¸è¿ç­¾åç‰‡\n                return \"ä»Šå¤©å·²ç»ç­¾åˆ°ï¼Œè¯·ä¸è¦é‡å¤ç­¾åˆ°ï¼\\nä»Šæ—¥å¥½è¿ç­¾:\" + silData.result.blessing;\n            }\n        } else {\n            let sirData = this.postApi('https://member.aliyundrive.com/v1/activity/sign_in_reward').body({\n                \"signInDay\": day\n            }).headers({\n                'Authorization': this.reaccessTk,\n                'Content-Type': 'application/json'\n            }).start(true);\n            let reward = sirData.result;\n            if (reward) {\n                let msg = \"ç­¾åˆ°æˆåŠŸ! è·å¾—å¥–åŠ±:\" + reward.notice + \"(\" + reward.subNotice + \") æœ¬æœˆå·²è¿ç»­ç­¾åˆ°:\" + day + \"å¤©\";\n                return msg;\n            } else {\n                //æ²¡æœ‰å¥–åŠ±ï¼Œåªæœ‰å¹¸è¿ç­¾åç‰‡\n                return \"ç­¾åˆ°æˆåŠŸï¼ä»Šæ—¥å¹¸è¿ç­¾:\" + silData.result.blessing;\n            }\n        }\n    }\n});\n\nAliAccessApi.createDefault = function(shareId, sharePwd, shareToken, aliToken, openToken, MY_TITLE) {\n    const {\n        openTokensFilepath,\n        aliTokensFilepath\n    } = $.require(\"tokenPath\" + (MY_TITLE ? \"?rule=\" + MY_TITLE : \"\"));\n    if (!openToken && openToken !== null && fileExist(openTokensFilepath)) {\n        openToken = $.require(openTokensFilepath);\n    }\n    if (!aliToken && fileExist(aliTokensFilepath)) {\n        aliToken = $.require(aliTokensFilepath);\n    }\n    if (MY_TITLE) {\n        shareToken = getVar(MY_TITLE + \"@aliShareToken\", shareToken);\n    } else {\n        shareToken = getMyVar(\"aliShareToken\", shareToken);\n    }\n    return new AliAccessApi({\n        shareId,\n        sharePwd,\n        shareToken,\n        aliTokens: aliToken,\n        openTokens: openToken,\n        openSuffix: (MY_TITLE ? \"?rule=\" + MY_TITLE : \"\"),\n        refreshAccessCallBack(result, api) {\n            writeFile(aliTokensFilepath, JSON.stringify(api.aliTokens));\n        },\n        refreshOpenCallBack(result, api) {\n            writeFile(openTokensFilepath, JSON.stringify(api.openTokens));\n        },\n        refreshShareCallBack(result) {\n            if (MY_TITLE) {\n                shareToken = putVar(MY_TITLE + \"@\" + \"aliShareToken\", result);\n            } else {\n                shareToken = putMyVar(\"aliShareToken\", result);\n            }\n        }\n    });\n}\n$.exports = AliAccessApi;\n\nfunction httpRequest(url, options) {\n    this.retryCount = 0;\n    this.url = url;\n    this.options = Object.assign({}, options, {\n        withHeaders: true\n    });\n    this.errorCallback = (err, res) => {\n        throw err\n    };\n    this.errorCallbackWithRetry = (err, res, tryRestart) => false;\n    this.successCallback = (body, res) => body;\n    this.errorTypeCallback = (err, res) => err;\n    this.startRequest = fetch;\n    this._bodyToString = false;\n}\n\nObject.assign(httpRequest.prototype, {\n    bodyToString(flag) {\n        this._bodyToString = !!flag;\n        return this;\n    },\n    body(body) {\n        this.options.body = body || void 0;\n        return this;\n    },\n    setStartRequestFunc(func) {\n        this.startRequest = func;\n        return this;\n    },\n    headers(headers) {\n        this.options.headers = headers || void 0;\n        return this;\n    },\n    success(successCallback) {\n        if (typeof successCallback !== \"function\") return this;\n        this.successCallback = successCallback;\n        return this;\n    },\n    error(errorCallback) {\n        if (typeof errorCallback !== \"function\") return this;\n        this.errorCallback = errorCallback;\n        return this;\n    },\n    errorType(errorTypeCallback) {\n        if (typeof errorTypeCallback !== \"function\") return this;\n        this.errorTypeCallback = errorTypeCallback;\n        return this;\n    },\n    errorWithRetry(retryCount, errorCallbackWithRetry) {\n        if (typeof retryCount === \"function\" && typeof errorCallbackWithRetry === \"undefined\") {\n            errorCallbackWithRetry = retryCount;\n            retryCount = 1;\n        }\n        if (typeof errorCallbackWithRetry !== \"function\") {\n            return this;\n        }\n        this.retryCount = Number(retryCount);\n        this.errorCallbackWithRetry = errorCallbackWithRetry;\n        return this;\n    },\n    start(toJson) {\n        let options = Object.assign({}, this.options);\n        if (typeof options.body === \"object\" && this._bodyToString) {\n            options.body = JSON.stringify(options.body);\n        }\n        var res = JSON.parse(this.startRequest(this.url, options));\n        try {\n            if (res.statusCode >= 200 && res.statusCode <= 300) {\n                let body = res.body;\n                if (toJson) {\n                    body = JSON.parse(body);\n                }\n                return this.successCallback(body, res);\n            } else {\n                throw new Error(String(res.statusCode));\n            }\n        } catch (err) {\n            try {\n                err = this.errorTypeCallback(err, res);\n            } catch (e) {\n\n            }\n            if (this.retryCount) {\n\n                let tryResult = this.errorCallbackWithRetry(err, res, this);\n                if (tryResult) {\n                    this.retryCount--;\n                    return this.start(toJson);\n                } else {\n                    this.retryCount = 0;\n                    return this.errorCallback(err, res);\n                }\n            } else {\n                return this.errorCallback(err, res);\n            }\n        }\n    },\n    setOptions(options) {\n        this.options = Object.assign({}, options, {\n            withHeaders: true\n        });\n        return this;\n    },\n    mergeHeadAndBody(options) {\n        options = options || {};\n        this.options.headers = Object.assign(this.options.headers, options.headers);\n        if (typeof this.options.body === \"object\" && typeof options.body === \"object\") {\n            this.options.body = Object.assign(this.options.body, options.body);\n        }\n        return this;\n    }\n});\n\nObject.assign(httpRequest, {\n    fetch(url, options) {\n        return new httpRequest(url, options);\n    },\n    post(url, options) {\n        return new httpRequest(url, options).setStartRequestFunc(post);\n    },\n    request(url, options) {\n        return new httpRequest(url, options).setStartRequestFunc(request);\n    },\n    postRequest(url, options) {\n        return new httpRequest(url, options).setStartRequestFunc(postRequest);\n    },\n    fetchCookie(url, options) {\n        return new httpRequest(url, options).setStartRequestFunc(fetchCookie);\n    }\n});"},{"col_type":"movie_3","name":"Tokenè·¯å¾„","path":"tokenPath","rule":"$.exports={\n    \"openTokensFilepath\": \"hiker://files/rules/LoyDgIk/aliOpenToken.json\",\n    \"aliTokensFilepath\": \"hiker://files/rules/LoyDgIk/aliToken.json\"\n}"},{"col_type":"movie_3","name":"å¼¹å¼¹playå·¥å…·","path":"danmu","rule":"js:\nlet basicUrl = \"https://api.dandanplay.net/\";\nlet sevePath = \"hiker://files/cache/danmu/\";\n\nfunction getRefreshRate() {\n    const Context = android.content.Context;\n    const Display = android.view.Display;\n    const WindowManager = android.view.WindowManager;\n    const context = com.example.hikerview.ui.Application().getContext();\n\n    let windowManager = context.getSystemService(Context.WINDOW_SERVICE);\n\n    let display = windowManager.getDefaultDisplay();\n\n    let refreshRate = display.getRefreshRate();\n    return refreshRate;\n}\n$.exports.getDanMu = function(key) {\n    var qqUrl=basicUrl + \"api/v2/search/episodes?anime=\" + encodeURIComponent(decodeURIComponent(key))\n   \n     let search=request(qqUrl,{\n        headers:{\n            'X-AppId':'ddplayandroidv3',\n            'X-AppSecret': 'pDa60YtGYCGKBpw28KfMe5iFiZuooF6V'\n        }\n        \n    })\n    return JSON.parse(search)\n}\n\n\nfunction encodeHtml(s) {\n    let REGX_HTML_ENCODE = /â€œ|&|â€™|\\u003C|>|[\\x00-\\x20]|[\\x7F-\\xFF]|[\\u0100-\\u2700]/g;\n   return s.replace(REGX_HTML_ENCODE, function($0) {\n        var c = $0.charCodeAt(0),\n            r = [\"&#\"];\n        c = (c == 0x20) ? 0xA0 : c;\n        r.push(c);\n        r.push(\";\");\n        return r.join(\"\");\n    });\n}\n\n\n\n//0é»˜è®¤ 1ç®€ä½“ 2ç¹ä½“\n$.exports.downloadDanMu = function(episodeId, name) {\n    let comment=basicUrl + \"api/v2/comment/\" + episodeId+\"?from=0&withRelated=true&chConvert=1\"\n       \n    let danMuData = JSON.parse(request(comment, {\n        headers:{\n            'X-AppId':'ddplayandroidv3',\n            'X-AppSecret': 'pDa60YtGYCGKBpw28KfMe5iFiZuooF6V'\n        }\n        \n    }));\n    let dMcontext = \"\";\n    //let fpsm = getRefreshRate()/60*0.95;\n    //danMuData.comments.sort((v,x)=>v.p.split(\",\")[0]-x.p.split(\",\")[0]);\n    for (let comment of danMuData.comments) {\n        //dMcontext += `<d p=\"${Math.round(timepoint)},${ct},${size},${color},0\">${content}</d>\\n`;\n        let paramText = comment.p;\n        let commentText = comment.m;\n        if (paramText == null || commentText == null) continue;\n        let params = paramText.split(\",\");\n        let paramsT = [];\n        for (let i in params) {\n            /*if (i == 0) {\n                paramsT.push(parseInt(params[i]));\n                continue;\n            }*/\n            if (i == 2) {\n                paramsT.push(\"25\");\n            }\n            if (i == 3) {\n                //é¢œè‰²å€¼ä¸º0æ—¶ï¼Œé»˜è®¤è®¾ç½®ä¸ºç™½è‰²\n                if (params[i] == \"0\" || params[i] == \"-1\") {\n                    paramsT.push(\"16777215\");\n                    continue\n                }\n                break;\n            }\n            paramsT.push(params[i]);\n        }\n        paramsT.push(\"0\");\n        let times=parseInt(params[0]/60)+\":\"+parseInt(params[0]%60);\n        dMcontext += `<d p=\"${paramsT.join(',')}\">${encodeHtml(commentText)/*+\"#\"+times*/}</d>\\n`;\n    }\n    if (!dMcontext) return;\n    dMcontext = `<?xml version=\"1.0\" encoding=\"UTF-8\"?><i>\\n${dMcontext}</i>`;\n    let path = sevePath + name.replace(/\\//g, \"_\") + \"_\" + episodeId + \".xml\";\n    writeFile(path, dMcontext);\n    return path;\n}\n$.exports.getLocalDanMu = function(episodeId, name) {\n    let path = sevePath + name.replace(/\\//g, \"_\") + \"_\" + episodeId + \".xml\";\n    if (fileExist(path)) {\n        return path;\n    }\n}"},{"col_type":"movie_3","name":"å¼¹å¹•æœç´¢&åŠ è½½","path":"loadDm","rule":"js:\nlet d = [];\nlet onlyDownload = !!MY_PARAMS.onlyDownload;\nif (onlyDownload) {\n    addListener(\"onClose\", () => {\n        refreshPage(false);\n    });\n}\nd.push({\n    col_type: \"rich_text\",\n    title: \"<font color='Gray'>â—å…³äº<br><small> å†…ç½®æœç´¢Pæ•°æ®æ¥æºäº[å¼¹å¼¹play]</small></font>\"\n});\nd.push({\n    col_type: \"line\"\n});\nlet key = MY_PARAMS.name || getMyVar(\"s\") || decodeURIComponent(getParam(\"title\", \"\")) || \"\";\nd.push({\n    title: \"å†…ç½®æœç´¢P\",\n    url: $(key, \"è¯·æœç´¢ç•ªå‰§åç§°\").input((MY_PARAMS) => {\n        setPageParams(Object.assign(MY_PARAMS, {\n            name: input,\n        }));\n        refreshPage();\n    }, MY_PARAMS),\n    col_type: \"text_3\"\n});\nd.push({\n    title: \"å†…ç½®æœç´¢T\",\n    url: $(key, \"æ ¼å¼ï¼šæœç´¢å…³é”®è¯[å›è½¦]é›†æ•°\").input((onlyDownload) => {\n        try {\n            showLoading(\"æ­£åœ¨æœç´¢å¹¶ä¸‹è½½...\");\n            let [name, pos] = input.split(\"\\n\");\n            if (!name || !pos) {\n                throw \"æ ¼å¼é”™è¯¯\";\n            }\n            let urlInfo = fetch(buildUrl(\"https://azure.leuse.top/searchdm\", {\n                params: {\n                    \"name\": name,\n                    \"pos\": pos\n                }\n            }));\n            urlInfo = JSON.parse(urlInfo);\n            if (!urlInfo.url) throw \"æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°è¯¥è§†é¢‘çš„å¼¹å¹•\";\n            let xml = fetch(buildUrl(\"https://azure.leuse.top/danmu\", {\n                params: urlInfo\n            }));\n            hideLoading();\n            if (!xml) {\n                throw \"è¿˜æ²¡æœ‰å¼¹å¹•å“Ÿ~\";\n            }\n            let path = \"hiker://files/cache/danmu/\" + urlInfo.platform + \"_\" + name + \"_\" + pos + \".xml\";\n            writeFile(path, '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n' + xml);\n            if (onlyDownload) return \"toast://ä¸‹è½½å®Œæˆ\";\n            refreshVideoUrl({\n                danmu: path\n            });\n            back(false);\n            return \"toast://åŠ è½½å®Œæˆ\";\n        } catch (e) {\n            hideLoading();\n            return \"toast://\" + e.toString();\n        }\n    }, onlyDownload),\n    col_type: \"text_3\"\n});\nd.push({\n    title: \"dmç›’å­æœç´¢\",\n    url: $(\"#noLoading#\").lazyRule((key, onlyDownload) => {\n        let dm = getVar(\"dm_share\");\n        if (dm && !onlyDownload) {\n            clearVar(\"dm_share\");\n            refreshVideoUrl({\n                danmu: dm\n            });\n            back(false);\n            return \"toast://åŠ è½½å®Œæˆ\";\n        } else {\n            return $(key, \"dmç›’å­æœç´¢\").input(() => {\n                toast(\"ä¸‹è½½å®Œæˆå¼¹å¹•åè¯·é‡æ–°ç‚¹å‡»æœç´¢\");\n                return \"hiker://search?rule=dmç›’å­&s=\" + input;\n            });\n        }\n    }, key, onlyDownload),\n    col_type: \"text_3\"\n});\n\nfunction search(d, name) {\n    const danmu = $.require(\"danmu\");\n    d.push({\n        col_type: \"line\"\n    });\n    d.push({\n        col_type: \"line\"\n    });\n    d.push({\n        col_type: \"line\"\n    });\n    let dmList = danmu.getDanMu(name);\n\n    for (let anime of dmList.animes) {\n        d.push({\n            title: anime.animeTitle,\n            desc: anime.typeDescription,\n            col_type: \"avatar\",\n            url: $(\"\", \"è¯·è¾“å…¥ä¸‹è½½èŒƒå›´(1,\" + anime.episodes.length + \")\").input((animeTitle, episodes) => {\n                let [a, b] = input.split(/,|ï¼Œ/);\n                a = Number(a), b = Number(b);\n                if (Number.isNaN(a) || Number.isNaN(b)) {\n                    return \"toast://è¯·æŒ‰æ ¼å¼è¾“å…¥æ•°å­—\";\n                }\n                if (a < 1 || b > episodes.length) {\n                    return \"toast://è¯·è¾“å…¥è§„å®šèŒƒå›´å†…çš„æ•°å­—\";\n                }\n                const danmu = $.require(\"danmu\");\n                try {\n                    for (let i = a - 1, j = 1; i < b; i++, j++) {\n                        let episode = episodes[i];\n                        let dmTitle = animeTitle + \"_\" + episode.episodeTitle;\n                        showLoading(\"æ­£åœ¨ä¸‹è½½ï¼š\" + episode.episodeTitle + \"\\t(\" + j + \"/\" + (b - a + 1) + \")\");\n                        danmu.downloadDanMu(episode.episodeId, dmTitle);\n                    }\n                } catch (e) {\n                    log(e.toString());\n                    hideLoading();\n                    return \"toast://å“¦å“¦ä¸‹è½½å¤±è´¥...\";\n                }\n                hideLoading();\n                return \"toast://ä¸‹è½½å®Œæˆ\";\n            }, anime.animeTitle, anime.episodes),\n            pic_url: \"http://123.56.105.145/tubiao/movie/14.svg\"\n        });\n        d.push({\n            col_type: \"line\"\n        });\n        for (let episode of anime.episodes) {\n            let dmTitle = anime.animeTitle + \"_\" + episode.episodeTitle;\n            d.push({\n                title: episode.episodeTitle,\n                url: $(episode.episodeId).lazyRule((url, title, onlyDownload) => {\n                    const danmu = $.require(\"danmu\");\n                    let path = danmu.getLocalDanMu(input, title) || danmu.downloadDanMu(input, title);\n                    if (onlyDownload) return \"toast://ä¸‹è½½å®Œæˆ\";\n                    let danmuText = fetch(path);\n                    if (!danmuText) return \"toast://è¿˜æ²¡æœ‰å¼¹å¹•å“Ÿ~\";\n                    refreshVideoUrl({\n                        danmu: path\n                    });\n                    back(false);\n                    return \"toast://åŠ è½½å®Œæˆ\";\n                }, MY_PARAMS.durl, dmTitle, onlyDownload),\n                col_type: \"text_1\",\n                extra: {\n                    longClick: [{\n                        title: \"å¼ºåˆ¶ä¸‹è½½\",\n                        js: $.toString((episodeTitle, episodeId) => {\n                            showLoading(\"è¯·ç­‰å¾…\");\n                            const danmu = $.require(\"danmu\");\n                            danmu.downloadDanMu(episodeId, episodeTitle);\n                            hideLoading();\n                            return \"toast://é‡æ–°ä¸‹è½½å®Œæˆï¼Œå•å‡»æŒ‚è½½ã€‚\";\n                        }, dmTitle, episode.episodeId)\n                    }]\n                }\n            });\n        }\n        d.push({\n            col_type: \"line_blank\"\n        });\n    }\n    if (!dmList.animes.length) {\n        d.push({\n            title: \"æ²¡æœ‰æ‰¾åˆ°ä¸[\" + name + \"]ç›¸å…³çš„å¼¹å¹•\",\n            url: \"hiker://empty\",\n            desc: \"æœä¸åˆ°æ€ä¹ˆåŠï¼Ÿ\\næ£€æŸ¥åç§°æ˜¯å¦æ­£ç¡®ï¼›å¯ä»¥å°è¯•åˆ é™¤éƒ¨åˆ†é™å®šè¯ï¼Œå¦‚ç¬¬ä¸€å­£ç­‰ï¼›è€Œä¸”åªèƒ½æœç´¢ç•ªå‰§å“¦ï¼å…¶ä»–å¼¹å¹•å¯ç”¨dmç›’å­ã€‚\",\n            col_type: \"text_center_1\"\n        });\n    }\n}\nlet name = getParam(\"name\", MY_PARAMS.name);\nif (name) {\n    try {\n        search(d, name);\n    } catch (e) {\n        d.push({\n            title: \"â€œâ€œERRORâ€â€\",\n            desc: e.toString(),\n            col_type: \"text_1\"\n        });\n    }\n}\nsetResult(d);"},{"col_type":"movie_3","name":"å…¬å¼€å·¥å…·","path":"aliUtil","rule":"//æä¾›ç»™è§„åˆ™ä½¿ç”¨çš„å¸¸ç”¨å‡½æ•°\n$.exports = {\n    checkali(realurl) {\n        try {\n            if (realurl.includes(\"com/s/\") && realurl != \"\") {\n                let shareId = realurl.split(\"?\")[0].split(\"/\")[4];\n                let share = fetch(\"https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous\", {\n                    headers: {\n                        'content-type': 'application/json',\n                        \"User-Agent\": PC_UA,\n                        \"Referer\": \"https://www.aliyundrive.com/\"\n                    },\n                    body: {\n                        \"share_id\": shareId\n                    },\n                    method: 'POST'\n                });\n                if (share.includes(\"share_link is\") || share.includes(\"share_link cannot\")) return false;\n            }\n        } catch (e) {}\n        return true;\n    },\n    bytesToSize(size) {\n        if (!size) {\n            return '0';\n        }\n        const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n        let i = 0;\n        while (size >= 1024) {\n            size /= 1024;\n            i++;\n        }\n        size = i ? Number(size.toFixed(2)) : size;\n        return `${size} ${units[i]}`;\n    },\n    getCryptoJS() {\n        if (typeof CryptoJS === \"undefined\") {\n            eval(getCryptoJS());\n            return CryptoJS;\n        }\n        return CryptoJS;\n    },\n    matchAliUrl(text, isG) {\n        return $.require(\"alitest\").matchAliUrl(text, isG);\n    },\n    getIPv4Address() {\n        const NetworkInterface = java.net.NetworkInterface;\n        try {\n            for (let en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();) {\n                let intf = en.nextElement();\n                for (let enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements();) {\n                    let inetAddress = enumIpAddr.nextElement();\n                    if (!inetAddress.isLoopbackAddress() && inetAddress instanceof java.net.Inet4Address) {\n                        return String(inetAddress.getHostAddress());\n                    }\n                }\n            }\n        } catch (ex) {\n            log(ex.toString());\n        }\n        return \"0.0.0.0\";\n    }\n}"},{"col_type":"movie_3","name":"å¼¹å¹•æ‰¹é‡æŒ‚è½½","path":"dmMount","rule":"js:\nlet d = [];\naddListener(\"onClose\", () => clearMyVar(\"dllastTime\"));\nsetPageTitle(\"å¼¹å¹•æŒ‚è½½:\"+(MY_PARAMS.folderName||\"?\"));\nd.push({\n    title: \"æ¸…ç©ºæŒ‚è½½åˆ—è¡¨\",\n    url: $(\"#noLoading#\").lazyRule(() => {\n        clearMyVar(\"dmlist\");\n        refreshPage(false);\n        return \"hiker://empty\";\n    }),\n    col_type: \"text_3\",\n});\nif(!MY_PARAMS.automaticadd){\n    MY_PARAMS.automaticadd = getItem(\"automaticadd\",\"1\");\n    setPageParams(MY_PARAMS);\n}\nd.push({\n    title: \"æ£€æµ‹æ–°å¢:\"+[\"å…³é—­\",\"å¼€å¯\"][MY_PARAMS.automaticadd||\"0\"],\n    url: $(\"#noLoading#\").lazyRule((v) => {\n       setItem(\"automaticadd\", v.automaticadd===\"1\"?\"0\":\"1\");\n       v.automaticadd = undefined;\n       setPageParams(v);\n       refreshPage(false);\n       return \"hiker://empty\";\n    }, MY_PARAMS),\n    col_type: \"text_3\",\n});\nd.push({\n    title: \"ä¸‹è½½å¼¹å¹•\",\n    col_type: \"text_3\",\n    url: \"hiker://page/loadDm#noHistory##noRecordHistory#\",\n    extra: {\n        onlyDownload: true,\n        name: MY_PARAMS.name||decodeURIComponent(getParam(\"name\",\"\"))\n    }\n});\nd.push({\n    col_type: \"line_blank\"\n});\nd.push({\n    title: \"â€œâ€œâ€â€\" + \"å·²æŒ‚è½½\".big(),\n    url: $(\"#noLoading#\").lazyRule(() => {\n        let dmlist = storage0.getMyVar(\"dmlist\", []);\n        let FileSorting = $.require(\"FileSorting\");\n        dmlist.sort((a, b) => FileSorting.nameCompare(a, b));\n        storage0.putMyVar(\"dmlist\", dmlist);\n        refreshPage(false);\n        return \"toast://æ’åºå®Œæˆ\";\n    }),\n    col_type: \"text_center_1\"\n});\nlet file = $.require(\"http://123.56.105.145/weisyr/js/file.js?v=1\");\nlet dmlist = storage0.getMyVar(\"dmlist\", []);\n\nfor (let i = 0; i < dmlist.length; i++) {\n    let dmname = dmlist[i];\n    d.push({\n        title: \"[\" + (i + 1) + \"]\\t\" + dmname,\n        url: $(\"#noLoading#\").lazyRule((i) => {\n            let dmlist = storage0.getMyVar(\"dmlist\", []);\n            dmlist.splice(i, 1);\n            storage0.putMyVar(\"dmlist\", dmlist);\n            refreshPage(false);\n            return \"hiker://empty\";\n        }, i),\n        col_type: \"text_1\"\n    });\n}\nd.push({\n    col_type: \"line_blank\"\n});\nd.push({\n    title: \"â€œâ€œâ€â€\" + \"æœ¬åœ°æœªæŒ‚è½½\".big(),\n    url: $(\"æ˜¯å¦æ¸…é™¤æ‰€æœ‰æœ¬åœ°å¼¹å¹•æ–‡ä»¶?\\n(å¼¹å¹•æ–‡ä»¶æ¯ä¸‰å¤©ä¼šè‡ªåŠ¨æ¸…é™¤)\").confirm(() => {\n        let file = $.require(\"http://123.56.105.145/weisyr/js/file.js?v=1\");\n        file.deleteFiles(getPath(\"hiker://files/cache/danmu/\").slice(7));\n        clearMyVar(\"dmlist\");\n        refreshPage(false);\n        return \"toast://å·²åˆ é™¤\";\n    }),\n    col_type: \"text_center_1\"\n});\nlet dmListPath = getPath(\"hiker://files/cache/danmu/\").slice(7);\nlet fileList = file.getFilePath(dmListPath, \"file\", \".xml\");\nlet lastTime = 0;\n\nfor (let i = 0; i < fileList.length; i++) {\n    let dmfile = fileList[i];\n    lastTime = Math.max(lastTime, dmfile.lastModified);\n    if (dmlist.includes(dmfile.name)) continue;\n    d.push({\n        title: dmfile.name,\n        url: $(\"#noLoading#\").lazyRule((name) => {\n            let dmlist = storage0.getMyVar(\"dmlist\", []);\n            if (!dmlist.includes(name)) {\n                dmlist.push(name);\n            }\n            storage0.putMyVar(\"dmlist\", dmlist);\n            refreshPage(false);\n            return \"hiker://empty\";\n        }, dmfile.name),\n        col_type: \"text_1\"\n    });\n}\nlet lastRecord = Number(getMyVar(\"dllastTime\", \"-1\"));\n\nif (MY_PARAMS.automaticadd===\"1\"&&lastRecord!=-1&&lastRecord < lastTime) {\n    confirm({\n        title: \"æ–°å¼¹å¹•æ–‡ä»¶\",\n        content: \"æ£€æŸ¥åˆ°æ–°ä¸‹è½½çš„å¼¹å¹•æ˜¯å¦å…¨éƒ¨æŒ‚è½½ï¼Ÿ\",\n        confirm: $.toString((lastRecord, dmListPath) => {\n            let file = $.require(\"http://123.56.105.145/weisyr/js/file.js?v=1\");\n            let fileList = file.getFilePath(dmListPath, \"file\", \".xml\");\n            let dmlist = storage0.getMyVar(\"dmlist\", []);\n            fileList.forEach(v => {\n                if (!dmlist.includes(v.name)&&v.lastModified > lastRecord) {\n                    dmlist.push(v.name);\n                }\n            });\n            storage0.putMyVar(\"dmlist\", dmlist);\n            refreshPage(false);\n            return \"toast://æŒ‚è½½æˆåŠŸã€‚\";\n        }, lastRecord, dmListPath),\n    });\n}\nif(lastTime>=0){\n    putMyVar(\"dllastTime\", \"\" + lastTime);\n}\nsetResult(d);"},{"col_type":"movie_3","name":"ä¸»é¡µå¤„ç†","path":"Main","rule":"if (getItem(\"first\") == MY_RULE.version) {\n    $.require(\"sou\");\n} else if (MY_PAGE === 1) {\n    let d = []\n    let time = getItem(\"first\", \"\") ? 6 : 20;\n    let id = Date.now();\n    let subPass = \"æµ·é˜”è§†ç•Œè§„åˆ™åˆ†äº«ï¼Œå½“å‰åˆ†äº«çš„æ˜¯ï¼šåˆé›†è§„åˆ™è®¢é˜…ï¿¥home_subï¿¥äº‘ç›˜å›.ç®€@@http://hiker.nokia.press/hikerule/rulelist.json?id=6591&debug=true\";\n    let content = `\n    1. æœ¬å°ç¨‹åºæ‰€æœ‰ä»£ç å…¨éƒ¨å¼€æºï¼Œä¸”æœ¬è§„åˆ™ä¸ºå­¦ä¹ ç›®çš„ï¼Œè¯·äºå¯¼å…¥24å°æ—¶å†…åˆ é™¤ï¼ï¼ï¼\n    2. æœ¬å°ç¨‹åº<b>å®Œå…¨å…è´¹</b>ï¼Œå¦‚æœä½ æ˜¯ä»˜è´¹è´­ä¹°çš„æ­å–œä½ è¢«éª—äº†ã€‚\n    å½“ç„¶å¦‚æœæœ‰èƒ½åŠ›æƒ³é¼“åŠ±ä½œè€…çš„å¯ä»¥${\"æ”¯æŒä¸€ä¸‹\".link(\"hiker://page/Donate.v#noHistory##noRecordHistory#\")}</a>(<small>ç‚¹å‡»å¯è¿›å…¥æèµ ï¼Œå¯åœ¨ä¸»é¡µèœå•è¿›å…¥</small>)ã€‚\n    3. æœ¬å°ç¨‹åºæ˜¯åœ¨åŸç‰ˆã€Œäº‘ç›˜å›ã€çš„åŸºç¡€è¿›è¡Œçš„äºŒæ¬¡ä¿®æ”¹ï¼Œè¯·æ”¯æŒåŸç‰ˆã€‚\n    4. è¯·ã€Œäº‘ç›˜å›.ç®€ã€çš„äºŒæ¬¡ä¿®æ”¹å°Šé‡ä¸€ä¸‹åŸç‰ˆï¼Œè°¢è°¢ã€‚\n    \n    <b>å¼€å§‹ä½¿ç”¨æœ¬è§„åˆ™å³ä»£è¡¨éµå®ˆè§„åˆ™æ¡ä¾‹</b>\n    å½“å‰ç‰ˆæœ¬ï¼š${MY_RULE.version}\n    å¦‚æœä½ æƒ³ä¿æŒæœ€æ–°ç‰ˆè¯·${\"è®¢é˜…æ­¤è§„åˆ™\".link(\"rule://\" + base64Encode(subPass))}\n    `;\n    let updateInfo = \"ä¿®å¤å›¾æ ‡å¼‚å¸¸\";\n    \n    d.push({\n        title: \"â€œâ€œâ€â€<strong>ä½¿ç”¨å‰é¡»çŸ¥</strong>\".big(),\n        col_type: \"text_center_1\",\n        url: \"hiker://empty\",\n        extra: {\n            lineVisible: false\n        }\n    });\n    d.push({\n        title: content.trim().replace(/\\n\\s*?/g, \"<br>\"),\n        \"col_type\": \"rich_text\"\n    }, {\n        col_type: \"line\"\n    }, {\n        title: time + \"ç§’åç»§ç»­\",\n        url: \"toast://è¯·è®¤çœŸé˜…è¯»ä»¥ä¸Šå†…å®¹\",\n        col_type: \"text_center_1\",\n        extra: {\n            id: id + \"timer\"\n        }\n    });\n    if (updateInfo) {\n        confirm({\n            title: \"æ›´æ–°å†…å®¹\",\n            content: updateInfo,\n            confirm(){},\n            cancel(){}\n        });\n    }\n    setResult(d);\n    while (time != 0) {\n        java.lang.Thread.sleep(1000);\n        time -= 1;\n        updateItem(id + \"timer\", {\n            title: time + \"ç§’åç»§ç»­\"\n        });\n    }\n    updateItem(id + \"timer\", {\n        title: \"â€œâ€œæˆ‘åŒæ„ä»¥ä¸Šè¦æ±‚â€â€\",\n        url: $(\"#noLoading#\").lazyRule((v) => {\n            setItem(\"first\", String(v));\n            refreshPage();\n            return \"toast://æ„Ÿè°¢æ‚¨çš„ç†è§£\";\n        }, MY_RULE.version),\n        col_type: \"text_center_1\"\n    });\n}"},{"col_type":"movie_3","name":"æèµ ","path":"Donate.v","rule":"js:\nlet d = [];\nsetPageTitle(\"æèµ /æ”¯æŒ\");\nd.push({\n    title: \"æèµ /æ”¯æŒ\",\n    desc: \"è¿™ä¸ªæèµ ä¸èƒ½ä¸ºä½ å¸¦æ¥ç‰¹æƒï¼Œä½†æ‚¨çš„æ”¯æŒæ˜¯æˆ‘æ›´æ–°åˆ›ä½œçš„åŠ¨åŠ›ã€‚\",\n    col_type: \"text_center_1\",\n    url: \"toast://æ„Ÿè°¢æ‚¨çš„æ”¯æŒ\"\n});\nd.push({\n    col_type: \"pic_1_full\",\n    url: \"https://gitee.com/LoyDgIk/LoyDgIk_Rule/raw/master/67d8f0187f0186c1.png\",\n    pic_url: \"https://gitee.com/LoyDgIk/LoyDgIk_Rule/raw/master/67d8f0187f0186c1.png\"\n});\nd.push({\n    col_type: \"text_center_1\",\n    title: \"â€œâ€œâ€â€\" + \"å›¾ç‰‡åŠ è½½ç¼“æ…¢è¯·ç¨ç­‰\".small().fontcolor(\"Gray\"),\n    url: \"hiker://empty\",\n    extra: {\n        lineVisible: false\n    }\n});\nsetResult(d);"},{"col_type":"movie_3","name":"TVBOXæ¨é€","path":"tvboxPush","rule":"js:\n(function() {\n    let d = [];\n    const {\n        pageId,\n        shareId,\n        folderName,\n        fileId\n    } = MY_PARAMS;\n    setPageTitle(\"TVBOXæ¨é€:\" + folderName);\n    const {\n        aliTokensFilepath\n    } = $.require(\"tokenPath\");\n    let refreshToken = \"\";\n    if (!fileExist(aliTokensFilepath)) {\n        toast(\"è¯·å…ˆç™»é™†ç™»å½•è´¦å·\");\n        back(false);\n        return;\n    } else {\n        refreshToken = $.require(aliTokensFilepath).refresh_token;\n    }\n\n    function getPush(name, url) {\n        let push = {\n            \"share_id\": shareId,\n            \"refresh_token\": refreshToken,\n            \"name\": name,\n            \"url\": url\n        };\n        return \"hiker://page/push#noHistory##noRecordHistory#?rule=XYQæ¨é€&pushurl=\" + encodeURIComponent(JSON.stringify(push));\n    }\n    d.push({\n        title: \"æ¨é€é˜¿é‡Œåˆ†äº«é“¾æ¥\",\n        url: \"hiker://page/push#noHistory##noRecordHistory#?rule=XYQæ¨é€&pushurl=\" + encodeURIComponent(\"https://www.aliyundrive.com/s/\" + shareId + (fileId ? \"/folder/\" + fileId : \"\")),\n        col_type: \"text_2\",\n        extra: {\n            inheritTitle: false\n        }\n    });\n    let all = {\n        title: \"æ¨é€å…¨éƒ¨å·²åŠ è½½è§†é¢‘\",\n        col_type: \"text_2\",\n        url: \"hiker://empty\",\n        extra: {\n            inheritTitle: false\n        }\n    }\n    d.push(all);\n    let allUrls = [];\n    let list = findItemsByCls(\"v\" + pageId);\n    if (!Array.isArray(list) || list.length === 0) {\n        /*toast(\"è¿˜æ²¡æœ‰åŠ è½½å®Œæˆçš„è§†é¢‘\");\n        back(false);\n        return;*/\n        d.push({\n            title: \"â€œâ€œâ€â€\" + \"~~~è¿˜æœ¨æœ‰è§†é¢‘å“¦~~~\".fontcolor(\"grey\"),\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            extra: {\n                lineVisible: false\n            }\n        });\n        all.url = \"toast://æ²¡æœ‰è§†é¢‘æ— æ³•æ¨é€\";\n    } else {\n        list.forEach(v => {\n            v.col_type = v.type;\n            let name = v.extra.pageTitle;\n            let url = name.replace(/\\#/g, '_').replace(/\\$/g, '_') + \"$video|\" + v.extra.id;\n            allUrls.push(url);\n            v.url = getPush(name, url);\n            v.extra.cls = v.extra.id = undefined;\n            d.push(v);\n        });\n        all.url = getPush(folderName, allUrls.join(\"#\"));\n    }\n    setResult(d);\n})();"},{"col_type":"movie_3","name":"å°é¢æœç´¢","path":"frontCover","rule":"js:\nlet d = [];\nlet key = getMyVar(\"frontcoverkey\", \"\");\nd.push({\n    title: \"æœç´¢\",\n    col_type: \"input\",\n    url: $.toString(() => {\n        putMyVar(\"frontcoverkey\", input.trim());\n        refreshPage(false);\n    }),\n    extra: {\n        defaultValue: key || getMyVar(\"s\", \"\")\n    }\n});\nif (key) {\n    let r = request('https://m.douban.com/search/?query=' + encodeURIComponent(key))\n    let list = pdfa(r, \".search-results&&img\");\n    for (let it of list) {\n        let pic = pdfh(it, \"img&&src\");\n        d.push({\n            pic_url: pic,\n            url: $(\"#noLoading#\").lazyRule((pic) => {\n                putMyVar(\"frontcoverpic\", pic);\n                back(false);\n                return \"toast://è®¾ç½®æˆåŠŸ\";\n            }, pic),\n            col_type: \"pic_2_card\"\n        });\n    }\n\n}\naddListener(\"onClose\", () => {\n    let pic = getMyVar(\"frontcoverpic\");\n    clearMyVar(\"frontcoverpic\");\n    clearMyVar(\"frontcoverkey\");\n    setPagePicUrl(pic);\n});\nsetResult(d);"},{"col_type":"movie_3","name":"è§„åˆ™æ–‡ä»¶","path":"configs","rule":"const path = \"hiker://files/rules/LoyDgIk/aliSimpleRules.json\";\nlet data;\n\nfunction getJson() {\n    if (Array.isArray(data)) {\n        return data;\n    }\n    try {\n        data = JSON.parse(readFile(path) || \"[]\");\n    } catch (e) {\n        deleteFile(path);\n        data = [];\n    }\n    return data;\n}\n\nfunction saveJson(json) {\n    saveFile(path, JSON.stringify(json));\n}\n\nfunction getUsefulJson() {\n    return getJson().filter(v => !v.forbidden);\n}\n\nfunction getForbiddenJson() {\n    return getJson().filter(v => v.forbidden);\n}\n\nfunction getGroupJson(group) {\n    return getJson().filter(v => v.group === group);\n}\n\nfunction getGroupNames() {\n    return Array.from(new Set(getJson().map(v => v.group))).filter(v => v);\n}\n\nif (!fileExist(path) && MY_RULE) {\n    let rules = $.require(\"rules\");\n    $.hiker.window = {};\n    eval.call(null, fetch('hiker://assets/beautify.js'));\n    rules = rules.map((v) => {\n        v.find = window.js_beautify(v.find.toString().replace(/function.*?\\(s.*?page\\).*?\\{/, \"\").replace(/(\\}[\\s\\S].*?)$/, \"\"));\n        if (v.findAliUrl) {\n            v.findAliUrl = window.js_beautify(v.findAliUrl.toString().replace(/function.*?\\(input\\).*?\\{/, \"\").replace(/(\\}[\\s\\S].*?)$/, \"\"));\n        }\n        return v;\n    });\n    saveJson(rules);\n    toast(\"å·²åˆå§‹åŒ–\");\n}\n$.exports = {\n    getJson,\n    saveJson,\n    getUsefulJson,\n    getForbiddenJson,\n    path,\n    getGroupNames,\n    getGroupJson\n};"},{"col_type":"movie_3","name":"è§„åˆ™ç®¡ç†","path":"ruleManage","rule":"js:\nvar d = [];\nsetPageTitle(\"è§„åˆ™ç®¡ç†\");\nlet configs = $.require(\"configs\");\nlet arr = configs.getJson();\nlet length = arr.length;\nlet groups = configs.getGroupNames();\nlet group = getItem(\"ruleManage_group\", \"\");\nif (!groups.includes(group)) {\n    clearItem(\"ruleManage_group\");\n    group = \"\";\n}\nd.push({\n    title: \"æ–°å¢\",\n    url: \"hiker://page/ruleEdit#noRecordHistory##noHistory##noRefresh#\",\n    col_type: \"icon_small_4\",\n    pic_url: \"hiker://images/icon_domain_config\",\n    extra: {\n        pageTitle: \"æ–°å¢è§„åˆ™\"\n    }\n});\n\nd.push({\n    title: \"åˆ†äº«\",\n    url: $(\"-1\", \"è¾“å…¥ä½ è¦åˆ†äº«è§„åˆ™çš„åºå·\\n-1å…¨éƒ¨ï¼Œ-2å·²å¯ç”¨çš„ï¼Œ-3å·²ç¦ç”¨çš„ï¼Œ-4,ç»„ååˆ†äº«ç»„ï¼Œå¤šä¸ªç”¨'ï¼Œ'éš”å¼€\").input((length) => {\n        let indexc = input.split(/,|ï¼Œ/);\n        let indexs = [];\n        let mo = parseInt(indexc[0]);\n        if (!(indexc.length !== 0 && mo < 0 && mo > -5)) {\n            for (let it of indexc) {\n                let num = parseInt(it);\n                if (Number.isNaN(num) || num >= length || num < 0) {\n                    return \"toast://æ•°å­—ä¸åˆæ³•\";\n                }\n                indexs.push(num);\n            }\n        }\n        return $([\"HIKER\", \"TXT\"].concat(getPastes()), 2, \"åˆ†äº«æ–¹å¼\").select((mo, indexs, ext) => {\n            function up(rules) {\n                let ruleb64 = base64Encode(JSON.stringify(rules));\n                let getPass = (length, rule, type) => \"æµ·é˜”è§†ç•Œäº‘ç®€æœç´¢å¼•æ“ï¼Œå…±ã€Œ\" + length + \"ã€æ¡ï¼Œå¤åˆ¶æ•´æ¡å£ä»¤æ‰“å¼€è½¯ä»¶å°±ä¼šè‡ªåŠ¨å¯¼å…¥$\" + rule + \"$\" + type + \"@import=js:$.require('import?rule='+\" + JSON.stringify(MY_RULE.title) + \")(input)\";\n                if (getPastes().includes(input)) {\n                    let u = sharePaste(ruleb64, input);\n                    return \"copy://\" + getPass(rules.length, u, \"b\");\n                } else {\n                    let path = \"hiker://files/_cache/äº‘ç®€æœç´¢å¼•æ“è§„åˆ™ã€Œ\" + rules.length + \"ã€æ¡.\" + (input === \"HIKER\" ? \"hiker\" : \"txt\");\n                    writeFile(path, getPass(rules.length, ruleb64, \"a\"));\n                    return \"share://\" + path;\n                }\n            }\n            let rules;\n            if (mo === -1) {\n                rules = $.require(\"configs\").getJson();\n            } else if (mo === -2) {\n                rules = $.require(\"configs\").getUsefulJson();\n            } else if (mo === -3) {\n                rules = $.require(\"configs\").getForbiddenJson();\n            } else if (mo === -4) {\n                let group = ext;\n                rules = $.require(\"configs\").getGroupJson(ext);\n                if (!rules.length) return \"toast://ä¸å­˜åœ¨è¯¥ç»„\";\n            } else {\n                rules = $.require(\"configs\").getJson().filter((v, i) => indexs.includes(i));\n            }\n            rules = rules.map((v) => {\n                v.user = undefined;\n                v.forbidden = undefined;\n                return v;\n            });\n            return up(rules);\n        }, mo, indexs, indexc[1]);\n\n    }, length),\n    col_type: \"icon_small_4\",\n    pic_url: \"hiker://images/icon_share_green\"\n});\nd.push({\n    title: \"é‡ç½®\",\n    url: $(\"ä½ ç¡®å®šé‡ç½®ï¼Ÿ\\nè¯¥æ“ä½œä¼šåˆ é™¤ç°æœ‰è§„åˆ™ï¼Œæ¢å¤è‡ªå¸¦è§„åˆ™ã€‚\").confirm((path) => {\n        deleteFile(path);\n        refreshPage(false);\n        return \"hiker://empty\";\n    }, $.require(\"configs\").path),\n    col_type: \"icon_small_4\",\n    pic_url: \"hiker://images/icon_refresh\"\n});\nd.push({\n    title: \"æ¸…ç©º\",\n    url: $(\"ä½ ç¡®å®šå…¨éƒ¨åˆ é™¤ï¼Ÿ\\nè¯¥æ“ä½œä¼šåˆ é™¤ç°æœ‰è§„åˆ™ã€‚\").confirm((path) => {\n        writeFile(path, \"[]\");\n        refreshPage(false);\n        return \"hiker://empty\";\n    }, $.require(\"configs\").path),\n    col_type: \"icon_small_4\",\n    pic_url: \"hiker://images/icon_code_view\"\n});\n\nd.push({\n    //title: '<font color=\"#13B61B\">â– </font><b>è§„åˆ™åˆ—è¡¨<b> (' + String(length).fontcolor(\"#ff6601\") + \")\",\n    col_type: \"rich_text\",\n});\nlet countTitle = d.at(-1);\nd.push({\n    title: group ? \"å…¨éƒ¨\" : \"â€œâ€œå…¨éƒ¨â€â€\",\n    url: $(\"#noLoading#\").lazyRule((group, length) => {\n        if (group) {\n            clearItem(\"ruleManage_group\");\n            refreshPage(false);\n            return \"hiker://empty\";\n        } else {\n            return $(\"\", \"æ‰¹é‡åˆ é™¤\\næ ¼å¼:å¼€å§‹ä½ç½®ï¼Œç»“æŸä½ç½®(åŒºé—´[0,\" + (length - 1) + \"])\").input((length) => {\n                let [start, end] = input.split(/,|ï¼Œ/);\n                start = parseInt(start), end = parseInt(end);\n                if (Number.isNaN(start) || Number.isNaN(end) || start < 0 || end > length - 1 || start > end) {\n                    return \"toast://æ•°å­—ä¸åˆæ³•\";\n                }\n                let number = end - start + 1;\n                return $(\"ç¡®è®¤åˆ é™¤ï¼š[\" + start + \",\" + end + \"]\\nå…±\" + number + \"æ¡æœç´¢å¼•æ“\").confirm((start, number) => {\n                    let rules = $.require(\"configs\").getJson();\n                    rules.splice(start, number);\n                    $.require(\"configs\").saveJson(rules);\n                    refreshPage(false);\n                }, start, number);\n            }, length);\n        }\n    }, group, length),\n    col_type: \"scroll_button\"\n});\nfor (let it of groups) {\n    d.push({\n        title: it === group ? \"â€œâ€œ\" + it + \"â€â€\" : it,\n        url: $(\"#noLoading#\").lazyRule((it, group) => {\n            if (group !== it) {\n                setItem(\"ruleManage_group\", it);\n                refreshPage();\n                return \"hiker://empty\";\n            } else {\n                return $([\"ç½®é¡¶\", \"ç½®åº•\", \"æ”¹å\", \"åˆ é™¤\"]).select((it) => {\n                    if (\"æ”¹å\" === input) {\n                        return $(it, \"è¯·è¾“å…¥æ–°åç§°\").input((it) => {\n                            let rules = $.require(\"configs\").getJson();\n                            rules.forEach(v => {\n                                if (it === v.group) {\n                                    v.group = input;\n                                }\n                            });\n                            $.require(\"configs\").saveJson(rules);\n                            clearItem(\"ruleManage_group\");\n                            refreshPage(false);\n                        }, it);\n                    } else if (\"åˆ é™¤\" === input) {\n                        return $(\"æ˜¯å¦åˆ é™¤è¯¥ç»„æœç´¢å¼•æ“ï¼š\" + it).confirm((it) => {\n                            let rules = $.require(\"configs\").getJson();\n                            rules = rules.filter(v => v.group !== it);\n                            $.require(\"configs\").saveJson(rules);\n                            clearItem(\"ruleManage_group\");\n                            refreshPage(false);\n                        }, it);\n                    }\n                    let rules = $.require(\"configs\").getJson();\n                    let tgRules = [],\n                        txRules = [];\n                    rules.forEach((v) => {\n                        if (it === v.group) {\n                            tgRules.push(v);\n                        } else {\n                            txRules.push(v);\n                        }\n                    });\n                    if (input === \"ç½®é¡¶\") {\n                        tgRules = tgRules.concat(txRules);\n                    } else {\n                        tgRules = txRules.concat(tgRules);\n                    }\n                    $.require(\"configs\").saveJson(tgRules);\n                    refreshPage(false);\n                }, it);\n            }\n\n        }, it, group),\n        col_type: \"scroll_button\"\n    });\n}\n\nlet count = d.length;\n\nfor (let i = 0; i < length; i++) {\n    let it = arr[i];\n    if (group && group !== it.group) continue;\n    let user = it.user || {};\n\n    d.push({\n        title: 'â€œâ€œâ€â€[' + i + ']<b>  ' + it.name + (it.group ? \"|\" + it.group.small() : \"\") + '<b>' + (it.forbidden ? \" #â€œâ€œç¦ç”¨â€â€\".small() : \"\") + (it.registerUrl && !(user.password || user.account || user.extra) ? \" #éœ€è¦ç™»å½•\".small() : \"\"),\n        url: $([\"ç¼–è¾‘\", \"è´¦å·\", \"åˆ†äº«\", \"ç¦ç”¨/å¯ç”¨\", \"ç§»åŠ¨\", \"ç½®é¡¶\", \"åˆ é™¤\"], 1, \"æ“ä½œï¼š\" + it.name).select((index, length, group) => {\n            if (input === \"ç¼–è¾‘\") {\n                return \"hiker://page/ruleEdit#noRecordHistory##noHistory##noRefresh#\";\n            } else if (input === \"è´¦å·\") {\n                return \"hiker://page/password#noRecordHistory##noHistory##noRefresh#\";\n            } else if (input === \"åˆ†äº«\") {\n                let ops = getPastes();\n                ops.unshift(\"å®Œæ•´å£ä»¤\");\n                return $(ops, 2, \"åˆ†äº«æ–¹å¼\").select((index) => {\n                    let rule = $.require(\"configs\").getJson()[index];\n                    rule.user = undefined;\n                    rule.forbidden = undefined;\n                    let ruleb64 = base64Encode(JSON.stringify(rule));\n                    let getPass = (name, rule, type) => \"æµ·é˜”è§†ç•Œï¼Œã€Œ\" + name + \"ã€äº‘ç®€æœç´¢å¼•æ“ï¼Œå¤åˆ¶æ•´æ¡å£ä»¤æ‰“å¼€è½¯ä»¶å°±ä¼šè‡ªåŠ¨å¯¼å…¥$\" + rule + \"$\" + type + \"@import=js:$.require('import?rule='+\" + JSON.stringify(MY_RULE.title) + \")(input)\";\n                    if (input == \"å®Œæ•´å£ä»¤\") {\n                        return \"copy://\" + getPass(rule.name, ruleb64, \"a\");\n                    } else {\n                        let u = sharePaste(ruleb64, input);\n                        return \"copy://\" + getPass(rule.name, u, \"b\");\n                    }\n                }, index);\n            } else if (input === \"ç§»åŠ¨\") {\n                return $(index + \"\", \"è¾“å…¥ä½ç½®\").input((index, length) => {\n                    let newIndex = Number(input);\n                    if (Number.isNaN(newIndex) || newIndex >= length) {\n                        return \"toast://ä¸å’Œè§„çš„ä½ç½®\";\n                    }\n                    let rules = $.require(\"configs\").getJson();\n                    let rule = rules.splice(index, 1)[0];\n                    rules.splice(newIndex, 0, rule);\n                    $.require(\"configs\").saveJson(rules);\n                    refreshPage(false);\n                }, index, length);\n            } else if (input === \"ç½®é¡¶\") {\n                let newIndex = 0;\n                let rules = $.require(\"configs\").getJson();\n                if (group) {\n                    newIndex = rules.findIndex(v => v.group === group);\n                    newIndex = newIndex === -1 ? 0 : newIndex;\n                }\n                let rule = rules.splice(index, 1)[0];\n                rules.splice(newIndex, 0, rule);\n                $.require(\"configs\").saveJson(rules);\n                refreshPage(false);\n            } else if (input === \"åˆ é™¤\") {\n                return $(\"ç¡®è®¤åˆ é™¤ï¼Ÿ\").confirm((index) => {\n                    let rules = $.require(\"configs\").getJson();\n                    let rule = rules.splice(index, 1)[0];\n                    $.require(\"configs\").saveJson(rules);\n                    refreshPage(false);\n                    return \"toast://å·²åˆ é™¤\" + rule.name;\n                }, index);\n            } else {\n                let arr = $.require(\"configs\").getJson();\n                let rule = arr[index];\n                rule.forbidden = !rule.forbidden;\n                $.require(\"configs\").saveJson(arr);\n                refreshPage(false);\n                //return \"toast://\" + (rule.forbidden ? \"ç¦ç”¨\" : \"å¯ç”¨\") + rule.name;\n            }\n        }, i, length, group),\n        col_type: \"text_1\",\n        extra: {\n            i: i,\n            pageTitle: it.name\n        }\n    });\n}\ncountTitle.title = '<font color=\"#13B61B\">â– </font><b>è§„åˆ™åˆ—è¡¨<b> (' + ((d.length - count) + \"/\" + length).fontcolor(\"#ff6601\") + \")\";\nsetResult(d);"},{"col_type":"movie_3","name":"è§„åˆ™ç¼–è¾‘","path":"ruleEdit","rule":"js:\nvar d = [];\n\naddListener(\"onClose\", $.toString(() => {\n    clearMyVar(\"ps_name\");\n    clearMyVar(\"ps_find\");\n    clearMyVar(\"ps_findAliUrl\");\n    clearMyVar(\"ps_page\");\n    clearMyVar(\"ps_registerUrl\");\n    clearMyVar(\"ps_basicUrl\");\n    clearMyVar(\"ps_group\");\n    clearMyVar(\"ps_author\");\n    clearMyVar(\"ps_ruleType\");\n}));\nlet urlIndex = parseInt(getParam(\"index\", \"\"));\nurlIndex = Number.isNaN(urlIndex) ? void(0) : urlIndex;\nlet index = void(0) === urlIndex ? MY_PARAMS.i : urlIndex;\nlet isImport = !!getParam(\"isImport\", \"\");\nlet arr = $.require(\"configs\").getJson();\nlet obj;\nif (isImport) {\n    try {\n        obj = $.require(\"hiker://files/_cache/yunSimpleImport.json\");\n        let tip = index !== void(0) ? \"æ›´æ–°è§„åˆ™\" : \"å¯¼å…¥è§„åˆ™\";\n        setPageTitle(tip + \":\" + obj.name);\n        d.push({\n            title: \"â€˜â€˜\" + tip + \"â€™â€™\",\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            extra: {\n                lineVisible: false\n            }\n        });\n\n    } catch (e) {\n        obj = {};\n        back();\n        toast(\"å¯¼å…¥é”™è¯¯\");\n    }\n} else if (index !== void(0)) {\n    obj = arr[index];\n    setPageTitle(\"ç¼–è¾‘è§„åˆ™:\" + obj.name);\n    if (obj.lastModify) {\n        d.push({\n            title: \"ä¸Šæ¬¡ä¿®æ”¹ï¼š\" + $.dateFormat(obj.lastModify, \"yyyy-MM-ddÂ HH:mm:ss\"),\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            extra: {\n                lineVisible: false\n            }\n        });\n    }\n} else {\n    obj = {\n        page: true,\n        author: com.example.hikerview.utils.PreferenceMgr.getString(getCurrentActivity(), \"myName\", \"\")\n    };\n    setPageTitle(\"æ–°å»ºè§„åˆ™\");\n}\n\nd.push({\n    col_type: \"input\",\n    desc: \"åå­—(å¿…å¡«)\",\n    extra: {\n        onChange: $.toString(() => {\n            putMyVar(\"ps_name\", input);\n        }),\n        defaultValue: obj.name,\n        titleVisible: false\n    }\n});\nd.push({\n    title: \"ç­¾å\",\n    col_type: \"input\",\n    desc: \"ä½œè€…(é€‰å¡«)\",\n    url: $.toString(() => {\n        let author = getMyVar(\"ps_author\", \"\");\n        let my = String(com.example.hikerview.utils.PreferenceMgr.getString(getCurrentActivity(), \"myName\", \"\"));\n        let newAuthor = \"\";\n        if (author && !author.includes(my)) {\n            newAuthor = author + \"&\" + my;\n        } else {\n            newAuthor = my;\n        }\n        updateItem(\"id@ps_author\", {\n            extra: Object.assign(findItem(\"id@ps_author\").extra, {\n                defaultValue: newAuthor\n            })\n        });\n    }),\n    extra: {\n        onChange: $.toString(() => {\n            putMyVar(\"ps_author\", input);\n        }),\n        defaultValue: obj.author,\n        id: \"id@ps_author\"\n        //titleVisible: false\n    }\n});\nd.push({\n    title: \"é€‰æ‹©\",\n    col_type: \"input\",\n    desc: \"åˆ†ç»„(é€‰å¡«)\",\n    url: $.toString(() => {\n        let group = $.require(\"configs\").getGroupNames();\n        if (!group.length) {\n            return \"\";\n        }\n        return $(group).select(() => {\n            let extra = findItem(\"ruleEditGroup\").extra;\n            updateItem(\"ruleEditGroup\", {\n                extra: Object.assign(extra, {\n                    defaultValue: input\n                })\n            });\n        });\n    }),\n    extra: {\n        onChange: $.toString(() => {\n            putMyVar(\"ps_group\", input);\n        }),\n        id: \"ruleEditGroup\",\n        defaultValue: obj.group,\n    }\n});\nd.push({\n    col_type: \"input\",\n    desc: \"æœç´¢è§„åˆ™(å¿…å¡«)\\nå†…ç½®å˜é‡ï¼šsæœç´¢å…³é”®è¯ï¼Œpageé¡µæ•°ï¼ŒbasicUrlåŸºæœ¬é“¾æ¥ï¼Œuserç”¨æˆ·è´¦å·ä¿¡æ¯(user.account,user.password)\",\n    extra: {\n        type: \"textarea\",\n        height: 3,\n        highlight: true,\n        onChange: $.toString(() => {\n            putMyVar(\"ps_find\", input);\n        }),\n        defaultValue: obj.find,\n        titleVisible: false,\n    }\n});\nd.push({\n    col_type: \"input\",\n    desc: \"URLè§„åˆ™(é€‰å¡«)\\nå†…ç½®å˜é‡ï¼šinputé“¾æ¥ï¼ŒbasicUrlåŸºæœ¬é“¾æ¥\",\n    extra: {\n        type: \"textarea\",\n        height: 3,\n        highlight: true,\n        onChange: $.toString(() => {\n            putMyVar(\"ps_findAliUrl\", input);\n        }),\n        defaultValue: obj.findAliUrl,\n        titleVisible: false,\n    }\n});\nd.push({\n    col_type: \"input\",\n    desc: \"åŸºæœ¬é“¾æ¥(é€‰å¡«) ä»£ç ä¸­ç”¨basicUrlå¼•ç”¨\",\n    extra: {\n        onChange: $.toString(() => {\n            putMyVar(\"ps_basicUrl\", input);\n        }),\n        defaultValue: obj.basicUrl,\n        titleVisible: false,\n    }\n});\nd.push({\n    col_type: \"input\",\n    desc: \"æ³¨å†Œåœ°å€(é€‰å¡«)\",\n    extra: {\n        onChange: $.toString(() => {\n            putMyVar(\"ps_registerUrl\", input);\n        }),\n        defaultValue: obj.registerUrl,\n        titleVisible: false,\n    }\n});\nd.push({\n    title: \"æ˜¯å¦å¯ä»¥ç¿»é¡µï¼š\" + obj.page,\n    col_type: \"text_2\",\n    url: $(\"#noLoading#\").lazyRule((page) => {\n        let isPage = !!getMyVar(\"ps_page\", page ? \"1\" : \"\");\n        putMyVar(\"ps_page\", isPage ? \"\" : \"1\");\n        updateItem(\"ruleedps_page\", {\n            title: \"æ˜¯å¦å¯ä»¥ç¿»é¡µï¼š\" + !isPage\n        });\n        return \"hiker://empty\";\n    }, obj.page),\n    extra: {\n        id: \"ruleedps_page\"\n    }\n});\nputMyVar(\"ps_ruleType\", (obj.ruleType||\"\"));\nd.push({\n    title: \"è§£ææ¨¡å¼ï¼š\" + (obj.ruleType || \"JS\"),\n    col_type: \"text_2\",\n    url: $([\"JS\", \"JSON\", \"HTML\"]).select(() => {\n\n        putMyVar(\"ps_ruleType\", input === \"JS\" ? \"\" : input);\n        updateItem(\"ps_ruleType\", {\n            title: \"è§£ææ¨¡å¼ï¼š\" + input\n        });\n        return \"hiker://empty\";\n    }),\n    extra: {\n        id: \"ps_ruleType\"\n    }\n});\nd.push({\n    title: \"åˆ é™¤\",\n    url: $(\"#noLoading#\").lazyRule((index, urlIndex) => {\n        if (index === void(0)) {\n            return \"toast://æ­¤é¡¹æ— æ³•åˆ é™¤\";\n        }\n        if (urlIndex !== void(0)) {\n            return \"toast://æ­£åœ¨æ›´æ–°è§„åˆ™ï¼Œåˆ é™¤è¯·ä»è§„åˆ™ç®¡ç†è¿›å…¥\";\n        }\n        confirm({\n            title: \"æ¸©é¦¨æç¤º\",\n            content: \"ç¡®å®šè¦åˆ é™¤æ­¤è§„åˆ™å—ï¼Ÿæ³¨æ„åˆ é™¤åæ— æ³•æ¢å¤\",\n            confirm: $.toString((index) => {\n                let arr = $.require(\"configs\").getJson();\n                arr.splice(index, 1);\n                $.require(\"configs\").saveJson(arr);\n                back(true);\n                return \"toast://åˆ é™¤æˆåŠŸ\";\n            }, index)\n        });\n        return \"hiker://empty\"\n    }, index, urlIndex),\n    col_type: \"text_3\",\n});\nd.push({\n    title: \"æµ‹è¯•\",\n    url: $(\"#noLoading#\").lazyRule(page => {\n        let testKeyword = getItem(\"testKeyword\", \"\");\n        return $(testKeyword, \"è¯·è¾“å…¥å…³é”®è¯\").input((page) => {\n            setItem(\"testKeyword\", input);\n            let name = getMyVar(\"ps_name\", \"\");\n            let find = getMyVar(\"ps_find\", \"\");\n            if (!find) {\n                return \"toast://æœç´¢è§„åˆ™ä¸èƒ½ä¸ºç©º\";\n            }\n            let arr = $.require(\"configs\").getJson();\n            let testRule = {\n                name: name,\n                find: find,\n                basicUrl: getMyVar(\"ps_basicUrl\", \"\"),\n                findAliUrl: getMyVar(\"ps_findAliUrl\", \"\"),\n                page: !!getMyVar(\"ps_page\", page ? \"1\" : \"\"),\n                ruleType: getMyVar(\"ps_ruleType\", \"\"),\n            };\n            return $(\"hiker://empty#noRecordHistory##noHistory#?fypage\").rule((testRule, key) => {\n                if (MY_PAGE > 1 && !testRule.page) setResult([]);\n                setResult($.require(\"data\").carryRule(testRule, key, MY_PAGE, 0));\n            }, testRule, input);\n        }, page);\n    }, obj.page),\n    col_type: \"text_3\",\n});\n\n\nd.push({\n    title: \"ä¿å­˜\",\n    url: $(\"#noLoading#\").lazyRule((index, page, isImport) => {\n        let name = getMyVar(\"ps_name\", \"\");\n        if (!name) {\n            return \"toast://åå­—å¾—æœ‰ä¸€ä¸ªå§\";\n        }\n        let find = getMyVar(\"ps_find\", \"\");\n        if (!find) {\n            return \"toast://æœç´¢è§„åˆ™ä¸èƒ½ä¸ºç©º\";\n        }\n        let arr = $.require(\"configs\").getJson();\n        let obj1 = {\n            name: name,\n            author: getMyVar(\"ps_author\", \"\"),\n            find: find,\n            basicUrl: getMyVar(\"ps_basicUrl\", \"\"),\n            findAliUrl: getMyVar(\"ps_findAliUrl\", \"\"),\n            page: !!getMyVar(\"ps_page\", page ? \"1\" : \"\"),\n            registerUrl: getMyVar(\"ps_registerUrl\", \"\") || undefined,\n            lastModify: Date.now(),\n            group: getMyVar(\"ps_group\", \"\"),\n            ruleType: getMyVar(\"ps_ruleType\", \"\"),\n        };\n        if (index === void(0)) {\n            if (arr.some(v => v.name === name)) {\n                return \"toast://å·²ç»å­˜åœ¨è¯¥è§„åˆ™\";\n            }\n            if (obj1.group) {\n                let group = obj1.group;\n                let index = arr.findIndex(v => v.group === group);\n                if (index === -1) {\n                    arr.unshift(obj1);\n                } else {\n                    arr.splice(index, 0, obj1);\n                }\n            } else {\n                if (isImport) {\n                    arr.push(obj1);\n                } else {\n                    arr.unshift(obj1);\n                }\n            }\n        } else {\n            let namey = arr[index].name;\n            if (name !== namey) {\n                if (arr.some(v => v.name === name)) {\n                    return \"toast://å·²ç»å­˜åœ¨è¯¥è§„åˆ™\";\n                }\n            }\n            obj1 = Object.assign(arr[index], obj1);\n            arr.splice(index, 1, obj1);\n        }\n        $.require(\"configs\").saveJson(arr);\n        back(true);\n        return \"toast://ä¿å­˜æˆåŠŸ\";\n    }, index, obj.page, isImport),\n    col_type: \"text_3\",\n});\n\nsetResult(d);"},{"col_type":"movie_3","name":"è§„åˆ™è´¦å·","path":"password","rule":"js:\n(function() {\n    var d = [];\n    addListener(\"onClose\", $.toString(() => {\n        clearMyVar(\"ps_account\");\n        clearMyVar(\"ps_password\");\n        clearMyVar(\"ps_extra\");\n    }));\n    let index = MY_PARAMS.i;\n    let arr = $.require(\"configs\").getJson();\n    let obj = arr[index] || {};\n    setPageTitle(\"è®¾ç½®è´¦å·:\" + obj.name);\n    let registerUrl = obj.registerUrl;\n    if (registerUrl) {\n        d.push({\n            col_type: \"text_center_1\",\n            title: \"å‰å¾€æ³¨å†Œ\",\n            url: $(\"hiker://empty#noRecordHistory##noHistory#\").rule((registerUrl)=>{\n                setResult([{\n                    col_type:\"x5_webview_single\",\n                    url:registerUrl,\n                    desc:\"float&&100%\"\n                }]);\n            }, registerUrl),\n            extra:{\n                pageTitle: \"æ³¨å†Œè´¦å·:\" + obj.name\n            }\n        });\n    }\n    obj = obj.user || {};\n    d.push({\n        col_type: \"input\",\n        desc: \"ç”¨æˆ·å\",\n        extra: {\n            onChange: $.toString(() => {\n                putMyVar(\"ps_account\", input);\n            }),\n            defaultValue: obj.account,\n            titleVisible: false\n        }\n    });\n    d.push({\n        col_type: \"input\",\n        desc: \"å¯†ç \",\n        extra: {\n            type: \"password\",\n            onChange: $.toString(() => {\n                putMyVar(\"ps_password\", input);\n            }),\n            defaultValue: obj.password,\n            titleVisible: false,\n        }\n    });\n    d.push({\n        col_type: \"input\",\n        desc: \"é¢å¤–\",\n        extra: {\n            type: \"textarea\",\n            onChange: $.toString(() => {\n                putMyVar(\"ps_extra\", input);\n            }),\n            defaultValue: obj.extra,\n            titleVisible: false,\n            height: -1\n        }\n    });\n    d.push({\n        title: \"ä¿å­˜\",\n        url: $(\"#noLoading#\").lazyRule((index) => {\n            let account = getMyVar(\"ps_account\", \"\");\n            let password = getMyVar(\"ps_password\", \"\");\n            let extra = getMyVar(\"ps_extra\", \"\");\n            /*if (!(account||password||extra)) {\n                return \"toast://ä¸èƒ½å…¨éƒ¨ä¸ºç©º\";\n            }*/\n            let arr = $.require(\"configs\").getJson();\n            let item = arr[index];\n            item.user = {};\n            item.user.account = account\n            item.user.password = password;\n            item.user.extra = extra;\n            if (index === void(0)) {\n                return \"toast://idé”™è¯¯\";\n            } else {\n                arr.splice(index, 1, item);\n            }\n            $.require(\"configs\").saveJson(arr);\n            back(true);\n            return \"toast://ä¿å­˜æˆåŠŸ\";\n        }, index),\n        col_type: \"text_center_1\",\n    });\n    setResult(d);\n})()"},{"col_type":"movie_3","name":"è§„åˆ™å¯¼å…¥","path":"import","rule":"js:\nfunction saveCache(json) {\n    writeFile(\"hiker://files/_cache/yunSimpleImport.json\", JSON.stringify(json));\n}\n$.exports = function(pass) {\n    try {\n        let [_, rule, type] = pass.split(\"$\");\n        if (type === \"b\") {\n            rule = parsePaste(rule);\n        }\n        let rules = JSON.parse(base64Decode(rule));\n        if (!Array.isArray(rules)) {\n            rules = [rules];\n        }\n        //rules.reverse();\n        MY_URL = module.id;\n        let ruleTitle = getParam(\"rule\");\n        let arr = $.require(\"configs?rule=\" + ruleTitle).getJson();\n        let newI = 0;\n        for (let rule of rules) {\n            let index = arr.findIndex(v => v.name === rule.name);\n            if (index > -1) {\n                rule = Object.assign(arr[index], rule);\n                arr.splice(index, 1, rule);\n                if (rules.length === 1) {\n                    saveCache(rule);\n                    return \"hiker://page/ruleEdit#noHistory##noRecordHistory#?isImport=true&index=\" + index + \"&rule=\" + ruleTitle;\n                    //toast(\"å·²æ›´æ–°è§„åˆ™ï¼š\" + rule.name);\n                } else {\n                    log(\"å·²æ›´æ–°è§„åˆ™ï¼š\" + rule.name)\n                }\n            } else {\n                newI++;\n                arr.push(rule);\n                if (rules.length === 1) {\n                    saveCache(rule);\n                    return \"hiker://page/ruleEdit#noHistory##noRecordHistory#?isImport=true&rule=\" + ruleTitle;\n                    //toast(\"å·²å¯¼å…¥è§„åˆ™ï¼š\" + rule.name);\n                } else {\n                    log(\"å·²å¯¼å…¥è§„åˆ™ï¼š\" + rule.name)\n                }\n            }\n        }\n        if (rules.length > 1) {\n            $.require(\"configs?rule=\" + ruleTitle).saveJson(arr);\n            toast(\"æ–°å¢ï¼š\" + newI + \" è¦†ç›–æ›´æ–°ï¼š\" + (rules.length - newI));\n        }\n    } catch (e) {\n        log(e.toString());\n        toast(\"å¯¼å…¥å¤±è´¥\");\n    }\n}"},{"col_type":"movie_3","name":"è§„åˆ™åˆ—è¡¨","path":"rules","rule":"js:\n$.exports = [{\n        name: \"å°äº‘\",\n        page: true,\n        find(s, page) {\n            let basicUrl = \"https://www.yunso.net\";\n            let api = \"/api/validate/search?wd=\" + encodeURIComponent(s) + \"&mode=90001&stype=20100&uk=&page=\" + page + \"&limit=20&screen_filetype=undefined\";\n            let json = post(basicUrl + api, {\n                body: \"data=\" + api,\n                headers: {\n                    Referer: \"https://www.yunso.net/index/user/s?wd=\" + encodeURIComponent(s)\n                }\n            });\n            let html = JSON.parse(json).data;\n            let list = pdfa(html, \"body&&.layui-card:has(a)\");\n            let d = [];\n            for (let item of list) {\n                let title = pdfh(item, \"a&&Text\").replace(\"#æ–‡ä»¶å¤¹ \", \"\");\n                //let time = /\\d{4}(-\\d{2}){2} \\d{2}(\\:\\d{2}){2}/.exec(pdfh(item, \".layui-card-body&&Text\")) || [];\n                d.push({\n                    title: title,\n                    //desc: time[0],\n                    url: base64Decode(pdfh(item, \"a&&url\"))\n                });\n            }\n            return d;\n        }\n    }, {\n        name: \"æ··åˆç›˜\",\n        page: true,\n        find(s, page) {\n            let url = \"https://api.hunhepan.com/v1/search\";\n            let json = post(url, {\n                headers: {\n                    Referer: \"https://hunhepan.com/\"\n                },\n                body: JSON.stringify({\n                    \"q\": s,\n                    \"page\": page,\n                    \"size\": 15\n                })\n            });\n            json = JSON.parse(json);\n            let list = json.data.list;\n            let d = [];\n            for (let i = 0; i < list.length; i++) {\n                let it = list[i];\n                if (it.disk_type !== \"ALY\" || it.share_user === \"ä¸¶***ä¸¶\") continue;\n                d.push({\n                    title: it.disk_name,\n                    pic_url: pd(it, \"img&&src\", url),\n                    url: it.link,\n                    desc: it.update_time + \"\\n\" + it.link,\n                });\n            }\n            return d;\n        }\n    }, {\n        name: \"èµ„æºå¸®\",\n        page: true,\n        find(s, page) {\n            function search() {\n                let rtnList = [];\n                let resp = request(\"https://zyb.upyunso.com/v15/search?keyword=\" + en_aes(s) + \"&s_type=2&page=\" + page + \"&atk=&did=\" + generateRandomHexString(64), {\n                    headers: {\n                        \"user-agent\": \"Mozilla/5.0 (Linux; Android 10; Redmi Note 7 Build/QKQ1.190910.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/81.0.4044.138 Mobile Safari/537.36 uni-app Html5Plus/1.0 (Immersed/29.09091)\",\n                    },\n                });\n                let respData = de_aes(resp);\n                let jsonData = JSON.parse(respData) || {};\n                let result = jsonData.result || {};\n                let items = result.items || [];\n\n                for (let i = 0; i < items.length; i++) {\n                    let item = items[i];\n                    let content = item.content || [];\n                    if (content.length == 0 || !item.page_url) continue;\n                    let url = de_aes(item.page_url) || \"\";\n                    if (!url) continue;\n                    rtnList.push({\n                        title: (item.title.length > 30 ? item.title.slice(0, 27) + \"...\" : item.title) || \"\",\n                        desc: \"åˆ†äº«æ—¶é—´ï¼š\" + item.insert_time,\n                        url: url\n                    });\n                }\n\n                return rtnList;\n            }\n\n            function generateRandomHexString(length) {\n                let result = \"\";\n                const characters = \"0123456789abcdef\";\n                const charactersLength = characters.length;\n                for (let i = 0; i < length; i++) {\n                    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n                }\n                return result;\n            }\n            let aliUtil = $.require(\"aliUtil\");\n            let CryptoJS = aliUtil.getCryptoJS();\n\n            function en_aes(e) {\n                let i = \"qq1920520460qqzz\";\n                // en_aes\n                let key = CryptoJS.enc.Utf8.parse(i);\n                var t = CryptoJS.enc.Utf8.parse(e),\n                    r = CryptoJS.AES.encrypt(t, key, {\n                        iv: key,\n                        mode: CryptoJS.mode.CBC,\n                    });\n                return r.ciphertext.toString();\n            }\n\n            function de_aes(vv) {\n                let i = \"qq1920520460qqzz\";\n                // de_aes\n                let key = CryptoJS.enc.Utf8.parse(i);\n                let hexVal = CryptoJS.enc.Hex.parse(vv),\n                    val = CryptoJS.enc.Base64.stringify(hexVal),\n                    decrypted = CryptoJS.AES.decrypt(val, key, {\n                        iv: key,\n                        mode: CryptoJS.mode.CBC,\n                    });\n                return decrypted.toString(CryptoJS.enc.Utf8);\n            }\n            return search();\n        }\n    }, {\n        name: \"äº‘ç›˜èµ„æº\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://res.yunpan.win/?PageIndex=\" + page + \"&PageSize=12&Keyword=\" + s + \"&Type=&Tag=\";\n            let html = request(url, {\n                headers: {\n                    \"Referer\": \"https://res.yunpan.win/\"\n                }\n            });\n\n            let arr = pdfa(html, \"main&&.card\");\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = pdfh(it, \".card-link,1&&onclick\").match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n                u = u.length > 0 ? u[0] : url;\n                d.push({\n                    title: pdfh(it, \".card-title&&Text\"),\n                    pic_url: pd(it, \"img&&src\", url),\n                    url: u,\n                    desc: pdfh(it, \".card-text,-1&&Text\") + \"\\n\" + u,\n                });\n            }\n            return d;\n        }\n    },\n    {\n        name: \"UPäº‘æœ\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://api.upyunso2.com/search?keyword=\" + s + \"&page=\" + page + \"&s_type=1\";\n            let html = request(url, {\n                headers: {\n                    \"Referer\": \"https://www.upyunso.com\",\n                    \"Cookie\": \"code=1919\"\n                }\n            });\n            //log(base64Decode(html));\n            let arr = JSON.parse(base64Decode(html)).result.items;\n            //log(arr);\n            let d = [];\n            if (!arr) return [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = it.page_url;\n                //u = u.length > 0 ? u[0] : url;\n                if (!u.includes(\"aliyundrive\")) {\n                    continue;\n                }\n                d.push({\n                    title: it.title,\n                    url: u,\n                    desc: \"\\n\" + (u),\n                });\n\n            }\n            return d;\n        }\n    },\n    {\n        name: \"çŒ«ç‹¸ç›˜æœ\",\n        page: false,\n        find: function(s, page) {\n            let html = request(\"https://www.alipansou.com/search?k=\" + s, {\n                headers: {\n                    \"Referer\": \"https://www.alipansou.com/search?k=\" + s\n                }\n            });\n            let arr = pdfa(html, \"#app&&a\");\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = \"<div>\" + arr[i] + \"</div>\";\n                let u = pdfh(it, \"a&&href\");\n                //log(u);\n                if (!u.includes(\"/s/\")) {\n                    continue;\n                }\n                u = \"https://www.alipansou.com\" + u.replace(\"/s/\", \"/cv/\");\n                d.push({\n                    title: pdfh(it, \"template&&Text\"),\n                    url: u,\n                    desc: pdfh(it, \"template,1&&Text\"),\n                });\n            }\n            return d;\n        },\n        findAliUrl(input) {\n            let html = request(input, {\n                headers: {\n                    \"Cookie\": \"no_show_donate=1\",\n                    \"Referer\": input.replace(\"/cv/\", \"/s/\")\n                },\n                redirect: false\n            });\n            html = parseDomForHtml(html, 'a&&href');\n            if (html.length > 0) {\n                return html;\n            } else {\n                return input;\n            }\n        }\n    },\n    {\n        name: \"æ˜“æœ\",\n        page: true,\n        registerUrl: \"https://yiso.fun\",\n        find: function(s, page) {\n            let aliUtil = $.require(\"aliUtil\");\n            let CryptoJS = aliUtil.getCryptoJS();\n\n            function keyen(str) {\n                var key = CryptoJS.enc.Utf8.parse(\"4OToScUFOaeVTrHE\"),\n                    iv = CryptoJS.enc.Utf8.parse(\"9CLGao1vHKqm17Oz\");\n                var encrypted = CryptoJS.AES.decrypt({\n                    ciphertext: CryptoJS.enc.Base64.parse(str)\n                }, key, {\n                    iv: iv,\n                    mode: CryptoJS.mode.CBC,\n                    padding: CryptoJS.pad.Pkcs7\n                }).toString(CryptoJS.enc.Utf8);\n                return encrypted;\n            }\n            let html = request(\"https://yiso.fun/api/search?name=\" + s + \"&pageNo=\" + page, {\n                headers: {\n                    \"Referer\": \"https://yiso.fun/info?searchKey=\" + s,\n                    \"Cookie\": getItem('yisoucooke', '')\n                }\n            });\n            //log(html);\n            if (html.includes('ç™»å½•ç”¨æˆ·æ— é™åˆ¶')) {\n                var i = 0;\n                do {\n                    var tyimglin = 'https://yiso.fun/api/user/login/captcha?t=' + parseInt(new Date().getTime()) + '';\n                    let img = convertBase64Image(tyimglin).split(',')[1];\n                    let cod = request('https://api.xhofe.top/ocr/b64/text', {\n                        headers: {\n                            'Content-Type': 'text/plain'\n                        },\n                        body: img,\n                        method: 'POST'\n                    });\n                    var ver = JSON.parse(request('https://yiso.fun/api/user/login', {\n                        headers: {\n                            'content-type': 'application/json',\n                            'referer': 'https://yiso.fun/login',\n                            'Cookie': getCookie(tyimglin)\n                        },\n                        body: {\n                            \"userName\": user.account,\n                            \"password\": user.password,\n                            \"code\": cod\n                        },\n                        method: 'POST'\n                    }));\n                    if (ver.code == 200) {\n                        log('æ˜“æœç™»å…¥éªŒè¯æˆåŠŸ');\n                        setItem('yisoucooke', getCookie('https://yiso.fun'));\n                        html = request(\"https://yiso.fun/api/search?name=\" + s + \"&pageNo=\" + page, {\n                            headers: {\n                                \"Referer\": \"https://yiso.fun/info?searchKey=\" + s,\n                                \"Cookie\": getItem('yisoucooke', '')\n                            }\n                        });\n                        break;\n                    }\n                    i++;\n                } while (i < 4);\n\n            }\n            let arr = JSON.parse(html).data.list;\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = keyen(it.url);\n                //log(u);\n                if (u == null || !u.includes(\"aliyun\")) {\n                    continue;\n                }\n                d.push({\n                    title: it.name,\n                    url: u,\n                    desc: (it.gmtShare || it.gmtCreate) + \"\\n\" + (u),\n                });\n\n            }\n            return d;\n        }\n    },\n    {\n        name: \"å°çº¸æ¡\",\n        page: false,\n        find: function(s, page) {\n            let aliUtil = $.require(\"aliUtil\");\n\n            function gettoken() {\n                if (getMyVar('xzytoken', '').length == 0) {\n                    let token = JSON.parse(post('https://gitcafe.net/tool/alipaper/', {\n                        headers: {\n                            'Referer': 'https://u.gitcafe.ink/'\n                        },\n                        body: {\n                            action: 'get_token'\n                        }\n                    })).data;\n                    putMyVar('xzttoken', token);\n                }\n                return getMyVar('xzttoken', '');\n            }\n\n            function cat_code(a) {\n                var d, e, b = [\"åè¯­ç”µè§†\", \"æ—¥éŸ©ç”µè§†\", \"æ¬§ç¾ç”µè§†\", \"å…¶ä»–ç”µè§†\", \"åè¯­ç”µå½±\", \"æ—¥éŸ©ç”µå½±\", \"æ¬§ç¾ç”µå½±\", \"å…¶ä»–ç”µå½±\", \"åè¯­åŠ¨æ¼«\", \"æ—¥éŸ©åŠ¨æ¼«\", \"æ¬§ç¾åŠ¨æ¼«\", \"çºªå½•ç‰‡\", \"ç»¼è‰ºç‰‡\", \"æ•™è‚²åŸ¹è®­\", \"å…¶ä»–è§†é¢‘\", \"åè¯­éŸ³ä¹\", \"æ—¥éŸ©éŸ³ä¹\", \"æ¬§ç¾éŸ³ä¹\", \"å…¶ä»–éŸ³ä¹\", \"å¨±ä¹è½¯ä»¶\", \"ç³»ç»Ÿè½¯ä»¶\", \"ç½‘ç»œè½¯ä»¶\", \"åŠå…¬è½¯ä»¶\", \"å…¶ä»–è½¯ä»¶\", \"æ¼«ç”»\", \"å°è¯´\", \"å‡ºç‰ˆä¹¦\", \"çŸ¥è¯†åŸ¹è®­\", \"å…¶ä»–æ–‡æ¡£\", \"å£çº¸\", \"äººç‰©\", \"é£æ™¯\", \"å…¶ä»–å›¾ç‰‡\", \"å…¶ä»–\"],\n                    c = [\"hyds\", \"rhds\", \"omds\", \"qtds\", \"hydy\", \"rhdy\", \"omdy\", \"qtdy\", \"hydm\", \"rhdm\", \"omdm\", \"jlp\", \"zyp\", \"jypx\", \"qtsp\", \"hyyy\", \"rhyy\", \"omyy\", \"qtyy\", \"kfrj\", \"xtrj\", \"wlrj\", \"bgrj\", \"qtrj\", \"mh\", \"xs\", \"cbs\", \"zspx\", \"qtwd\", \"bz\", \"rw\", \"fj\", \"qttp\", \"qt\"];\n                for (d = 0, e = c.length; e > d; d++)\n                    if (c[d] == a) return b[d];\n            }\n            let d = [];\n            let html = post(\"https://gitcafe.net/tool/alipaper/\", {\n                headers: {\n                    'Referer': 'https://u.gitcafe.ink/'\n                },\n                body: {\n                    action: \"search\",\n                    from: \"web\",\n                    token: gettoken(),\n                    keyword: s\n                }\n            })\n            let list = JSON.parse(html);\n            if (list.data) {\n                list = list.data;\n            }\n            for (let i = 0; i < list.length; i++) {\n                let it = list[i]\n                let title = it.title;\n                let murl = 'https://www.aliyundrive.com/s/' + it.alikey\n                if (!aliUtil.checkali(murl)) {\n                    continue;\n                }\n                if (title.includes(s)) {\n                    d.push({\n                        title: \"âˆš \" + title,\n                        desc: cat_code(it.cat),\n                        extra: {\n                            des: it.des\n                        },\n                        url: murl\n                    });\n                }\n            }\n            return d;\n        }\n    },\n    {\n        name: \"ç©å¶å“¥å“¥\",\n        page: true,\n        basicUrl: \"http://wogg.xyz\",\n        find: function(s, page) {\n            let url = basicUrl + \"/index.php/vodsearch/\" + s + \"----------\" + page + \"---.html\";\n            let html = request(url);\n            let arr = parseDomForArray(html, \".module-items&&.module-search-item\");\n\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let utitle = pdfh(it, \"h3&&a&&Text\");\n                let userial = pdfh(it, \".video-serial&&Text\");\n                let uimage = pdfh(it, \"img&&data-src\");\n                let u = pd(it, \"h3&&a&&href\", basicUrl);\n                bet.push({\n                    title: utitle,\n                    url: u,\n                    pic_url: uimage,\n                    desc: userial\n                });\n            }\n\n            return bet;\n        },\n        findAliUrl(input) {\n            return pdfa(request(input), \"body&&.module-row-text.copy\").map(v => pdfh(v, \"a&&data-clipboard-text\"));\n        }\n    },\n    {\n        name: \"é˜¿é‡Œäº‘ç›˜ç½‘\",\n        page: true,\n        basicUrl: \"https://www.alypw.cn\",\n        find: function(s, page) {\n            let url = basicUrl + \"/search.php?q=\" + s + \"&page=\" + page;\n            let html = request(url, {});\n            let arr = pdfa(html, \".list&&li\");\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let utitle = pdfh(it, \"a&&title\");\n                let userial = pdfh(it, \".fa-clock-o&&Text\");\n                let uimage = pdfh(it, \"img&&src\");\n                let u = pd(it, \"a&&href\", basicUrl);\n                if (!utitle.includes(s)) {\n                    continue;\n                }\n                bet.push({\n                    title: utitle,\n                    url: u,\n                    pic_url: uimage,\n                    desc: userial\n                });\n            }\n\n            return bet;\n        },\n        findAliUrl(input) {\n            return pdfa(request(input), \"body&&a[href^=https://www.aliyundrive.com/s/]\").map(v => pdfh(v, \"a&&href\"));\n        }\n    },\n    {\n        name: \"åœŸæ‹¨é¼ \",\n        page: false,\n        find: function(s, page) {\n            let html = fetch('https://www.tbsdy.com/search.html?keyword=' + s + '&category=983920&data_type=987910', {\n                headers: {\n                    'User-Agent': PC_UA\n                }\n            });\n\n            let arr = parseDomForArray(html, '.search_result_netdisk_list&&a');\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                //log(it);\n                let u = parseDomForHtml(it, 'a&&href');\n                let tit = parseDomForHtml(it, '.netdisk_item_detail_name&&Text');\n                if (!tit.includes(s)) {\n                    continue;\n                }\n                //log(u);\n                d.push({\n                    title: tit,\n                    url: u,\n                    desc: \"\\n\" + u,\n                });\n            }\n            return d;\n        }\n    },\n    {\n        name: \"é˜¿é‡Œæœ\",\n        page: true,\n        find: function(s, page) {\n            let d = [];\n            let html = request('https://aliso.cc/s/' + s + '-' + page + '-0.html', {});\n\n            let list = parseDomForArray(html, '.search-result&&.resource-item');\n            for (let j = 0; j < list.length; j++) {\n                let u = list[j];\n                let tit = parseDomForHtml(u, 'h3&&Text');\n                if (!tit.includes(s)) {\n                    continue;\n                }\n                d.push({\n                    title: tit,\n                    url: parseDom(u, 'h3&&a&&href', 'https://aliso.cc/'),\n                    desc: parseDomForHtml(u, '.time&&Text'),\n                });\n\n            }\n            return d;\n        },\n        findAliUrl(input) {\n            eval(getCryptoJS());\n\n            function decry(str) {\n                var key = CryptoJS.enc.Utf8.parse(\"9EB20DDFD6AFBD68\");\n                var encrypted = CryptoJS.AES.decrypt(str, key, {\n                    iv: key,\n                    mode: CryptoJS.mode.CBC,\n                    padding: CryptoJS.pad.Pkcs7\n                }).toString(CryptoJS.enc.Utf8);\n                return encrypted;\n            }\n\n            let html = request(input);\n            let but = parseDom(html, '.button&&href', 'https://aliso.cc/');\n            //log(but);\n            let got = request(but);\n            //log(got);\n            eval(parseDomForHtml(got, 'head&&script,1&&Html'));\n            return decry(base64.split('!')[0]);\n        }\n    },\n    {\n        name: \"äº‘ç›˜åˆ†äº«ç¤¾\",\n        page: false,\n        find: function(s, page) {\n            let aliUtil = $.require(\"aliUtil\");\n            let CryptoJS = aliUtil.getCryptoJS();\n\n            function decry(str) {\n                var key = CryptoJS.enc.Utf8.parse(\"5F6B2AK33DASD123\");\n                var encrypted = CryptoJS.AES.decrypt(str, key, {\n                    mode: CryptoJS.mode.ECB,\n                    padding: CryptoJS.pad.Pkcs7\n                }).toString(CryptoJS.enc.Utf8);\n                return encrypted;\n            }\n            let html = request(\"https://www.yunpanfenxiang.cn/api/bbs/api/getdata?key=\" + s + \"&type=video\", {\n                headers: {\n                    \"Referer\": \"https://www.yunpanfenxiang.cn/\"\n                }\n            });\n            let json = decry(JSON.parse(html).data);\n            let arr = JSON.parse(json);\n\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let url = it.pid;\n                bet.push({\n                    url: \"https://www.yunpanfenxiang.cn/api/bbs/api/getarticle?id=\" + url,\n                    title: it.title,\n                    desc: it.createtime\n                });\n            }\n\n            return bet;\n        },\n        findAliUrl(input) {\n            let json = JSON.parse(request(input, {\n                headers: {\n                    \"Referer\": \"https://www.yunpanfenxiang.cn/\"\n                }\n            })).data;\n            let list = json.download.split(\"@\");\n            let alist = new Set();\n            for (let j = 0; j < list.length; j++) {\n                alist.add(\"https://www.aliyundrive.com/s/\" + list[j]);\n            }\n            return Array.from(alist);\n        }\n    },\n    {\n        name: \"ç›˜æœ\",\n        page: true,\n        find: function(s, page) {\n            page = (page - 1) * 10;\n            let url = \"https://www.pansearch.me/search?keyword=\" + s + \"&offset=\" + page + \"&pan=aliyundrive\";\n            let html = request(url, {});\n\n            let arr = parseDomForArray(html, '.grid&&.shadow:has(a[href^=https://www.aliyundrive.com/s/])');\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = parseDomForHtml(it, 'a[href^=https://www.aliyundrive.com/s/]&&href');\n                let pic_url = parseDomForHtml(it, 'img&&src');\n                d.push({\n                    title: parseDomForHtml(it, '.break-all&&Text').split('http')[0],\n                    pic_url: pic_url === \"/favicon.png\" ? \"https://www.pansearch.me/\" + pic_url : pic_url,\n                    url: u,\n                    desc: parseDomForHtml(it, 'p&&Text') + \"\\n\" + u,\n                });\n\n            }\n            return d;\n        }\n    },\n    {\n        name: \"DOVXæœ\",\n        page: false,\n        find: function(s, page) {\n            let url = \"https://api.dovx.tk/ali/search?wd=\" + s;\n            let html = request(url);\n            let arr = JSON.parse(html).list;\n            let d = [];\n            let aliUtil = $.require(\"aliUtil\");\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = it.vod_content;\n                if (!u.includes(\"aliyundrive\") || !aliUtil.checkali(u)) {\n                    continue;\n                }\n                d.push({\n                    title: \"âˆš \" + it.vod_name,\n                    pic_url: it.vod_pic,\n                    url: u,\n                    desc: \"\\n\" + u,\n                });\n            }\n            return d;\n        }\n    },\n    {\n        name: \"å¿…åº”\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://cn.bing.com/search?q=\" + s + \"+aliyundrive&qs=ds&form=QBRE\";\n            if (page != 1) {\n                url = getMyVar(\"bing\", url);\n            }\n            let html = request(url, {\n                headers: {\n                    \"Referer\": \"https://cn.bing.com/\",\n                    //\"X-Requested-With\": \"com.example.hikerview\",\n                    \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\"\n                }\n            });\n            let arr = pdfa(html, \"body&&a\");\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = pd(it, \"a&&href\", url);\n                let t = pdfh(it, \"a&&Text\");\n                if (it.includes(\"Next page\") || it.includes(\"ä¸‹ä¸€é¡µ\")) {\n                    let u2 = pd(it, \"a&&href\", url);\n                    //log(\"next page\");\n                    //log(u2);\n                    putMyVar(\"bing\", u2);\n                }\n                if (u == null || t == null || !it.includes(s)) {\n                    continue;\n                }\n                if (!it.includes(\"ç½‘ç›˜\") && !it.includes(\"äº‘ç›˜\") &&\n                    !it.includes(\"aliyundrive\") && !it.includes(\"yunpan\")) {\n                    continue;\n                }\n                if (u.startsWith(\"https://cn.bing.com/\")) {\n                    continue;\n                }\n                let dom = getHome(u).replace(\"http://\", \"\").replace(\"https://\", \"\");\n                let _links = t.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n                let c = null;\n                if (_links.length > 1 && _links[1].replace(_links[0], \"\").replace(/[a-zA-Z0-9]+/g, \"\") == \"\") {\n                    c = _links[1];\n                } else if (_links.length > 0) {\n                    c = _links[0];\n                }\n                d.push({\n                    title: t,\n                    desc: dom,\n                    url: c != null ? c : u,\n                    extra: {\n                        longClick: [{\n                            title: \"è¿›å…¥ç½‘ç«™\",\n                            js: JSON.stringify(\"hiker://page/ysfx?webUrl=\" + encodeURIComponent(u))\n                        }]\n                    }\n                });\n            }\n            return d;\n        },\n        findAliUrl(input) {\n            if (input.includes(\"aliyundrive\")) return input;\n            let html = request(input);\n            var _links = html.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n            if (_links.length > 1 && _links[1].replace(_links[0], \"\").replace(/[a-zA-Z0-9]+/g, \"\") == \"\") {\n                return _links[1];\n            } else if (_links.length > 0) {\n                return _links[0];\n            } else {\n                return \"hiker://page/ysfx?webUrl=\" + encodeURIComponent(input);\n            }\n\n        }\n    },\n    {\n        name: 'CCOF',\n        page: true,\n        find: function(s, page) {\n            let d = []\n            let aliUtil = $.require(\"aliUtil\");\n            let html = fetch('https://pan.ccof.cc/api/search', {\n                headers: {\n                    \"content-type\": 'application/json',\n                    'Referer': 'https://pan.ccof.cc/search?keyword=' + s\n                },\n                body: {\n                    \"pageSize\": 20,\n                    \"pageNum\": page,\n                    \"keyword\": s,\n                    \"fromMobile\": true\n                },\n                method: 'POST'\n            })\n            let list = JSON.parse(html)\n                .data.rows\n            for (let i = 0; i < list.length; i++) {\n                let it = list[i];\n                let title = it.fileName\n                let murl = it.url\n                let type = it.type.replace(/folder/, 'æ–‡ä»¶å¤¹').replace(/file/, 'æ–‡ä»¶')\n                if (title.includes(s)) {\n                    d.push({\n                        title: title,\n                        desc: 'æ–‡ä»¶ç±»å‹ï¼š' + type + 'ï¼Œæ–‡ä»¶å¤§å°ï¼š' + aliUtil.bytesToSize(it.size),\n                        url: murl\n                    })\n                }\n            }\n            return d\n        }\n    },\n    {\n        name: 'é˜¿é‡Œå°ç«™',\n        page: true,\n        find: function(s, page) {\n            let home = \"https://pan666.net\";\n            let d = [];\n            let html = request(buildUrl(home + \"/api/discussions\", {\n                \"include\": \"user,lastPostedUser,mostRelevantPost,mostRelevantPost.user,tags,tags.parent,firstPost\",\n                \"filter[q]\": s /* + \" tag:video,comic\"*/ ,\n                //\"filter[tag]\": \"video,comic\",\n                \"page[offset]\": 20 * (page - 1)\n            }), {\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"Referer\": \"https://pan666.net/?q=\" + s\n                }\n            });\n            let list = JSON.parse(html).data;\n            for (let i = 0; i < list.length; i++) {\n                let item = list[i].attributes;\n                let url = home + \"/d/\" + item.slug;\n                d.push({\n                    title: item.title,\n                    desc: 'å‘å¸ƒæ—¶é—´ï¼š' + $.dateFormat(new Date(item.createdAt), \"yyyy-MM-dd HH:mm:ss\"),\n                    url: url,\n                    extra: {\n                        longClick: [{\n                            title: \"è¿›å…¥å¸–å­\",\n                            js: JSON.stringify(\"hiker://page/ysfx?webUrl=\" + encodeURIComponent(url))\n                        }]\n                    }\n                });\n            }\n            return d;\n        },\n        findAliUrl(input) {\n            let html = pdfh(request(input), \"Text\");\n            let _links = html.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n            let sharePwd = html.match(/æå–ç [:ï¼š]\\s*?(\\w{4})/);\n            sharePwd = Array.isArray(sharePwd) && sharePwd.length > 0 ? sharePwd[1] : \"\";\n            if (_links.length > 1 && _links[1].replace(_links[0], \"\").replace(/[a-zA-Z0-9]+/g, \"\") == \"\") {\n                return {\n                    aliUrl: _links[1],\n                    sharePwd: sharePwd\n                };\n            } else if (_links.length > 0) {\n                return {\n                    aliUrl: _links[0],\n                    sharePwd: sharePwd\n                };\n            } else {\n                return \"hiker://page/ysfx?webUrl=\" + encodeURIComponent(input);\n            }\n        }\n    },\n    {\n        name: 'äº‘ç›˜åˆ†äº«ç¤¾åŒº',\n        page: true,\n        find: function(s, page) {\n            let home = \"https://yunpan1.cc\";\n            let d = [];\n            let html = request(buildUrl(home + \"/api/discussions\", {\n                \"include\": \"user,lastPostedUser,mostRelevantPost,mostRelevantPost.user,tags,tags.parent,firstPost\",\n                \"filter[q]\": s /* + \" tag:video,comic\"*/ ,\n                //\"filter[tag]\": \"video,comic\",\n                \"page[offset]\": 20 * (page - 1)\n            }), {\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"Referer\": \"https://pan666.net/?q=\" + s\n                }\n            });\n            let list = JSON.parse(html).data;\n            for (let i = 0; i < list.length; i++) {\n                let item = list[i].attributes;\n                let url = home + \"/d/\" + item.slug;\n                d.push({\n                    title: item.title,\n                    desc: 'å‘å¸ƒæ—¶é—´ï¼š' + $.dateFormat(new Date(item.createdAt), \"yyyy-MM-dd HH:mm:ss\"),\n                    url: url,\n                    extra: {\n                        longClick: [{\n                            title: \"è¿›å…¥å¸–å­\",\n                            js: JSON.stringify(\"hiker://page/ysfx?webUrl=\" + encodeURIComponent(url))\n                        }]\n                    }\n                });\n            }\n            return d;\n        },\n        findAliUrl(input) {\n            let html = pdfh(request(input), \"Text\");\n            let _links = html.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n            let sharePwd = html.match(/æå–ç [:ï¼š]\\s*?(\\w{4})/);\n            sharePwd = Array.isArray(sharePwd) && sharePwd.length > 0 ? sharePwd[1] : \"\";\n            if (_links.length > 1 && _links[1].replace(_links[0], \"\").replace(/[a-zA-Z0-9]+/g, \"\") == \"\") {\n                return {\n                    aliUrl: _links[1],\n                    sharePwd: sharePwd\n                };\n            } else if (_links.length > 0) {\n                return {\n                    aliUrl: _links[0],\n                    sharePwd: sharePwd\n                };\n            } else {\n                return \"hiker://page/ysfx?webUrl=\" + encodeURIComponent(input);\n            }\n        }\n    }, {\n        name: \"çˆ±çœ‹ç¾å‰§\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://www.2kmj.cn/search.php?q=\" + s + \"&page/\" + page + \"/\";\n            let html = request(url);\n            let arr = parseDomForArray(html, \".list-it&&li\");\n\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let utitle = parseDomForHtml(it, \"a&&title\");\n                let userial = parseDomForHtml(it, \".info&&span:not(:has(a))--i&&Text\");\n                let uimage = parseDom(it, \"img&&src\");\n                let u = parseDom(it, \"a&&href\");\n                bet.push({\n                    title: utitle,\n                    url: u,\n                    pic_url: uimage,\n                    desc: userial\n                });\n            }\n\n            return bet;\n\n        },\n        findAliUrl(input) {\n            return pdfa(request(input), \"body&&#download\").map(v => pdfh(v, \".down&&href\"));\n        }\n    },\n    {\n        name: \"å¥‡å¦™æœç´¢\",\n        page: true,\n        find(s, page) {\n            let url;\n            if (page === 1) {\n                url = buildUrl(\"https://www.magicalsearch.top/api/pshou/getData\", {\n                    word: s,\n                    type: \"é˜¿é‡Œç½‘ç›˜\"\n                });\n            } else {\n                url = buildUrl(\"https://www.magicalsearch.top/api/pshou/getNextPage\", {\n                    url: \"https://api.upyunso2.com/search?s_type=2@page=\" + page + \"@keyword=\" + encodeURIComponent(s),\n                    website: \"é˜¿é‡Œç½‘ç›˜\"\n                });\n            }\n            let result = request(url, {\n                headers: {\n                    Referer: buildUrl(\"https://www.magicalsearch.top/search\", {\n                        word: s,\n                        cpage: 0\n                    })\n                }\n            });\n            result = JSON.parse(JSON.parse(result));\n            let list = result.result.items;\n            let d = [];\n            for (let it of list) {\n                if (it.id == -1) {\n                    continue;\n                }\n                d.push({\n                    title: it.title,\n                    desc: \"æ—¥æœŸï¼š\" + it.insert_time + \"\\nè·¯å¾„ï¼š\" + it.path,\n                    url: it.page_url\n                });\n            }\n            return d;\n        }\n    }\n];"},{"col_type":"movie_3","name":"æ–‡ä»¶æ’åº","path":"FileSorting","rule":"let chnNumChar = {\n    é›¶: 0,\n    ä¸€: 1,\n    äºŒ: 2,\n    ä¸‰: 3,\n    å››: 4,\n    äº”: 5,\n    å…­: 6,\n    ä¸ƒ: 7,\n    å…«: 8,\n    ä¹: 9\n};\n\nlet chnNameValue = {\n    å: {\n        value: 10,\n        secUnit: false\n    },\n    ç™¾: {\n        value: 100,\n        secUnit: false\n    },\n    åƒ: {\n        value: 1000,\n        secUnit: false\n    },\n    ä¸‡: {\n        value: 10000,\n        secUnit: true\n    },\n    äº¿: {\n        value: 100000000,\n        secUnit: true\n    }\n}\n\nfunction ChineseToNumber(chnStr) {\n    let rtn = 0;\n    let section = 0;\n    let number = 0;\n    let secUnit = false;\n    let str = chnStr.split('');\n\n    for (let i = 0; i < str.length; i++) {\n        let num = chnNumChar[str[i]];\n        if (typeof num !== 'undefined') {\n            number = num;\n            if (i === str.length - 1) {\n                section += number;\n            }\n        } else {\n            let unit = chnNameValue[str[i]].value;\n            secUnit = chnNameValue[str[i]].secUnit;\n            if (secUnit) {\n                section = (section + number) * unit;\n                rtn += section;\n                section = 0;\n            } else {\n                section += (number * unit);\n            }\n            number = 0;\n        }\n    }\n    return rtn + section;\n}\n\nfunction nameCompare(a, b) {\n    if (a == null || b == null)\n        return a == null ? b == null ? 0 : -1 : 1;\n\n    a = a.replace(/([é›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹åç™¾åƒä¸‡äº¿])/g, function(match, p1, p2, p3, offset, string) {\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\n        return ChineseToNumber(p1);\n    })\n    b = b.replace(/([é›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹åç™¾åƒä¸‡äº¿])/g, function(match, p1, p2, p3, offset, string) {\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\n        return ChineseToNumber(p1);\n    })\n\n    let NUMBERS = java.util.regex.Pattern.compile(\"(?<=\\\\D)(?=\\\\d)|(?<=\\\\d)(?=\\\\D)\")\n    let split1 = NUMBERS.split(new java.lang.String(a));\n    let split2 = NUMBERS.split(new java.lang.String(b));\n\n    for (let i = 0; i < Math.min(split1.length, split2.length); i++) {\n        let c1 = split1[i].charCodeAt(0);\n        let c2 = split2[i].charCodeAt(0);\n        let cmp = 0;\n        let zeroCharCode = '0'.charCodeAt(0);\n        let nineCharCode = '9'.charCodeAt(0);\n\n        if (c1 >= zeroCharCode && c1 <= nineCharCode && c2 >= zeroCharCode && c2 <= nineCharCode) {\n            cmp = new java.math.BigInteger(split1[i]).compareTo(new java.math.BigInteger(split2[i]));\n        }\n\n        if (cmp === 0) {\n            let regex = /[a-zA-Z0-9]/\n            let s1 = String(split1[i])\n            let s2 = String(split2[i])\n            if (regex.test(s1) || regex.test(s2)) {\n                cmp = new java.lang.String(split1[i]).compareTo(new java.lang.String(split2[i]));\n                // cmp = s1.localeCompare(s2, 'en')\n            } else {\n                cmp = s1.localeCompare(s2, 'zh')\n            }\n        }\n\n        if (cmp !== 0) {\n            return cmp;\n        }\n    }\n    let lengthCmp = split1.length - split2.length;\n    // if (lengthCmp !== 0) lengthCmp = lengthCmp > 0 ? -1 : 1;\n    return lengthCmp;\n}\n$.exports.nameCompare = nameCompare;"},{"col_type":"movie_3","name":"ç™»å½•æ–¹å¼","path":"loginMode","rule":"$.exports = $([\"APPæˆæƒç™»å½•\", \"ç½‘é¡µç™»å½•â‘ \", \"ç½‘é¡µç™»å½•â‘¡\", \"TOKENç™»å½•\"], 1, \"ç™»å½•æ–¹å¼\").select(() => {\n    if (\"ç½‘é¡µç™»å½•â‘ \" == input) {\n        return \"hiker://page/login#noRecordHistory##noHistory#?pageTitle=ç™»å½•é˜¿é‡Œäº‘ç›˜\"\n    }\n    if (\"ç½‘é¡µç™»å½•â‘¡\" == input) {\n        return \"hiker://page/login#noRecordHistory##noHistory#?index=0&pageTitle=ç™»å½•é˜¿é‡Œäº‘ç›˜\"\n    }\n    if (\"APPæˆæƒç™»å½•\" == input) {\n        return \"hiker://page/login#noRefresh##noRecordHistory##noHistory#?index=-1&pageTitle=ç™»å½•é˜¿é‡Œäº‘ç›˜\"\n    }\n    if (\"TOKENç™»å½•\" == input) {\n        return $(\"\", \"è¾“å…¥TOKEN\").input(() => {\n            let aliTokensFilepath = $.require(\"hiker://page/tokenPath\").aliTokensFilepath;\n            let aliToken = {\n                refresh_token: input.trim()\n            };\n            writeFile(aliTokensFilepath, JSON.stringify(aliToken));\n            refreshPage();\n        });\n    }\n    if (\"åŸç”»ç™»å½•\" == input) {\n        return \"hiker://page/openApiLogin#noRefresh##noRecordHistory##noHistory#\";\n    }\n});"},{"col_type":"movie_3","name":"é˜¿é‡Œé“¾æ¥åŒ¹é…","path":"alitest","rule":"js:\nlet matchReg = /https?:\\/\\/www.ali(pan|yundrive).com\\/s\\/[a-zA-Z0-9]{11}(\\/folder\\/[a-z0-9]{40})?/;\nlet matchRegG = /https?:\\/\\/www.ali(pan|yundrive).com\\/s\\/[a-zA-Z0-9]{11}(\\/folder\\/[a-z0-9]{40})?/g;\nlet testReg = /www.ali(pan|yundrive).com\\/s\\//;\n$.exports = {\n    matchAliUrl(text, isG) {\n        if (isG) {\n            let url = text.match(matchRegG);\n            if (url) return url;\n            else return [];\n        } else {\n            let url = text.match(matchReg);\n            return url = url && url[0] || \"\";\n        }\n    },\n    test(text){\n        return testReg.test(text);\n    }\n}\n"},{"col_type":"movie_3","name":"openApiç™»å½•-åºŸå¼ƒ","path":"openApiLogin","rule":"js:\nsetPageTitle(\"openApiç™»å½•\");\naddListener(\"onClose\", () => clearMyVar(\"Loggingin\"));\n\nlet d = [];\nd.push({\n    title: \"ç‚¹å‡»è·å–æ‰«ç ç™»å½•äºŒç»´ç \",\n    desc: \"ç‚¹å‡»å›¾ç‰‡å¯ä»¥ä¿å­˜\",\n    col_type: \"text_center_1\",\n    extra: {\n        cls: \"login\",\n        id:\"getQC\"\n    },\n    url: $(\"#noLoading#\").lazyRule(() => {\n        putMyVar(\"Loggingin\", \"true\");\n        showLoading(\"æ­£åœ¨è·å–äºŒç»´ç \");\n\n        function get_qrcode_status(sid) {\n            let res = fetch(\"https://openapi.aliyundrive.com/oauth/qrcode/\" + sid + \"/status\");\n            return JSON.parse(res);\n        }\n\n        function get_refresh_token(code) {\n            let res = post(\"https://aliyundrive-oauth.messense.me/oauth/access_token\", {\n                body: JSON.stringify({\n                    \"grant_type\": \"authorization_code\",\n                    \"code\": code,\n                }),\n            });\n            let data = JSON.parse(res);\n            return data[\"refresh_token\"];\n        }\n        let res = post(\"https://aliyundrive-oauth.messense.me/oauth/authorize/qrcode\", {\n            body: JSON.stringify({\n                \"scopes\": [\"user:base\", \"file:all:read\", \"file:all:write\"],\n                \"width\": 300,\n                \"height\": 300,\n            }),\n        });\n        let data = JSON.parse(res);\n        let sid = data[\"sid\"];\n        let qrcode_url = data[\"qrCodeUrl\"];\n        updateItem(\"infoOutput\", {\n            pic_url: qrcode_url,\n            url: qrcode_url + \"#.jpg\",\n            col_type: \"pic_1_full\"\n        });\n        addItemAfter(\"infoOutput\", {\n            title: \"â€˜â€˜â€™â€™\" + \"ä½¿ç”¨é˜¿é‡Œäº‘ç›˜ App æ‰«ç \".fontcolor(\"grey\"),\n            col_type: \"text_center_1\",\n            extra: {\n                cls: \"login\"\n            }\n        });\n        deleteItem(\"getQC\");\n        hideLoading();\n        let refresh_token;\n        while (true) {\n            let data;\n            try {\n                data = get_qrcode_status(sid);\n            } catch (e) {\n                return \"toast://æŸ¥è¯¢æ‰«ç ç»“æœè¶…æ—¶, å¯èƒ½æ˜¯è§¦å‘äº†é˜¿é‡Œäº‘ç›˜æ¥å£é™åˆ¶, è¯·ç¨åå†è¯•.\";\n            }\n            let status = data[\"status\"];\n            if (status == \"LoginSuccess\") {\n                refresh_token = get_refresh_token(data[\"authCode\"]);\n                break\n            } else if (status == \"QRCodeExpired\") {\n                return \"toast://äºŒç»´ç å·²è¿‡æœŸ, è¯·åˆ·æ–°é¡µé¢åé‡è¯•\";\n            }\n            if (!getMyVar(\"Loggingin\", \"\")) {\n                return \"toast://cancel\";\n            }\n            java.lang.Thread.sleep(1500);\n        }\n        if (refresh_token) {\n            const {\n                openTokensFilepath,\n            } = $.require(\"tokenPath\");\n            let open = {\n                RefreshTokenOpen: refresh_token,\n                isV2: true\n            };\n            writeFile(openTokensFilepath, JSON.stringify(open));\n            addItemAfter(\"infoOutput\", {\n                title: \"ç™»å½•æˆåŠŸ(ç‚¹å‡»è¿”å›)\",\n                url:$(\"#noLoading#\").lazyRule(()=>{\n                    back(false);\n                    return \"hiker://empty\";\n                }),\n                col_type: \"text_center_1\",\n            });\n            deleteItemByCls(\"login\");\n\n            return \"toast://success\";\n        }\n        return \"toast://fail\";\n    })\n});\n\nd.push({\n    col_type: \"blank_block\",\n    extra: {\n        id: \"infoOutput\",\n        cls: \"login\"\n    }\n});\n\nsetResult(d);"},{"col_type":"movie_3","name":"openApi:alist","path":"openApi_alist","rule":"function OpenApiAlist($this) {\n    this.$this = $this;\n}\nObject.assign(OpenApiAlist.prototype, {\n    getOpenTokenCode() {\n        let result = this.$this.postApi('https://open.aliyundrive.com/oauth/users/authorize?client_id=' + '76917ccccd4441c39457a04f6084fb2f' + '&redirect_uri=https://alist.nn.ci/tool/aliyundrive/callback' + '&scope=user:base,file:all:read,file:all:write&state=').body({\n            \"authorize\": 1,\n            \"scope\": \"user:base,file:all:read,file:all:write\"\n        }).headers({\n            'User-Agent': PC_UA,\n            'Referer': 'https://www.aliyundrive.com/',\n            'authorization': this.$this.reaccessTk, //getAccessToken\n            'x-canary': 'client=web,app=share,version=v2.3.1',\n            'x-share-token': this.$this.shareToken\n        }).errorWithRetry((e, _, http) => {\n            this.$this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'authorization': this.$this.reaccessTk,\n                    'x-share-token': this.$this.shareToken\n                }\n            });\n            return true;\n        }).start(true);\n        let code = result.redirectUri.split(\"code=\")[1];\n        return code;\n    },\n    getToken(body) {\n        let json = post('https://api.xhofe.top/alist/ali_open/code', {\n            headers: {\n                'User-Agent': PC_UA,\n                'Referer': 'https://www.aliyundrive.com/'\n            },\n            body: JSON.stringify(body),\n        });\n        if (!json) {\n            json = post('https://api-cf.nn.ci/alist/ali_open/code', {\n                headers: {\n                    'User-Agent': PC_UA,\n                    'Referer': 'https://www.aliyundrive.com/'\n                },\n                body: JSON.stringify(body),\n            });\n        }\n        if (json.includes('Too Many Requests') || json.includes(\"502 Bad Gateway\")) {\n            throw new Error(\"é¢‘ç¹è¯·æ±‚æš‚æ—¶è¢«å°ç¦\\n\" + json);\n        } else {\n            let openResult = JSON.parse(json);\n            return openResult;\n        }\n    },\n    getOpenToken() {\n        return this.getToken({\n            code: this.getOpenTokenCode(),\n            grant_type: \"authorization_code\"\n        });\n    },\n    refreshOpenToken() {\n        return this.getToken({\n            grant_type: \"refresh_token\",\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\n        });\n    }\n});\n$.exports = OpenApiAlist;"},{"col_type":"movie_3","name":"openApi:aliyundrive","path":"openApi_aliyundrive","rule":"js:\nfunction OpenApi($this, postApi) {\n    this.$this = $this;\n}\n\nObject.assign(OpenApi.prototype, {\n    getOpenTokenCode() {\n        function get_qrcode_code(sid) {\n            let res = fetch(\"https://openapi.aliyundrive.com/oauth/qrcode/\" + sid + \"/status\");\n            return JSON.parse(res).authCode;\n        }\n\n        let res = post(\"https://aliyundrive-oauth.messense.me/oauth/authorize/qrcode\", {\n            body: JSON.stringify({\n                \"scopes\": [\"user:base\", \"file:all:read\", \"file:all:write\"],\n                \"width\": 300,\n                \"height\": 300,\n            }),\n        });\n        let data = JSON.parse(res);\n        let sid = data[\"sid\"];\n        let body = {\n            \"authorize\": 1,\n            \"scope\": \"user:base,file:all:read,file:all:write\",\n            \"drives\": [\"backup\", \"resource\"],\n            \"scopes\": [\"user:base\", \"file:all:read\", \"file:all:write\"],\n            \"sid\": sid\n        }\n        let headers = {\n            'authorization': this.$this.reaccessTk\n        };\n        let res2 = this.$this.postApi(\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\n            this.$this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'authorization': this.$this.reaccessTk,\n                }\n            });\n            return true;\n        }).start(true);\n        return get_qrcode_code(sid);\n    },\n    getToken(body) {\n        let res = post(\"https://aliyundrive-oauth.messense.me/oauth/access_token\", {\n            body: JSON.stringify(body),\n        });\n        let data = JSON.parse(res);\n\n        return data;\n    },\n    getOpenToken() {\n        return this.getToken({\n            code: this.getOpenTokenCode(),\n            grant_type: \"authorization_code\"\n        });\n    },\n    refreshOpenToken() {\n        return this.getToken({\n            grant_type: \"refresh_token\",\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\n        });\n    }\n});\n$.exports = OpenApi;"},{"col_type":"movie_3","name":"openApi:tvbox","path":"openApi_tvbox","rule":"function OpenApi($this) {\n    this.$this = $this;\n}\n\nObject.assign(OpenApi.prototype, {\n    getOpenTokenCode() {\n        function get_qrcode_code(sid) {\n            let res = fetch(\"https://openapi.aliyundrive.com/oauth/qrcode/\" + sid + \"/status\");\n            return JSON.parse(res).authCode;\n        }\n\n        let res = fetch(\"http://159.75.208.47/cloudisk/api/oauth/authorize/qrcode\");\n        let data = JSON.parse(res);\n        let sid = data[\"sid\"];\n        let body = {\n            \"authorize\": 1,\n            \"scope\": \"user:base,file:all:read,file:all:write\",\n            \"drives\": [\"backup\", \"resource\"],\n            \"scopes\": [\"user:base\", \"file:all:read\", \"file:all:write\"],\n            \"sid\": sid\n        }\n        let headers = {\n            'authorization': this.$this.reaccessTk\n        };\n        let res2 = this.$this.postApi(\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\n            this.$this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'authorization': this.$this.reaccessTk,\n                }\n            });\n            return true;\n        }).start(true);\n        return get_qrcode_code(sid);\n    },\n    getToken(body) {\n        let url = \"\";\n        if (body.code) {\n            url = buildUrl(\"http://159.75.208.47/cloudisk/api/oauth/accessToken\", {\n                authCode: body.code\n            });\n        } else {\n            url = buildUrl(\"http://159.75.208.47/cloudisk/api/oauth/accessToken\", {\n                refreshToken: body.refresh_token\n            });\n        }\n        let res = fetch(url);\n        let data = JSON.parse(res);\n        let ret = {\n            refresh_token: data.refreshToken,\n            token_type: data.tokenType,\n            access_token: data.accessToken\n        };\n        return ret;\n    },\n    getOpenToken() {\n        return this.getToken({\n            code: this.getOpenTokenCode(),\n            grant_type: \"authorization_code\"\n        });\n    },\n    refreshOpenToken() {\n        return this.getToken({\n            grant_type: \"refresh_token\",\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\n        });\n    }\n});\n$.exports = OpenApi;"},{"col_type":"movie_3","name":"openApi:XBY","path":"openApi_XBY","rule":"js:\nfunction OpenApi($this, postApi) {\n    this.$this = $this;\n}\n\nObject.assign(OpenApi.prototype, {\n    client_secret: \"63f06c3c5c5d4e1196e2c13e8588ae29\",\n    client_id: \"df43e22f022d4c04b6e29964f3b8b46d\",\n    getOpenTokenCode() {\n        function get_qrcode_code(sid) {\n            let res = fetch(\"https://openapi.aliyundrive.com/oauth/qrcode/\" + sid + \"/status\");\n            return JSON.parse(res).authCode;\n        }\n\n        let res = post(\"https://openapi.aliyundrive.com/oauth/authorize/qrcode\", {\n            body: JSON.stringify({\n                \"scopes\": [\"user:base\", \"file:all:read\", \"file:all:write\"],\n                \"client_secret\": this.client_secret,\n                \"client_id\": this.client_id,\n                \"width\": 350,\n                \"height\": 350,\n            }),\n        });\n        let data = JSON.parse(res);\n        let sid = data[\"sid\"];\n        let body = {\n            \"authorize\": 1,\n            \"scope\": \"user:base,file:all:read,file:all:write\",\n            \"drives\": [\"backup\", \"resource\"],\n            \"scopes\": [\"user:base\", \"file:all:read\", \"file:all:write\"],\n            \"sid\": sid\n        }\n        let headers = {\n            'authorization': this.$this.reaccessTk\n        };\n        let res2 = this.$this.postApi(\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\n            this.$this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'authorization': this.$this.reaccessTk,\n                }\n            });\n            return true;\n        }).start(true);\n        return get_qrcode_code(sid);\n    },\n    getToken(body) {\n        let res = post(\"https://openapi.aliyundrive.com/oauth/access_token\", {\n            body: JSON.stringify(body),\n        });\n        let data = JSON.parse(res);\n\n        return data;\n    },\n    getOpenToken() {\n        return this.getToken({\n            code: this.getOpenTokenCode(),\n            grant_type: \"authorization_code\",\n            client_secret: this.client_secret,\n            client_id: this.client_id,\n        });\n    },\n    refreshOpenToken() {\n        return this.getToken({\n            grant_type: \"refresh_token\",\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\n            client_secret: this.client_secret,\n            client_id: this.client_id,\n        });\n    }\n});\n$.exports = OpenApi;"},{"col_type":"movie_3","name":"é“¾æ¥å®šå‘","path":"redirect","rule":"js:\nconst openMode = getItem(\"openMode\", \"æœ¬åœ°è§£æ\");\nif (openMode === \"æœ¬åœ°è½¬ç \") {\n    setItem(\"openMode\", \"æœ¬åœ°è§£æ\");\n    openMode = \"æœ¬åœ°è§£æ\";\n}\n\nfunction dealArray(array) {\n    let isString = typeof array[0] === \"string\";\n    if (array.length === 1) {\n        return dealResult(array[0]);\n    } else if (isString) {\n        array = array.map(aliUrl => ({\n            aliUrl\n        }));\n    }\n    let select = array.map((v, i) => v.title || v.aliUrl.replace(/http.*?\\/s\\//, \"\"));\n    return $(select).select((result) => {\n        let index = MY_INDEX;\n        return $.require(\"redirect\").dealResult(result[index]);\n    }, array);\n}\n\nfunction dealResult(result) {\n    let resultType = typeof result;\n    if (resultType === \"string\") {\n        return getModeUrl(result);\n    } else if (Array.isArray(result)) {\n        return dealArray(result);\n    } else if (result instanceof EasyNextPage) {\n        return result.toNextPage();\n    } else if (resultType === \"object\") {\n        return getModeUrl(result.aliUrl, result.sharePwd);\n    }\n    return \"toast://é”™è¯¯ç±»å‹ï¼š\" + resultType;\n}\n\nfunction EasyNextPage(list, col) {\n    //this.list = list;\n    col = col || \"text_3\";\n    this.toNextPage = function() {\n        return $().rule((list, col_type) => {\n            setResult(list.map(v => ({\n                col_type,\n                url: $().lazyRule(v => $.require(\"redirect\").dealResult(v), v),\n                title: v.title || v.aliUrl.replace(/http.*?\\/s\\//, \"\")\n            })));\n        }, list, col);\n    }\n}\n\nfunction setErrorPop(name, author) {\n    return $(\"æœç´¢å¼•æ“ã€Œ\" + name + \"ã€å¤±æ•ˆè¯·è”ç³»æœç´¢å¼•æ“ä½œè€…\" + (author ? \"[\" + author + \"]\" : \"\") + \"ä¿®å¤æˆ–åˆ é™¤\\n\\nå¼•æ“ä½œè€…å¯ä»¥å»å®˜æ–¹é¢‘é“è¯¢é—®\\nç‚¹å‡»ç¡®å®šå¿«é€Ÿåˆ é™¤\").confirm((name) => {\n        confirm({\n            title: \"æ¸©é¦¨æç¤º\",\n            content: \"ç¡®å®šè¦åˆ é™¤\" + name + \"å—ï¼Ÿæ³¨æ„åˆ é™¤åæ— æ³•æ¢å¤\",\n            confirm: $.toString((name) => {\n                let arr = $.require(\"configs\").getJson();\n                let index = arr.findIndex(v => v.name === name);\n                arr.splice(index, 1);\n                $.require(\"configs\").saveJson(arr);\n                clearItem(\"rule\");\n                refreshPage(true);\n                return \"toast://åˆ é™¤æˆåŠŸ\";\n            }, name)\n        });\n    }, name);\n}\n\nfunction doubleTreating({\n    findAliUrl,\n    basicUrl,\n    name,\n    author,\n    aliUrl,\n    ruleType\n}) {\n    if (!findAliUrl) return getModeUrl(aliUrl);\n    if (ruleType === \"JSON\") {\n        let ParseRlue = $.require(\"ParseRlue\");\n        let find = findAliUrl;\n        findAliUrl = (url, basicUrl) => {\n            return ParseRlue.parseUrlJson(url, find, basicUrl);\n        }\n    }else if (ruleType === \"HTML\") {\n        let ParseRlue = $.require(\"ParseRlue\");\n        let find = findAliUrl;\n        findAliUrl = (url, basicUrl) => {\n            return ParseRlue.parseUrlHtml(url, find, basicUrl);\n        }\n    } else {\n        findAliUrl = new Function(\"input\", \"basicUrl\", \"EasyNextPage\", findAliUrl);\n    }\n    try {\n        let result = findAliUrl(aliUrl, basicUrl, EasyNextPage);\n        return dealResult(result);\n    } catch (e) {\n        log(e.toString());\n        return setErrorPop(name, author);\n    }\n}\n\nfunction getModeUrl(aliUrl, sharePwd) {\n    if ($.require(\"alitest\").test(aliUrl)) {\n        if (openMode === \"æœ¬åœ°è§£æ\") {\n            return \"hiker://page/aliyun?page=fypage&realurl=\" + encodeURIComponent(aliUrl) + \"&sharePwd=\" + (sharePwd || \"\");\n        } else {\n            shareId = aliUrl.split(\"/\")[4];\n            return \"smartdrive://share/browse?shareId=\" + shareId + \"&sharePwd=\" + (sharePwd || \"\");\n        }\n    } else if (aliUrl.includes(\"pan.quark.cn/s/\")||aliUrl.includes(\"drive.uc.cn/s/\")) {\n        if (openMode === \"æœ¬åœ°è§£æ\") {\n            let has = fetch(\"hiker://home@Quark.ç®€\") != \"null\";\n            if (has) {\n                return \"hiker://page/quarkList?rule=Quark.ç®€&realurl=\" + encodeURIComponent(aliUrl) + \"&sharePwd=\" + (sharePwd || \"\");\n            } else {\n                return aliUrl;\n            }\n        } else {\n            return \"qklink://www.uc.cn/b20b84fd735a8dd3f7541129bacc4e9a?action=open_url&url=\" + aliUrl;\n        }\n    } else if (aliUrl.startsWith(\"http\")) {\n        return aliUrl;\n    } else if (aliUrl.startsWith(\"magnet\")) {\n        if (openMode === \"æœ¬åœ°è§£æ\") {\n            return aliUrl;\n        } else {\n            return \"download://\" + aliUrl;\n        }\n    } else {\n        return aliUrl;\n    }\n}\n$.exports.getModeUrl = getModeUrl;\n$.exports.doubleTreating = doubleTreating;\n$.exports.dealResult = dealResult;"},{"col_type":"movie_3","name":"è§„åˆ™è§£æ","path":"ParseRlue","rule":"function toPath(value) {\n    if (typeof value !== 'string') {\n        return [];\n    }\n    let path = [];\n    let current = '';\n    let inBrackets = false;\n    let escape = false;\n    for (let i = 0; i < value.length; i++) {\n        let char = value[i];\n        if (escape) {\n            current += char;\n            escape = false;\n        } else if (char === '\\\\') {\n            escape = true;\n        } else if (char === '.' && !inBrackets) {\n            path.push(current);\n            current = '';\n        } else if (char === '[') {\n            inBrackets = true;\n        } else if (char === ']') {\n            inBrackets = false;\n        } else {\n            current += char;\n        }\n    }\n    if (current) {\n        path.push(current);\n    }\n    return path;\n}\n\nfunction getJson(obj, path) {\n    if (!obj || !Array.isArray(path)) {\n        return undefined;\n    }\n    if (path.length === 0) {\n        return obj;\n    }\n    let current = obj;\n    for (let i = 0; i < path.length; i++) {\n        let key = path[i];\n\n        if (current === null || current === undefined || typeof current !== 'object') {\n            return undefined;\n        }\n        current = current[key];\n    }\n    return current;\n}\n\nfunction dealRule(json, rule, basicUrl) {\n    if (!rule) return;\n    rule = rule.split(\"@js=\");\n    let rule0 = rule.at(0);\n    let t = \"\";\n    if (rule0) {\n        t = getJson(json, toPath(rule0));\n    } else {\n        t = json;\n    }\n    if (rule.length > 1) {\n        return new Function(\"input\", \"$$\", \"basicUrl\", '\"use strict\";return ' + rule.at(1))(t, json, basicUrl);\n    }\n    return t;\n}\n\nfunction parseSearchJson(url, rule) {\n    let json = JSON.parse(fetch(url));\n    let rules = rule.split(\"\\n\");\n    let list = getJson(json, toPath(rules.at(0)));\n    if (!list || !Array.isArray(list)) {\n        throw new Error(\"JSON:åˆ—è¡¨è§£æä¸ºç©º\");\n    }\n    let data = [];\n    for (let it of list) {\n        data.push({\n            title: dealRule(it, rules.at(1), url),\n            url: dealRule(it, rules.at(2), url),\n            desc: dealRule(it, rules.at(3), url),\n            pic_url: dealRule(it, rules.at(4), url),\n        });\n    }\n    return data;\n}\n\nfunction parseUrlJson(url, rule, basicUrl) {\n    if (rule.startsWith(\"@js=\")) {\n        return dealRule(url, rule, basicUrl);\n    } else {\n        let json = JSON.parse(fetch(url));\n        return dealRule(json, rule, basicUrl);\n    }\n\n}\n\nfunction dealRuleForHtml(html, rule, basicUrl) {\n    if (!rule) return;\n    rule = rule.split(\"@js=\");\n    let rule0 = rule.at(0);\n    let t = \"\";\n    if (rule0) {\n        t = pdfh(html, rule0);\n    } else {\n        t = html\n    }\n    if (rule.length > 1) {\n        return new Function(\"input\", \"$$\", \"basicUrl\", '\"use strict\";return ' + rule.at(1))(t, html, basicUrl);\n    }\n    return t;\n}\n\nfunction parseSearchHtml(url, rule) {\n    let html = fetch(url);\n    let rules = rule.split(\"\\n\");\n    let list = pdfa(html, rules.at(0));\n    if (!list || !Array.isArray(list)) {\n        throw new Error(\"HTML:åˆ—è¡¨è§£æä¸ºç©º\");\n    }\n    let data = [];\n    for (let it of list) {\n        let curl = dealRuleForHtml(it, rules.at(2), url);\n        data.push({\n            title: dealRuleForHtml(it, rules.at(1), url),\n            url: curl.startsWith(\"http\") ? curl : (getHome(url) + curl),\n            desc: dealRuleForHtml(it, rules.at(3), url),\n            pic_url: dealRuleForHtml(it, rules.at(4), url),\n        });\n    }\n    return data;\n}\n\nfunction parseUrlHtml(url, rule, basicUrl) {\n    if (rule.startsWith(\"@js=\")) {\n        return dealRuleForHtml(url, rule, basicUrl);\n    } else {\n        let html = fetch(url);\n        return dealRuleForHtml(html, rule, basicUrl);\n    }\n}\n$.exports = {\n    parseSearchJson,\n    parseUrlJson,\n    parseSearchHtml,\n    parseUrlHtml\n};"},{"col_type":"movie_3","name":"æˆ‘çš„é˜¿é‡Œ","path":"myaliyun","rule":"js:\n//@author LoyDgIk\nconst AliAccessApi = $.require(\"aliPlayApi\");\nlet openAPIList = [\"alist\", \"drive\", \"tvbox\", \"XBY\", \"TV\"];\nlet shareInfo = MY_PARAMS.shareInfo;\nif (MY_PARAMS.transfer) {\n    if (!shareInfo) {\n        shareInfo = MY_PARAMS;\n    }\n    MY_PARAMS = {\n        isHome: true,\n        shareInfo\n    };\n}\n\nlet fileId = MY_PARAMS.fileId || \"root\";\nlet searchKey = decodeURIComponent(getParam(\"searchKey\", \"\")) || undefined;\nlet isSearch = !!searchKey;\n\nlet pageId = String(Date.now()).slice(6);\n\nlet skipFile = Number(getItem(\"myskipFile\", \"0\"));\n\nfunction signInReward(aliAccessApi) {\n    let today = $.dateFormat(Date.now(), \"yyyyMMdd\");\n    let lastday = getItem(\"AliDay\", \"0\");\n    if (today != lastday && new Date().getHours() >= 0) {\n        setItem(\"AliDay\", today);\n        let result = \"\";\n        try {\n            if ((result = aliAccessApi.signInReward())) {\n                toast(result);\n            } else {\n                toast(result);\n            }\n        } catch (e) {\n            toast(\"ç­¾åˆ°å¤±è´¥:\" + e.toString());\n        }\n    }\n}\n\nfunction formatDate(_date, fmt) {\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\n    return $.dateFormat(date, fmt || \"yyyy-MM-dd HH:mm:ss\")\n}\n\nfunction formatSize(size) {\n    if (!size) {\n        return '';\n    }\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    let i = 0;\n    while (size >= 1024) {\n        size /= 1024;\n        i++;\n    }\n    size = i ? Number(size.toFixed(2)) : size;\n    return `${size} ${units[i]}`;\n}\n\nfunction setMyPaCache(key, value) {\n    MY_PARAMS[key] = value;\n}\n\nfunction saveMyPaCache() {\n    setPageParams(MY_PARAMS);\n}\n\nfunction setMarker(marker) {\n    setMyPaCache(\"marker\", marker);\n}\n\n\nif (MY_PARAMS.noPic) {\n    setPagePicUrl();\n    setMyPaCache(\"noPic\", false);\n}\n/*\nfunction setVideoItemCache(videoItemCache) {\n    setMyPaCache(\"videoItemCache\", videoItemCache);\n}\n\nfunction setSubtitleCache(subtitleCache) {\n    setMyPaCache(\"subtitleCache\", subtitleCache);\n}*/\n\nlet iconType = \"ai|apk|avi|css|dmg|exe|flv|gif|hiker|html|iso|jpg|js|json|log|mov|mp3|mp4|otf|php|png|ppt|psd|table|txt|wav|xls|zip|css|doc|epub|exc|htm|xlsx\".split('|');\n\nfunction getIcon(ext, type) {\n    let root = \"https://gitcode.net/qq_32394351/dr/-/raw/master/img/æ–‡ä»¶ç±»å‹2/\";\n    if (type === \"folder\") {\n        return root + \"æ–‡ä»¶å¤¹.svg\";\n    }\n    if (iconType.includes((ext || \"\").toLowerCase())) {\n        return root + ext + \".svg\";\n    }\n    return root + \"æ–‡ä»¶.svg\";\n\n}\n\nfunction load(items) {\n    const aliAccessApi = AliAccessApi.createDefault();\n\n    let orders = {\n        \"åç§°æ­£åº\": \"name#ASC\",\n        \"åç§°å€’åº\": \"name#DESC\",\n        \"æ—¶é—´æ­£åº\": \"updated_at#ASC\",\n        \"æ—¶é—´å€’åº\": \"updated_at#DESC\",\n        \"å¤§å°æ­£åº\": \"size#ASC\",\n        \"å¤§å°å€’åº\": \"size#DESC\"\n    };\n    let playMode = getItem(\"my_aliyun_playMode\", \"è½¬ç \");\n    let ordersKeys = Object.keys(orders);\n    let orderName = getItem(\"aliyun_order\", ordersKeys[0]);\n    let order = orders[orderName].split(\"#\");\n    let styles = [\"text_1\", \"movie_2\", \"card_pic_3\", \"avatar\", \"è¿½å‰§\", \"çœ‹å›¾\"];\n    let style = getItem(\"aliyun_style\", styles[0]);\n\n    let isBackupDrivid = MY_PARAMS.isBackupDrivid || getItem(\"myAliPanDrivid\", \"false\") === \"true\";\n    aliAccessApi.setMyDrividType(isBackupDrivid);\n    if (MY_PAGE === 1) {\n        if (!getMyVar(\"mountzimu\", \"\")) {\n            storage0.putMyVar(\"mountzimu\", {});\n            addListener(\"onClose\", $.toString(() => {\n                clearMyVar(\"mountzimu\");\n                clearMyVar(\"aliShareToken\");\n                clearVar(\"dm_share\");\n                clearMyVar(\"dmlist\");\n                clearMyVar(\"listSearchKey\");\n                clearMyVar(\"dm_listUrlList\");\n            }));\n        }\n        setMarker();\n        if (MY_PARAMS.isHome) {\n            //signInReward(aliAccessApi);\n            items.push({\n                title: \"å¤‡ä»½ç›˜\" + [\"\", \"âˆš\"][Number(isBackupDrivid)],\n                url: $(\"#noLoading#\").lazyRule(() => {\n                    setItem(\"myAliPanDrivid\", \"true\");\n                    refreshPage();\n                    return \"hiker://empty\";\n                }),\n                col_type: \"text_2\",\n            });\n            items.push({\n                title: \"èµ„æºç›˜\" + [\"âˆš\", \"\"][Number(isBackupDrivid)],\n                url: $(\"#noLoading#\").lazyRule(() => {\n                    setItem(\"myAliPanDrivid\", \"false\");\n                    refreshPage();\n                    return \"hiker://empty\";\n                }),\n                col_type: \"text_2\",\n            });\n        }\n        if (shareInfo) {\n            items.push({\n                title: \"â€œâ€œè½¬å­˜åˆ°å½“å‰æ–‡ä»¶å¤¹â€â€\",\n                url: $(\"#noLoading#\").lazyRule((shareInfo, isBackupDrivid, fileId) => {\n                    const AliAccessApi = $.require(\"aliPlayApi\");\n                    let aliAccessApi = AliAccessApi.createDefault(shareInfo.shareId, shareInfo.sharePwd, shareInfo.shareToken);\n                    aliAccessApi.setMyDrividType(isBackupDrivid);\n                    aliAccessApi.copyFileToCloudFile(shareInfo.fileId, fileId);\n                    backToHome();\n                    return \"hiker://empty\";\n                }, shareInfo, isBackupDrivid, fileId),\n                col_type: \"text_center_1\",\n            });\n        }\n        if (!isSearch) {\n            items.push({\n                title: \"æœç´¢\",\n                url: $.toString(() => {\n                    input = input.trim();\n                    if (!input) return \"toast://è¯·è¾“å…¥å…³é”®è¯\";\n                    return \"hiker://page/myaliyun#noHistory##fullTheme#?page=fypage&searchKey=\" + encodeURIComponent(input);\n                }),\n                col_type: \"input\",\n                extra: {\n                    onChange: \"putMyVar('listSearchKey',input)\",\n\n                }\n            });\n        } else {\n            items.push({\n                title: \"â€œâ€œ\" + searchKey + \"â€â€çš„æœç´¢ç»“æœ\",\n                url: \"hiker://empty\",\n                col_type: \"text_center_1\",\n                extra: {\n                    lineVisible: false\n                }\n            });\n        }\n        let funcItems = [];\n        funcItems.push({\n            title: style,\n            url: $(styles, 1, \"æ’å¸ƒæ ·å¼\").select(() => {\n                setItem(\"aliyun_style\", input);\n                refreshPage();\n                return \"toast://å·²åˆ‡æ¢\";\n            }),\n            pic_url: \"http://123.56.105.145/img/ali_icon.svg\"\n        }, {\n            title: orderName,\n            url: $(ordersKeys, 2, \"æ’åºæ–¹å¼\").select(() => {\n                setItem(\"aliyun_order\", input);\n                refreshPage();\n                return \"toast://åˆ‡æ¢æˆåŠŸ\";\n            }),\n            pic_url: \"http://123.56.105.145/img/ali_sort.svg\"\n        }, {\n            title: playMode,\n            url: $([\"è½¬ç \", \"åŸç”»\", \"æé€ŸåŸç”»\"], 1, \"æ’­æ”¾æ¨¡å¼\").select(() => {\n                setItem(\"my_aliyun_playMode\", input);\n                refreshPage();\n                return \"toast://åˆ‡æ¢æˆåŠŸ\";\n            }),\n            pic_url: \"http://123.56.105.145/img/ali_play.svg\",\n        });\n\n        funcItems.push({\n            title: openAPIList[getItem(\"openApiMode\", \"0\")],\n            url: $(openAPIList, 1, \"åŸç”»API(ä¸è¦é¢‘ç¹åˆ‡æ¢)\").select((openAPIList) => {\n                setItem(\"openApiMode\", String(openAPIList.indexOf(input)));\n                deleteFile($.require(\"tokenPath\").openTokensFilepath);\n                refreshPage(false);\n                return \"toast://å·²åˆ‡æ¢ä¸º\" + input;\n            }, openAPIList),\n            pic_url: \"http://123.56.105.145/img/ali_api.svg\",\n        });\n\n        if (!isSearch) {\n            funcItems.push({\n                title: \"åŠŸèƒ½\",\n                url: $([\"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\", \"è·å–å¼¹å¹•æœç´¢è§„åˆ™\", \"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\", \"æ¨é€åˆ°TVBox\", \"è®¾ç½®æ”¶è—å°é¢\", \"è·å–æŠ•å±IP\" , \"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\"], 2, \"æ›´å¤šåŠŸèƒ½\").select(() => {\n                    switch (input) {\n                        case \"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\":\n                            return \"hiker://page/dmMount#noHistory##noRecordHistory#\";\n                        case \"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\":\n                            let zm = storage0.getMyVar(\"mountzimu\", {});\n                            let tip = zm.name ? \"å½“å‰å­—å¹•æ–‡ä»¶\\n\" + zm.name + \".\" + zm.ext : \"è¿˜æœªæ‰‹åŠ¨æŒ‚è½½å­—å¹•\";\n                            confirm({\n                                title: 'æ‰‹åŠ¨æŒ‚è½½å­—å¹•',\n                                content: tip + \"\\n(ç‚¹å‡»å–æ¶ˆå¯ä»¥æ¸…é™¤æŒ‚è½½å­—å¹•)\",\n                                cancel: () => {\n                                    clearMyVar(\"mountzimu\");\n                                    return \"toast://å·²æ¸…é™¤æ‰‹åŠ¨æŒ‚è½½å­—å¹•\";\n                                }\n                            });\n                            return;\n                        case \"è·å–å¼¹å¹•æœç´¢è§„åˆ™\":\n                            let rule = {\n                                \"js\": JSON.stringify(\"hiker://page/loadDm?rule=\" + MY_RULE.title + \"&title=\") + \"+encodeURIComponent(playdata.title.split('-')[0]);\",\n                                \"name\": MY_RULE.title + \"å¼¹å¹•æœç´¢\"\n                            };\n                            return \"rule://\" + base64Encode(\"ï¿¥projection_screenï¿¥\" + JSON.stringify(rule));\n                        case \"æ¨é€åˆ°TVBox\":\n                            return \"hiker://page/tvboxPush#noHistory##noRecordHistory#\";\n                        case \"è®¾ç½®æ”¶è—å°é¢\":\n                            return $([\"è®¾ç½®å°é¢åœ°å€\", \"æœç´¢å°é¢\"], 1).select(() => {\n                                if (input === \"è®¾ç½®å°é¢åœ°å€\") {\n                                    return $(\"\", \"è¯·è¾“å…¥å›¾ç‰‡åœ°å€\").input(() => {\n                                        input = input.trim();\n                                        if (!input) return \"toast://è¯·è¾“å…¥åœ°å€\";\n                                        setPagePicUrl(input);\n                                        return \"toast://ä¿®æ”¹æˆåŠŸ\";\n                                    });\n                                } else {\n                                    return \"hiker://page/frontCover#noHistory##noRecordHistory#\";\n                                }\n                            });\n                        case \"è·å–æŠ•å±IP\":\n                            let ip = $.require(\"aliUtil\").getIPv4Address();\n                            if (ip.startsWith(\"192.168.\")) {\n                                return $(ip + \"\\nè¯¥IPé€‚ç”¨äºæµé‡+çƒ­ç‚¹çš„æŠ•å±\\nè¯·æ›¿æ¢é“¾æ¥ä¸­çš„0.0.0.0\").confirm((ip) => {\n                                    return \"copy://\" + ip;\n                                }, ip);\n                            } else {\n                                return $(ip + \"\\nè·å–å¤±è´¥éç¨³å®šIP,è¯·å¼€å¯çƒ­ç‚¹å†ä½¿ç”¨,è¯¥IPå¯èƒ½ä¼šå˜,ä¸èƒ½æŠ•å±\").confirm(() => {});\n                            }\n                        case \"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\":\n                            return $(getItem(\"speedThread\", \"10\"), \"è¯·è¾“å…¥3-32ä¹‹é—´çš„æ•´æ•°\").input(() => {\n                                let speedThread = parseInt(input);\n                                if (speedThread < 3 || speedThread > 32) {\n                                    return \"toast://è®¾ç½®ä¸åˆæ³•\";\n                                }\n                                setItem(\"speedThread\", String(speedThread));\n                                return \"toast://è®¾ç½®æˆåŠŸ\";\n                            });\n                    }\n                }),\n                pic_url: \"http://123.56.105.145/img/ali_fileinto.svg\",\n                extra: {\n                    pageId: pageId,\n                    fileId: fileId,\n                    folderName: getPageTitle()\n                }\n            });\n        } else {\n            funcItems.push({\n                title: [\"ALL\", \"ä»…æ–‡ä»¶\", \"ä»…æ–‡ä»¶å¤¹\"][skipFile],\n                url: $([\"ALL\", \"ä»…æ–‡ä»¶\", \"ä»…æ–‡ä»¶å¤¹\"]).select(() => {\n                    setItem(\"myskipFile\", String(MY_INDEX));\n                    refreshPage(false);\n                    return \"hiker://empty\";\n                }),\n                pic_url: \"hiker://images/icon_search6\",\n            });\n        }\n        let funStyle = [\"\", \"\", \"\", \"icon_small_3\", \"icon_round_small_4\", \"icon_5\"][funcItems.length];\n        items.push.apply(items, funcItems.map(v => (v.col_type = funStyle) && v));\n        items.push({\n            col_type: \"line_blank\"\n        });\n    }\n    let rescod = {};\n    let marker = MY_PARAMS.marker;\n    if (isSearch) {\n        rescod = aliAccessApi.getSearchListFile(searchKey, marker, order[0], order[1], skipFile);\n    } else {\n        rescod = aliAccessApi.getListFile(fileId, marker, order[0], order[1]);\n    }\n    if (rescod.next_marker) {\n        setMarker(rescod.next_marker);\n    } else {\n        setMarker();\n    }\n\n    var conts = rescod.items;\n    //å­—å¹•åŒ¹é…å‡†å¤‡\n    let subExts = [\"vtt\", \"srt\", \"ass\"];\n    var zimulist = [];\n    conts.forEach((item) => {\n        if (subExts.includes(item.file_extension && item.file_extension.toLowerCase())) {\n            let name = item.name.replace('.' + item.file_extension, '');\n            zimulist.push({\n                ext: item.file_extension,\n                file_id: item.file_id,\n                name: name\n            });\n        }\n    });\n    //å¤„ç†å¤¸é¡µåŒ¹é…å­—å¹•\n    /*\n    let hasSub = zimulist.length > 0;\n    if (hasSub&&rescod.next_marker) {\n        if (zimulist.length > 4) {\n            setSubtitleCache(zimulist.slice(-4));\n        } else {\n            setSubtitleCache(zimulist);\n        }\n    }\n    let lastItem = conts.at(-1);\n    if (hasSub&&lastItem&&lastItem.category === \"video\") {\n        setVideoItemCache(conts.splice(conts.length-1,1));\n    }\n    if (MY_PAGE > 1) {\n        let subtitleCache = MY_PARAMS.subtitleCache || [];\n        zimulist = zimulist.concat(subtitleCache);\n        let videoItemCache = MY_PARAMS.videoItemCache || [];\n        conts = videoItemCache.concat(conts);\n        setSubtitleCache();\n        setVideoItemCache();\n    }*/\n    //ç®€ä½“ä¼˜å…ˆ\n    zimulist.sort((a, b) => (b.name.endsWith(\".sc\") || b.name.endsWith(\".chs\")) - (a.name.endsWith(\".sc\") || a.name.endsWith(\".chs\")));\n    //end\n    let titleHead = {\n        video: \"ğŸ¬\",\n        audio: \"ğŸµ\",\n        doc: \"ğŸ“‘\",\n        image: \"ğŸ–¼\",\n        zip: \"ğŸ“¦\",\n        folder: \"ğŸ“‚\"\n    };\n\n    function getHead(type, ext) {\n        let head = titleHead[type];\n        if (subExts.includes(ext)) {\n            head = \"ğŸ•¸\";\n        }\n        return head || \"â“\";\n    }\n\n    function getPreviewPic(fileItem) {\n        if (fileItem.thumbnail) {\n            return $(\"https://empty?\" + fileItem.file_id).image((pic) => {\n                try {\n                    return fetch(pic, {\n                        inputStream: true\n                    });\n                } catch (e) {\n                    return null;\n                }\n            }, fileItem.thumbnail);\n        }\n    }\n\n    function deleteDFile(fileId, isBackupDrivid, name) {\n        return $(\"ç¡®è®¤æ°¸ä¹…åˆ é™¤[\" + name + \"]\").confirm((fileId, isBackupDrivid) => {\n            const AliAccessApi = $.require(\"aliPlayApi\");\n            let aliAccessApi = AliAccessApi.createDefault();\n            aliAccessApi.setMyDrividType(isBackupDrivid);\n            aliAccessApi.deleteeCloudFile(fileId);\n            refreshPage(false);\n            return \"hiker://empty\";\n        }, fileId, isBackupDrivid);\n    }\n    let folderStyle, fileStyle;\n    let filterType = [];\n    if (style === \"è¿½å‰§\") {\n        folderStyle = \"avatar\";\n        fileStyle = \"movie_2\";\n        filterType.push(\"video\");\n        items.push({\n            title: \"â€œâ€œâ€â€\" + \"è¿½å‰§æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œè§†é¢‘\".small().fontcolor(\"grey\"),\n            url: \"hiker://empty\",\n            col_type: \"text_center_1\",\n            extra: {\n                lineVisible: false\n            }\n        });\n    } else if (style === \"çœ‹å›¾\") {\n        folderStyle = \"avatar\";\n        fileStyle = \"card_pic_3\";\n        filterType.push(\"image\");\n        items.push({\n            title: \"â€œâ€œâ€â€\" + \"çœ‹å›¾æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œå›¾ç‰‡\".small().fontcolor(\"grey\"),\n            url: \"hiker://empty\",\n            col_type: \"text_center_1\",\n            extra: {\n                lineVisible: false\n            }\n        });\n    } else {\n        folderStyle = fileStyle = style;\n    }\n    let noSkipFile = true;\n    for (let i = 0; i < conts.length; i++) {\n        let fileItem = conts[i];\n        let cate = fileItem.category;\n        let desc = formatDate(fileItem.updated_at);\n        let pic_url = getIcon(fileItem.file_extension, fileItem.type);\n\n        if (fileItem.type === \"folder\") {\n            let title = (folderStyle === \"text_1\" ? titleHead.folder : \"\") + fileItem.name;\n            items.push({\n                title: title,\n                url: 'hiker://page/myaliyun?page=fypage',\n                col_type: folderStyle,\n                desc: formatDate(fileItem.updated_at),\n                pic_url: pic_url,\n                extra: {\n                    fileId: fileItem.file_id,\n                    isBackupDrivid,\n                    pageTitle: fileItem.name,\n                    shareInfo,\n                    noPic: true,\n                    longClick: [{\n                        title: \"åˆ é™¤æ–‡ä»¶å¤¹\",\n                        js: $.toString(deleteDFile, fileItem.file_id, isBackupDrivid, fileItem.name)\n                    }]\n                }\n            });\n        } else if (noSkipFile) {\n            if (filterType.length > 0 && !filterType.includes(cate)) {\n                continue;\n            }\n            let subtitle, cls, longc = [{\n                title: \"åˆ é™¤æ–‡ä»¶\",\n                js: $.toString(deleteDFile, fileItem.file_id, isBackupDrivid, fileItem.name)\n            }];\n            let title = fileItem.name;\n            let nameNotExt = fileItem.name.replace('.' + fileItem.file_extension, '');\n            if (subExts.includes(fileItem.file_extension)) {\n                longc.push({\n                    title: \"æŒ‚è½½å­—å¹•\",\n                    js: $.toString((zm) => {\n                        storage0.putMyVar('mountzimu', zm);\n                        return 'toast://æŒ‚è½½å®Œæˆï¼Œå½“å‰å­—å¹•æ–‡ä»¶: ' + zm.name + '.' + zm.ext;\n                    }, {\n                        ext: fileItem.file_extension,\n                        file_id: fileItem.file_id,\n                        name: nameNotExt\n                    }),\n                });\n            }\n            if (cate === \"video\") {\n                if (zimulist.length) {\n                    subtitle = zimulist.find(v => v.name.includes(nameNotExt));\n                }\n                cls = \"playlist v\" + pageId;\n            }\n            if (fileStyle === \"text_1\") {\n                desc += \"\\t\\t\" + formatSize(fileItem.size);\n                title = getHead(cate, fileItem.file_extension) + title;\n            } else if ([\"video\", \"image\"].includes(cate)) {\n                pic_url = getPreviewPic(fileItem) || pic_url;\n            }\n            items.push({\n                title: title,\n                url: $(\"#noPre#\").lazyRule((fileId, cate, isBackupDrivid, subtitle) => {\n                    return $.require(\"myalilazy\")(fileId, cate, isBackupDrivid, subtitle);\n                }, fileItem.file_id, cate, isBackupDrivid, subtitle),\n                desc: desc,\n                pic_url: pic_url,\n                extra: {\n                    id: fileItem.file_id,\n                    longClick: longc,\n                    cls: cls,\n                    //inheritTitle: false,\n                    pageTitle: fileItem.name\n                },\n                col_type: fileStyle\n            });\n        }\n    }\n    if (conts.length === 0) {\n        items.push({\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            title: \"â€œâ€œâ€â€\" + \"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\".fontcolor(\"Gray\"),\n            extra: {\n                lineVisible: false,\n            }\n        });\n    }\n}\n\nlet items = [];\ntry {\n    if (MY_PAGE > 1 && !MY_PARAMS.marker) {\n        items.push({\n            col_type: \"text_center_1\",\n            url: \"hiker://empty\",\n            title: \"â€œâ€œâ€â€\" + \"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\".fontcolor(\"Gray\"),\n            extra: {\n                lineVisible: false,\n            }\n        });\n    } else {\n        load(items);\n    }\n} catch (e) {\n\n    log(\"åˆ—è¡¨åŠ è½½å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n    items.push({\n        title: 'æ¬§æ¬§ï¼ŒæŠ¥é”™äº†ã€‚åœ¨åˆ·æ–°å‡ æ¬¡ï¼Ÿæˆ–è€…æ›´æ¢æ–‡ä»¶å¤¹ã€‚',\n        url: \"hiker://empty\",\n        desc: e.toString(),\n        col_type: 'text_center_1'\n    });\n    //throw e;\n}\nsaveMyPaCache();\nsetResult(items);"},{"col_type":"movie_3","name":"æˆ‘çš„é˜¿é‡ŒLazy","path":"myalilazy","rule":"const AliAccessApi = $.require(\"aliPlayApi\");\nconst {\n    openTokensFilepath,\n    aliTokensFilepath\n} = $.require(\"tokenPath\");\n\nfunction aliM3u8Proxy(fileId, aliToken, isBackupDrivid, title) {\n    let suffix = \"media.m3u8\";\n    let urlname = \"url\";\n    let cacheFilePath = \"hiker://files/_cache/\" + fileId + MY_PARAMS.timestamp[0]+ \".m3u8\"\n    //è¿‡æœŸè·å–æ’­æ”¾åŸå§‹é“¾æ¥\n    function getAliPlayUrl(fileId, line) {\n        let aliurl;\n        try {\n            const AliAccessApi = $.require(\"hiker://page/aliPlayApi?rule=\" + title);\n            let aliAccessApi = AliAccessApi.createDefault(null, null, null, aliToken, null, title).setMyDrividType(isBackupDrivid);\n            let playUrlList =  aliAccessApi.getVideoCloudPreview(fileId) || [];\n\n            aliurl = playUrlList.find(v => v.template_id == line)[urlname];\n        } catch (e) {\n            log(e.toString());\n            throw e;\n        }\n        return aliurl;\n    }\n\n    function getM3u8Content(playurl) {\n        //media.m3u8\n        let home = playurl.split(suffix)[0];\n        let f = fetch(playurl, {\n            headers: {\n                \"User-Agent\": PC_UA,\n                \"Referer\": \"https://www.aliyundrive.com/\"\n            },\n            timeout: 3000\n        }).split(\"\\n\");\n        let ff = f.map(it => {\n            if (it.startsWith(\"media-\")) {\n                return \"/proxy?url=\" + base64Encode(home + it)+\"&timestamp=\"+MY_PARAMS.timestamp[0];\n            }\n            return it;\n        }).join(\"\\n\");\n\n        writeFile(cacheFilePath, ff);\n        return ff;\n    }\n\n    function updateTsUrl(url) {\n        let fid = url.split('&f=')[1].split('&')[0];\n        //log('sfid-' + fid);\n        let f = fetch(cacheFilePath).split(\"\\n\");\n        f.forEach(it => {\n            if (it && it.startsWith('/proxy?url=')) {\n                let furl = base64Decode(it.replace('/proxy?url=', '').split(\"&\")[0]);\n                if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\n                    url = furl;\n                }\n            }\n        })\n        let expires = url.split('x-oss-expires=')[1].split('&')[0];\n        const lasttime = parseInt(expires) - Date.now() / 1000;\n        if (lasttime < 60) {\n            //log('è¿‡æœŸæ›´æ–°')\n            let line = url.split('/media')[0]; //å–ä¹‹å‰æ’­æ”¾çš„tsæ®µçº¿è·¯\n            line = line.substring(line.lastIndexOf('/') + 1);\n            let f = getM3u8Content(getAliPlayUrl(fid, line)).split(\"\\n\");\n            f.forEach(it => {\n                if (it && it.startsWith('/proxy?url=')) {\n                    let furl = base64Decode(it.replace('/proxy?url=', ''));\n                    if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\n                        url = furl;\n                    }\n                }\n            })\n\n        }\n        return url;\n    }\n    try {\n        let url = base64Decode(MY_PARAMS.url[0]);\n        if (url.includes(\".ts\")) {\n            return JSON.stringify({\n                statusCode: 302,\n                headers: {\n                    \"Location\": updateTsUrl(url),\n                    \"User-Agent\": PC_UA,\n                    \"Referer\": \"https://www.aliyundrive.com/\"\n                }\n            });\n        } else {\n            let templateId = MY_PARAMS.templateId[0];\n            if(fileExist(cacheFilePath)){\n                return getM3u8Content(getAliPlayUrl(fileId, templateId));\n            }else{\n                return getM3u8Content(url);\n            }\n        }\n    } catch (e) {\n        log(\"#ä»£ç†æ’­æ”¾å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n    }\n}\nconst transcoding = {\n    UHD: \"4K è¶…æ¸…\",\n    QHD: \"2K è¶…æ¸…\",\n    FHD: \"1080 å…¨é«˜æ¸…\",\n    HD: \"720 é«˜æ¸…\",\n    SD: \"540 æ ‡æ¸…\",\n    LD: \"360 æµç•…\"\n};\n\nfunction getVideo(aliAccessApi, fileId) {\n\n    let playUrlList = aliAccessApi.getVideoCloudPreview(fileId) || [];\n\n    let serverAddress = startProxyServer($.toString(aliM3u8Proxy, fileId, aliAccessApi.aliToken,aliAccessApi.myDrividType,MY_RULE.title));\n\n    if (playUrlList.length > 0) {\n        let urls = [],\n            names = [];\n        playUrlList.forEach((item) => {\n            urls.push(serverAddress + \"?url=\" + base64Encode(item.url) + \"&timestamp=\"+Date.now()+\"&templateId=\" + item.template_id + \"#.m3u8\");\n            names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\n        });\n        let heads = new Array(playUrlList.length).fill({\n            'Referer': 'https://www.aliyundrive.com/'\n        });\n        return {\n            urls: urls,\n            names: names,\n            headers: heads,\n        };\n    } else {\n        return {};\n    }\n\n}\n\n\nfunction getPlayFormat(playUrl, title) {\n    return {\n        names: [title],\n        urls: [playUrl + \"#isVideo=true##ignoreMusic=true#\"],\n        headers: [{\n            'Referer': 'https://www.aliyundrive.com/',\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36\"\n        }]\n    };\n}\n\n\n$.exports = function(fileId, cate, isBackupDrivid,  zimu) {\n    if (!fileExist(aliTokensFilepath)) {\n        toast(\"è¯·å…ˆç™»é™†ç™»å½•è´¦å·\");\n        return \"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\";\n    }\n    let aliToken = $.require(aliTokensFilepath);\n    let aliAccessApi = AliAccessApi.createDefault(null, null, null, aliToken, null);\n    aliAccessApi.setMyDrividType(isBackupDrivid);\n    if (cate === \"video\") {\n        let playList = [];\n        let playMode = getItem(\"my_aliyun_playMode\", \"è½¬ç \");\n        try {\n            \n            if (playMode === \"è½¬ç \") {\n                playList = getVideo(aliAccessApi, fileId) || {};\n            } else if (playMode === \"åŸç”»\") {\n                playList = getPlayFormat(aliAccessApi.openCloudFileToDownUrl(fileId), playMode);\n            }else if (playMode === \"æé€ŸåŸç”»\") {\n                playList = getPlayFormat(aliAccessApi.openCloudFileToDownUrl(fileId)+ \"#fastPlayMode##threads=\" + getItem(\"speedThread\", \"10\") + \"#\", playMode);\n            }\n        } catch (e) {\n            log(\"#\" + playMode + \"æ’­æ”¾å¤±è´¥#\\né”™è¯¯ä¿¡æ¯>\" + e.toString() + \"\\né”™è¯¯è¡Œ>\" + e.lineNumber);\n            if (e.code === \"InvalidParameter.RefreshToken\") {\n                toast(\"ç™»é™†è¿‡æœŸï¼Œè¯·é‡æ–°ç™»é™†\");\n                return \"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\";\n            } else if (e.code === \"QuotaExhausted.Drive\") {\n                return \"toast://ç½‘ç›˜ç©ºé—´ä¸è¶³ï¼Œæ— æ³•æ’­æ”¾è¯·æ¸…ç†ã€‚\";\n            }\n            return \"toast://æ’­æ”¾å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å·²æ‰“å°ã€‚\\nè¯·æŸ¥çœ‹æ—¥å¿—(LOG)\";\n        }\n        let mountsub = storage0.getMyVar('mountzimu', {});\n        if (Object.keys(mountsub).length > 0) {\n            zimu = mountsub;\n        }\n        let subtitle;\n        if (Object.keys(zimu || {}).length > 0 && playList && playList.urls && playList.urls.length > 0) {\n            java.lang.Thread.sleep(100);\n            try {\n                var zmurl = aliAccessApi.openCloudFileToDownUrl(zimu.file_id);\n                let path = 'hiker://files/cache/äº‘ç›˜å›/sub.' + zimu.ext;\n                downloadFile(zmurl, path, {\n                    'Referer': 'https://www.aliyundrive.com/'\n                });\n                subtitle = getPath(path);\n            } catch (e) {\n                toast(\"å­—å¹•åŠ è½½å¤±è´¥\");\n                log(e.message);\n            }\n        }\n        let dmlist = storage0.getMyVar(\"dmlist\", []);\n        let dmlist_cache = getMyVar(\"dmlist_cache\", \"\");\n        if (dmlist_cache && dmlist_cache.startsWith(fileId + \"#\")) {\n            playList.danmu = dmlist_cache.replace(fileId + \"#\", \"\");\n        } else if (dmlist.length > 0) {\n            playList.danmu = \"hiker://files/cache/danmu/\" + dmlist.splice(0, 1)[0];\n            putMyVar(\"dmlist_cache\", fileId + \"#\" + playList.danmu);\n            storage0.putMyVar(\"dmlist\", dmlist);\n            if (dmlist.length === 0) {\n                toast(\"å¼¹å¹•åˆ—è¡¨å·²å…¨éƒ¨æŒ‚è½½\");\n            }\n        } /*else {\n            playList.danmu = getVar(\"dm_share\", \"\");\n        }*/\n        playList.subtitle = subtitle;\n        return JSON.stringify(playList);\n    }\n\n    let url = aliAccessApi.openCloudFileToDownUrl(fileId);\n\n    if (cate === \"image\") {\n        return url + \"#.jpg\";\n    } else if (cate === \"audio\") {\n        return url + \"#isMusic=true#\";\n    } else {\n        return \"download://\" + url;\n    }\n}"},{"col_type":"movie_3","name":"openApi:tv","path":"openApi_tv","rule":"js:\nfunction OpenApi($this, postApi) {\n    this.$this = $this;\n}\n\n// ç”Ÿæˆ unique_id\nfunction generateUUID() {\n    return 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'.replace(/[x]/g, function() {\n        return (Math.random() * 16 | 0).toString(16);\n    });\n}\n\n\n// ç”Ÿæˆ wifimac\nfunction generateWifiMac() {\n    const min = 10 ** 11;\n    const max = 10 ** 12 - 1;\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\nfunction h(charArray, modifier) {\n    // å»é™¤é‡å¤å­—ç¬¦\n    var uniqueChars = [];\n    for (var i = 0; i < charArray.length; i++) {\n        if (uniqueChars.indexOf(charArray[i]) === -1) {\n            uniqueChars.push(charArray[i]);\n        }\n    }\n    \n    var numericModifier = parseInt(modifier.slice(7));\n    var transformedString = '';\n    \n    for (var j = 0; j < uniqueChars.length; j++) {\n        var c = uniqueChars[j];\n        var code = Math.abs(c.charCodeAt(0) - (numericModifier % 127) - 1);\n        transformedString += String.fromCharCode(code < 33 ? code + 33 : code);\n    }\n    \n    return transformedString;\n}\n//eval(getCryptoJS());\n/*\nconst CryptoUtil = $.require(\"hiker://assets/crypto-java.js\");\n\n        let key = CryptoUtil.Data.parseUTF8(\"^(i/x>>5(ebyhumz*i1wkpk^orIs^Na.\");\n        let niv = CryptoUtil.Data.parseHex(iv);\n        let encrypted0 = CryptoUtil.AES.decrypt(ciphertext, key, {\n            mode: \"AES/CBC/PKCS7Padding\",\n            iv: niv\n        });\n\n        return JSON.parse(encrypted0.toString());\n        */\nfunction decrypt(ciphertext, iv, t, unique_id, wifimac) {\n    try {\n        var key = generateKey(t, unique_id, wifimac);\n        /*var cipherParams = CryptoJS.lib.CipherParams.create({\n            ciphertext: CryptoJS.enc.Base64.parse(ciphertext)\n        });\n\n        var decrypted = CryptoJS.AES.decrypt(cipherParams, CryptoJS.enc.Utf8.parse(key), {\n            iv: CryptoJS.enc.Hex.parse(iv),\n            mode: CryptoJS.mode.CBC,\n            padding: CryptoJS.pad.Pkcs7\n        });\n\n        var dec = decrypted.toString(CryptoJS.enc.Utf8);*/\n        const CryptoUtil = $.require(\"hiker://assets/crypto-java.js\");\n        let keydata = CryptoUtil.Data.parseUTF8(key);\n        let ivdata = CryptoUtil.Data.parseHex(iv);\n        let encrypted0 = CryptoUtil.AES.decrypt(ciphertext, keydata, {\n            mode: \"AES/CBC/PKCS7Padding\",\n            iv: ivdata\n        });\n        return encrypted0.toString();\n    } catch (error) {\n        log(\"Decryption failed \"+error.toString());\n        throw error;\n    }\n}\n\nfunction getParams(t, unique_id, wifimac) {\n    let params = {\n        'akv': '2.8.1496',\n        'apv': '1.3.6',\n        'b': 'OnePlus',\n        'd': unique_id,\n        'm': 'PJX110',\n        'mac': '',\n        'n': 'PJX110',\n        't': String(t),\n        'wifiMac': String(wifimac),\n    };\n    return params;\n}\nfunction generateKey(t, unique_id, wifimac) {\n    var params = getParams(t, unique_id, wifimac);\n    var sortedKeys = Object.keys(params).sort();\n    \n    var concatenatedParams = '';\n    for (var i = 0; i < sortedKeys.length; i++) {\n        var key = sortedKeys[i];\n        if (key !== 't') {\n            concatenatedParams += params[key];\n        }\n    }\n\n    var hashedKey = h(concatenatedParams.split(''), t);\n    return md5(hashedKey);\n}\nObject.assign(OpenApi.prototype, {\n    getOpenTokenCode() {\n        function get_qrcode_code(sid) {\n            let res = fetch(\"https://openapi.aliyundrive.com/oauth/qrcode/\" + sid + \"/status\");\n            return JSON.parse(res).authCode;\n        }\n\n        let res = post(\"http://api.extscreen.com/aliyundrive/qrcode\", {\n            body: JSON.stringify({\n                \"scopes\": 'user:base,file:all:read,file:all:write',\n                \"width\": 500,\n                \"height\": 500,\n            }),\n        });\n        let data = JSON.parse(res).data;\n        let sid = data[\"sid\"];\n        let body = {\n            \"authorize\": 1,\n            \"scope\": \"user:base,file:all:read,file:all:write\",\n            \"drives\": [\"backup\", \"resource\"],\n            \"scopes\": [\"user:base\", \"file:all:read\", \"file:all:write\"],\n            \"sid\": sid\n        }\n        let headers = {\n            'authorization': this.$this.reaccessTk\n        };\n        let res2 = this.$this.postApi(\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\n            this.$this.trySolve(e);\n            http.mergeHeadAndBody({\n                headers: {\n                    'authorization': this.$this.reaccessTk,\n                }\n            });\n            return true;\n        }).start(true);\n        return get_qrcode_code(sid);\n    },\n    getToken(body) {\n\n        let timestamp = String(JSON.parse(fetch(\"http://api.extscreen.com/timestamp\")).data.timestamp);\n        let unique_id = generateUUID();\n        let wifimac = generateWifiMac().toString();\n        let res = post(\"http://api.extscreen.com/aliyundrive/v3/token\", {\n            body: JSON.stringify(body),\n            headers: Object.assign({\n\n                \"token\": \"6733b42e28cdba32\",\n                'User-Agent': 'Mozilla/5.0 (Linux; U; Android 9; zh-cn; SM-S908E Build/TP1A.220624.014) AppleWebKit/533.1 (KHTML, like Gecko) Mobile Safari/533.1',\n                //'Host': 'api.extscreen.com'\n            }, getParams(timestamp, unique_id, wifimac))\n        });\n        let data = JSON.parse(res);\n        let {\n            iv,\n            ciphertext\n        } = data.data;\n        return JSON.parse(decrypt(ciphertext, iv, timestamp, unique_id, wifimac));\n    },\n    getOpenToken() {\n        return this.getToken({\n            code: this.getOpenTokenCode(),\n            grant_type: \"authorization_code\"\n        });\n    },\n    refreshOpenToken() {\n        return this.getToken({\n            grant_type: \"refresh_token\",\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\n        });\n    }\n});\n$.exports = OpenApi;"},{"col_type":"movie_3","name":"å¼¹å¼¹PLAY","path":"danmu#ttplay","rule":"js:\nfunction search(name) {\n    const danmu = $.require(\"danmu\");\n    let dmList = danmu.getDanMu(name);\n    let d = [];\n    for (let anime of dmList.animes) {\n        d.push({\n            title: \"[\" + anime.typeDescription + \"]\" + anime.animeTitle,\n            url: $().lazyRule((episodes, animeTitle) => {\n                let d = [];\n                for (let episode of episodes) {\n                    let dmTitle = animeTitle + \"_\" + episode.episodeTitle;\n                    d.push({\n                        title: episode.episodeTitle,\n                        url: $(episode.episodeId).lazyRule((title) => {\n                            const danmu = $.require(\"danmu\");\n                            let path = danmu.getLocalDanMu(input, title) || danmu.downloadDanMu(input, title);\n                            let danmuText = fetch(path);\n                            if (!danmuText) return \"toast://è¿˜æ²¡æœ‰å¼¹å¹•å“Ÿ~\";\n                            return path;\n                        }, dmTitle),\n                    });\n                }\n                return d;\n            }, anime.episodes, anime.animeTitle),\n        });\n\n    }\n    return d;\n}\nsearch(input)"}],"title":"äº‘ç›˜å›.ç®€","author":"å°æ£‰è¢„ğŸŒ&@LoyDgIk","version":183,"type":"all","url":"hiker://empty##fypage","col_type":"movie_3","class_name":"","class_url":"","area_name":"","area_url":"","sort_name":"","year_name":"","sort_url":"","year_url":"","find_rule":"js:$.require(\"Main\");","searchFind":"js:\nlet isdDelegate = !!getItem(\"isdDelegate\", \"\");\nif (isdDelegate) {\n    setResult([{\n        title: \"ç‚¹æˆ‘å¼€å§‹èšåˆæœç´¢\" + MY_KEYWORD,\n        url: \"hiker://search?s=\" + MY_KEYWORD,\n        extra: {\n            delegateOnlySearch: true,\n            rules: $.toString(() => {\n                try {\n                    let ruleGroup = getItem(\"ruleGroup\", \"\");\n                    let data = $.require(\"data\").getAllData(ruleGroup);\n                    let rules = [];\n                    for (let it of data) {\n                        rules.push({\n                            title: it.name,\n                            search_url: \"hiker://empty?page=fypage&searchTerms=**\",\n                            searchFind: \"js:\" + $.toString((rule) => {\n                                setResult($.require(\"data\").carrySRule(rule, MY_KEYWORD, MY_PAGE, getSearchMode()));\n                            }, it)\n                        });\n                    }\n                    return JSON.stringify(rules);\n                } catch (e) {\n                    log(e.toString());\n                }\n            })\n        }\n    }]);\n} else {\n    setResult([{\n        title: \"ç‚¹æˆ‘å¼€å§‹èšåˆæœç´¢\" + MY_KEYWORD,\n        url: \"hiker://page/sou#noHistory#?p=fypage\",\n        extra: {\n            pageTitle: \"æœç´¢\" + MY_KEYWORD,\n            searchTerms: MY_KEYWORD,\n            hideSetting: true\n        }\n    }]);\n}","search_url":"hiker://empty?searchTerms=**","group":"â‘ æ¨è","detail_col_type":"movie_1","detail_find_rule":"","sdetail_col_type":"movie_1","sdetail_find_rule":"","ua":"mobile","preRule":"","pages":"[{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™å¤„ç†\",\"path\":\"data\",\"rule\":\"js:\\nlet ParseRlue = $.require(\\\"ParseRlue\\\");\\n\\nfunction toRedirectTreating(config) {\\n    return $.require(\\\"redirect\\\").doubleTreating(config);\\n}\\n\\nfunction toRedirect(aliUrl, sharePwd) {\\n    return $.require(\\\"redirect\\\").getModeUrl(aliUrl, sharePwd);\\n}\\n\\nfunction getCompleteRule(rule) {\\n    if (rule.ruleType === \\\"JSON\\\") {\\n        let find = rule.find;\\n        rule.find = (s, page) => {\\n            let url = String(rule.basicUrl).replace(\\\"**\\\", encodeURIComponent(s)).replace(\\\"fypage\\\", page + \\\"\\\");\\n            return ParseRlue.parseSearchJson(url, find);\\n        }\\n    } else if (rule.ruleType === \\\"HTML\\\") {\\n        let find = rule.find;\\n        rule.find = (s, page) => {\\n            let url = String(rule.basicUrl).replace(\\\"**\\\", encodeURIComponent(s)).replace(\\\"fypage\\\", page + \\\"\\\");\\n            return ParseRlue.parseSearchHtml(url, find);\\n        }\\n    } else {\\n        let find = new Function(\\\"s\\\", \\\"page\\\", \\\"user\\\", \\\"basicUrl\\\", rule.find);\\n        rule.find = (s, page) => find(s, page, rule.user || {}, rule.basicUrl || \\\"\\\");\\n        /*if (rule.findAliUrl) {\\n            rule.findAliUrl = new Function(\\\"input\\\", \\\"basicUrl\\\", rule.findAliUrl);\\n        }*/\\n    }\\n    return rule;\\n}\\n$.exports.carryRule = function(rule, s, page, searchMode) {\\n    rule = getCompleteRule(rule);\\n    let list = rule.find(s, page);\\n    if (!list) return [];\\n\\n    let descTips = \\\"â€œâ€œâ€â€\\\" + rule.name.fontcolor(\\\"#f13b66a\\\") + \\\"&nbsp;\\\";\\n    let resList = [];\\n\\n    for (let it of list) {\\n        if (it.skip) {\\n            resList.push(it);\\n            continue;\\n        }\\n        if (searchMode && !searchContains(it.title, s, true)) continue;\\n        if (rule.findAliUrl) {\\n            it.url = $(it.url).lazyRule(toRedirectTreating, {\\n                findAliUrl: rule.findAliUrl,\\n                basicUrl: rule.basicUrl,\\n                name: rule.name,\\n                author: rule.author,\\n                aliUrl: it.url,\\n                ruleType: rule.ruleType\\n            });\\n        } else {\\n            it.url = $(\\\"#noLoading#\\\").lazyRule(toRedirect, it.url, it.sharePwd || \\\"\\\");\\n        }\\n        let title = it.title || \\\"\\\";\\n        resList.push({\\n            title: title.includes(\\\"â€œâ€œâ€â€\\\") ? title : \\\"â€œâ€œâ€â€\\\" + title.replace(new RegExp(\\\"<em>|</em>\\\", \\\"g\\\"), \\\"\\\").replace(new RegExp(\\\"(\\\" + s + \\\")\\\", \\\"gi\\\"), \\\"<strong><span style=\\\\\\\"color: #1E90FF\\\\\\\">$1</span></strong>\\\"),\\n            desc: descTips + (it.desc || \\\"\\\"),\\n            url: it.url,\\n            pic_url: it.pic_url,\\n            col_type: it.pic_url ? \\\"movie_1_vertical_pic\\\" : \\\"text_1\\\",\\n            extra: Object.assign({\\n                inheritTitle: false,\\n                noPic: true\\n            }, it.extra)\\n        });\\n    }\\n    return resList;\\n}\\n$.exports.carrySRule = function(rule, s, page, searchMode) {\\n    rule = getCompleteRule(rule);\\n    let list = rule.find(s, page);\\n    if (!list) return [];\\n    let resList = [];\\n    for (let it of list) {\\n        if (it.skip) {\\n            resList.push(it);\\n            continue;\\n        }\\n        if (searchMode && !searchContains(it.title, s, true)) continue;\\n        if (rule.findAliUrl) {\\n            it.url = $(it.url).lazyRule(toRedirectTreating, {\\n                findAliUrl: rule.findAliUrl,\\n                basicUrl: rule.basicUrl,\\n                name: rule.name,\\n                author: rule.author,\\n                aliUrl: it.url,\\n                ruleType: rule.ruleType\\n            });\\n        } else {\\n            it.url = $(\\\"#noLoading#\\\").lazyRule(toRedirect, it.url, it.sharePwd || \\\"\\\");\\n        }\\n        resList.push({\\n            title: it.title,\\n            desc: it.desc || \\\"\\\",\\n            url: it.url,\\n            pic_url: it.pic_url,\\n            extra: Object.assign({\\n                inheritTitle: false,\\n                noPic: true\\n            }, it.extra)\\n        });\\n    }\\n    return resList;\\n}\\nlet size = 10;\\n\\nlet rules;\\n\\nfunction getRules(group) {\\n    let rulesTmp;\\n    if (!rules) {\\n        rules = $.require(\\\"configs\\\").getUsefulJson();\\n    }\\n    if (group) {\\n        rulesTmp = rules.filter(v => v.group === group);\\n    } else {\\n        rulesTmp = rules;\\n    }\\n    return rulesTmp;\\n}\\n$.exports.getAllData = function(group) {\\n    return getRules(group);\\n};\\n$.exports.getData = function(page, rule, group) {\\n    if (rule) {\\n        if (page != null && page > 1) {\\n            return getRules().filter(i => i.name == rule && i.page);\\n        }\\n        return getRules().filter(i => i.name == rule);\\n    }\\n    let rulesTmp = getRules(group);\\n    let start = (page - 1) * size;\\n    if (rulesTmp.length < start + 1) {\\n        return [];\\n    }\\n    let len = size;\\n    if (rulesTmp.length < page * size) {\\n        len = rulesTmp.length - start;\\n    }\\n    return rulesTmp.slice(start, start + len);\\n};\\n$.exports.getNames = function(group) {\\n    return getRules(group).map(it => [it.name, it.basicUrl]);\\n};\\n\\n$.exports.getGroupNames = function() {\\n    return Array.from(new Set(getRules().map(v => v.group))).filter(v => v);\\n};\\n$.exports.findModulo = function(input) {\\n    let oriMods = [2, 3];\\n    let mods = oriMods.map(v => input % v);\\n    let zeroMods = mods.indexOf(0);\\n\\n    if (zeroMods > -1) {\\n        return oriMods[zeroMods];\\n    } else {\\n        return oriMods[mods.indexOf(Math.max.apply(null, mods))];\\n    }\\n};\"},{\"col_type\":\"movie_3\",\"name\":\"æœç´¢é¡µé¢\",\"path\":\"sou\",\"rule\":\"js:\\nconst alitest = $.require(\\\"alitest\\\");\\n\\nfunction setClip() {\\n    function getCopy() {\\n        try {\\n            const Context = android.content.Context;\\n            const context = getCurrentActivity();\\n            // è·å–ç³»ç»Ÿå‰ªè´´æ¿\\n            let clipboard = context.getSystemService(Context.CLIPBOARD_SERVICE);\\n            // è¿”å›æ•°æ®\\n            let clipData = clipboard.getPrimaryClip();\\n            if (clipData != null && clipData.getItemCount() > 0) {\\n                // ä»æ•°æ®é›†ä¸­è·å–ï¼ˆç²˜è´´ï¼‰ç¬¬ä¸€æ¡æ–‡æœ¬æ•°æ®\\n                let text = clipData.getItemAt(0).getText();\\n                if (text != null) {\\n                    return String(text.toString());\\n                }\\n            }\\n            return null;\\n        } catch (e) {\\n            return null;\\n        }\\n    }\\n    let text = getCopy() || \\\"\\\";\\n    let url = alitest.matchAliUrl(text);\\n    if (url) {\\n        let cache = getItem(\\\"clipboardCache\\\", \\\"\\\");\\n        if (url !== cache) {\\n            d.push({\\n                title: 'â€œâ€œâ€â€<font color=\\\"#13B61B\\\">â– </font><b>æ¸©é¦¨æç¤º<b>',\\n                desc: \\\"æ£€æµ‹åˆ°å‰ªè´´æ¿å«æœ‰é˜¿é‡Œé“¾æ¥æ˜¯å¦æ‰“å¼€?\\\\n\\\" + url,\\n                url: $(\\\"#noLoading#\\\").lazyRule((input, id) => {\\n                    deleteItem(id + \\\"clipboard\\\");\\n                    return \\\"hiker://page/aliyun?page=fypage&realurl=\\\" + encodeURIComponent(input) + \\\"&sharePwd=\\\";\\n                }, url, id),\\n                col_type: \\\"text_1\\\",\\n                extra: {\\n                    id: id + \\\"clipboard\\\",\\n                    pageTitle: \\\"æ‰“å¼€é“¾æ¥\\\"\\n                }\\n            });\\n            setItem(\\\"clipboardCache\\\", url);\\n        }\\n    }\\n}\\n\\nfunction setPrepose() {\\n    if (openMode == \\\"æœ¬åœ°è§£æ\\\") {\\n        let aliTokensFilepath = $.require(\\\"hiker://page/tokenPath\\\").aliTokensFilepath;\\n        let a = fetch(aliTokensFilepath);\\n        if (!a || a == \\\"\\\") {\\n            d.push({\\n                title: '<font color=\\\"#13B61B\\\">â– </font><b>æ¸©é¦¨æç¤º<b>',\\n                col_type: \\\"rich_text\\\",\\n            });\\n            d.push({\\n                url: $(\\\"#noLoading#\\\").lazyRule(() => $.require(\\\"loginMode\\\")),\\n                col_type: \\\"text_1\\\",\\n                title: \\\"æœªæ£€æµ‹åˆ°ç™»å½•ä¿¡æ¯ï¼Œç‚¹æˆ‘è·³è½¬ç™»å½•è´¦å·é¡µé¢ï¼Œç™»å½•é˜¿é‡Œäº‘ç›˜è´¦å·åæ–¹å¯ä½¿ç”¨æœ¬åœ°è§£ææ¨¡å¼\\\",\\n                extra: {\\n                    pageTitle: \\\"ç™»å½•é˜¿é‡Œäº‘ç›˜\\\"\\n                }\\n            });\\n        }\\n    }\\n    addListener(\\\"onClose\\\", $.toString(() => {\\n        clearMyVar(\\\"s\\\");\\n    }));\\n    addListener(\\\"onRefresh\\\", $.toString(() => {\\n        if (!getMyVar(\\\"refs\\\", \\\"\\\")) {\\n            clearMyVar(\\\"s\\\");\\n        }\\n    }));\\n}\\n\\nfunction setHead() {\\n    d.push({\\n        title: \\\"æœç´¢ï¼š\\\" + [\\\"é»˜è®¤\\\", \\\"ç²¾å‡†\\\"][searchMode],\\n        url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n            setSearchMode(getSearchMode() ? 0 : 1);\\n            refreshPage(false);\\n            return \\\"hiker://empty\\\"\\n        }),\\n        col_type: \\\"icon_3_round_fill\\\",\\n        pic_url: \\\"hiker://images/icon_search6\\\"\\n    });\\n    d.push({\\n        title: \\\"æˆ‘çš„é˜¿é‡Œ\\\",\\n        url: \\\"hiker://page/myaliyun?page=fypage\\\",\\n        col_type: \\\"icon_3_round_fill\\\",\\n        pic_url: \\\"hiker://images/icon_cloud6\\\",\\n        extra: {\\n            isHome: true\\n        }\\n    });\\n    d.push({\\n        title: \\\"è®¾ç½®|\\\" + openMode,\\n        url: $([\\\"æ¨¡å¼ï¼šæœ¬åœ°è§£æ\\\", \\\"æ¨¡å¼ï¼šå®˜æ–¹APP\\\", \\\"ç™»å½•é˜¿é‡Œè´¦å·\\\", \\\"ç™»å½•ä¿¡æ¯\\\", \\\"è§„åˆ™ç®¡ç†\\\", \\\"æ”¯æŒä½œè€…\\\", \\\"ä½¿ç”¨ä»£ç†æœç´¢\\\", \\\"æ’­æ”¾æ¨¡å¼\\\", \\\"è·å–å¼¹å¹•æœç´¢è§„åˆ™\\\"], 1, \\\"äº‘ç®€è®¾ç½®\\\").select((ids) => {\\n            if (\\\"è§„åˆ™ç®¡ç†\\\" == input) {\\n                return \\\"hiker://page/ruleManage#noRecordHistory##noHistory#\\\";\\n            }\\n            if (\\\"æ”¯æŒä½œè€…\\\" == input) {\\n                return \\\"hiker://page/Donate.v#noRecordHistory##noHistory#\\\";\\n            }\\n            if (\\\"ç™»å½•é˜¿é‡Œè´¦å·\\\" == input) {\\n                return $.require(\\\"loginMode\\\");\\n            }\\n            if (\\\"ä½¿ç”¨ä»£ç†æœç´¢\\\" == input) {\\n                let isdDelegate = !!getItem(\\\"isdDelegate\\\", \\\"\\\");\\n                return $(\\\"å¼€å¯åå°ç¨‹åºåº•éƒ¨æœç´¢æ¡†å°†ä½¿ç”¨ä»£ç†æœç´¢\\\\nå½“å‰:\\\" + isdDelegate + \\\"\\\\nç‚¹å‡»ç¡®å®šå³å¯\\\" + (isdDelegate ? \\\"å…³é—­\\\" : \\\"å¼€å¯\\\")).confirm((isdDelegate) => {\\n                    setItem(\\\"isdDelegate\\\", isdDelegate ? \\\"\\\" : \\\"1\\\");\\n                    return \\\"toast://\\\" + (isdDelegate ? \\\"å·²å…³é—­\\\" : \\\"å·²å¼€å¯\\\");\\n                }, isdDelegate);\\n            }\\n            if (\\\"è·å–å¼¹å¹•æœç´¢è§„åˆ™\\\" === input) {\\n                let rule = {\\n                    \\\"js\\\": JSON.stringify(\\\"hiker://page/loadDm?rule=\\\" + MY_RULE.title + \\\"&title=\\\") + \\\"+encodeURIComponent(playdata.title.split('-')[0]);\\\",\\n                    \\\"name\\\": MY_RULE.title + \\\"å¼¹å¹•æœç´¢\\\"\\n                };\\n                return \\\"rule://\\\" + base64Encode(\\\"ï¿¥projection_screenï¿¥\\\" + JSON.stringify(rule));\\n            }\\n            if (\\\"æ’­æ”¾æ¨¡å¼\\\" === input) {\\n                let modes = [\\\"è½¬ç \\\", \\\"åŸç”»\\\", \\\"åŸè½¬\\\"];\\n                let mode = getItem(\\\"aliyun_playMode\\\", modes[0]);\\n                let index = modes.indexOf(mode);\\n                return $(modes, 1, \\\"æ’­æ”¾æ¨¡å¼\\\", index).select(() => {\\n                    setItem(\\\"aliyun_playMode\\\", input);\\n                    return \\\"toast://åˆ‡æ¢æˆåŠŸ\\\";\\n                });\\n            }\\n            if (\\\"ç™»å½•ä¿¡æ¯\\\" == input) {\\n                const {\\n                    openTokensFilepath,\\n                    aliTokensFilepath\\n                } = $.require(\\\"tokenPath\\\");\\n                if (!fileExist(aliTokensFilepath)) return \\\"toast://è¿˜æœªç™»é™†\\\";\\n                let ali = request(aliTokensFilepath);\\n                try {\\n                    ali = JSON.parse(ali);\\n                } catch (e) {\\n                    deleteFile(aliTokensFilepath);\\n                    return \\\"toast://è·å–å¤±è´¥\\\";\\n                }\\n                confirm({\\n                    title: 'ç™»å½•ä¿¡æ¯',\\n                    content: \\\"ç”¨æˆ·:\\\" + (ali.nick_name || ali.user_name || \\\"Tokenç™»å½•\\\") + \\\"\\\\nToken:\\\" + ali.refresh_token + \\\"\\\\n(å–æ¶ˆï¼šæ³¨é”€ç™»å½•ï¼›ç¡®å®šï¼šå¤åˆ¶Token)\\\",\\n                    confirm: $.toString((token) => {\\n                        return \\\"copy://\\\" + token;\\n                    }, ali.refresh_token),\\n                    cancel: $.toString((path1, path2) => {\\n                        return $(\\\"ç¡®è®¤æ³¨é”€ç™»å½•\\\").confirm((path1, path2) => {\\n                            deleteFile(path1);\\n                            deleteFile(path2);\\n                            refreshPage();\\n                            return \\\"toast://å·²æˆåŠŸé€€å‡ºç™»é™†\\\";\\n                        }, path1, path2);\\n                    }, aliTokensFilepath, openTokensFilepath)\\n                });\\n                return;\\n            }\\n            input = input.replace(\\\"æ¨¡å¼ï¼š\\\", \\\"\\\");\\n            setItem(\\\"openMode\\\", input);\\n            updateItem(ids, {\\n                title: \\\"è®¾ç½®|\\\" + input\\n            });\\n            if (input == \\\"å®˜æ–¹APP\\\") {\\n                return \\\"toast://ä¿®æ”¹æˆåŠŸï¼Œè¯·ç¡®ä¿æ‰‹æœºæœ‰å®‰è£…é˜¿é‡Œäº‘ç›˜ç­‰å®˜æ–¹APP\\\";\\n            }\\n        }, id + \\\"mode\\\"),\\n        col_type: \\\"icon_3_round_fill\\\",\\n        pic_url: \\\"hiker://images/icon_menu6\\\",\\n        extra: {\\n            id: id + \\\"mode\\\"\\n        }\\n    });\\n\\n    d.push({\\n        title: 'æœç´¢',\\n        desc: 'è¯·è¾“å…¥å…³é”®è¯/é“¾æ¥',\\n        col_type: 'input',\\n        url: $.toString(() => {\\n            input = input.trim();\\n            if ($.require(\\\"alitest\\\").test(input)) {\\n                clearMyVar(\\\"s\\\");\\n                return \\\"hiker://page/aliyun?page=fypage&realurl=\\\" + encodeURIComponent(input) + \\\"&sharePwd=\\\";\\n            }\\n            putMyVar(\\\"s\\\", input);\\n            refreshPage();\\n            return \\\"hiker://empty\\\";\\n        }),\\n        extra: {\\n            onChange: \\\"putMyVar('refs',input)\\\",\\n            id: id + \\\"ss\\\",\\n            defaultValue: s,\\n            pageTitle: \\\"æ‰“å¼€é“¾æ¥\\\"\\n        }\\n    });\\n}\\n\\nfunction setRuleItem() {\\n    let rules = $.require(\\\"data\\\").getNames(ruleGroup);\\n    d.push({\\n        title: \\\"ğŸŒŸ\\\",\\n        url: \\\"hiker://collection?rule=\\\" + MY_RULE.title,\\n        col_type: \\\"scroll_button\\\",\\n    }, {\\n        title: \\\"ğŸ“Œ\\\" + ruleGroup,\\n        url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n            let group = $.require(\\\"data\\\").getGroupNames();\\n            let ruleGroup = getItem(\\\"ruleGroup\\\", \\\"\\\");\\n            let index = group.indexOf(ruleGroup) + 1;\\n            group.unshift(\\\"ğŸ’¡å…¨éƒ¨ğŸ’¡\\\");\\n            let selectNum = $.require(\\\"data\\\").findModulo(group.length);\\n            return $(group, selectNum, \\\"è¯·é€‰æ‹©åˆ†ç»„\\\", index).select(() => {\\n                if (!MY_INDEX) {\\n                    setItem(\\\"ruleGroup\\\", \\\"\\\");\\n                } else {\\n                    setItem(\\\"ruleGroup\\\", input);\\n                }\\n                clearItem(\\\"rule\\\");\\n                refreshPage();\\n            });\\n        }),\\n        col_type: \\\"scroll_button\\\"\\n    }, {\\n        title: \\\"\\\" == r ? \\\"â€œâ€œå…¨éƒ¨â€â€\\\" : \\\"å…¨éƒ¨\\\",\\n        url: $(\\\"#noLoading#\\\").lazyRule((s, id) => {\\n            let qr = getItem(\\\"rule\\\", \\\"\\\");\\n            clearItem(\\\"rule\\\");\\n            if (s) {\\n                refreshPage();\\n            } else {\\n                updateItem(\\\"å…¨éƒ¨\\\" + id, {\\n                    title: \\\"â€œâ€œå…¨éƒ¨â€â€\\\"\\n                });\\n                if (qr) {\\n                    updateItem(id + qr, {\\n                        title: qr\\n                    });\\n                }\\n            }\\n            return \\\"hiker://empty\\\";\\n        }, s, id),\\n        col_type: \\\"scroll_button\\\",\\n        extra: {\\n            id: \\\"å…¨éƒ¨\\\" + id\\n        }\\n    });\\n    for (let [it, basicUrl] of rules) {\\n        d.push({\\n            title: it == r ? \\\"â€œâ€œ\\\" + it + \\\"â€â€\\\" : it,\\n            url: $((getHome(basicUrl) || \\\"\\\") + \\\"#noLoading#\\\").lazyRule((r, s, id) => {\\n                let qr = getItem(\\\"rule\\\", \\\"\\\");\\n                setItem(\\\"rule\\\", r);\\n                if (s) {\\n                    refreshPage();\\n                } else {\\n                    updateItem(qr ? (id + qr) : (\\\"å…¨éƒ¨\\\" + id), {\\n                        title: qr || \\\"å…¨éƒ¨\\\"\\n                    });\\n                    updateItem(id + r, {\\n                        title: \\\"â€œâ€œ\\\" + r + \\\"â€â€\\\"\\n                    });\\n                }\\n                return \\\"hiker://empty\\\";\\n            }, it, s, id),\\n            col_type: \\\"scroll_button\\\",\\n            extra: {\\n                id: id + it\\n            }\\n        });\\n    }\\n\\n}\\n\\nfunction record() {\\n    let history = storage0.getItem(\\\"searchHistory\\\", []);\\n    let ii = history.indexOf(s);\\n    if (ii > -1) {\\n        history.splice(ii, 1);\\n    }\\n    if (history.length > 20) {\\n        history.splice(history.length - 1, 1);\\n    }\\n    history.unshift(s);\\n    storage0.setItem(\\\"searchHistory\\\", history);\\n}\\n\\nfunction searchEnd() {\\n    let p = MY_PAGE;\\n    let data = $.require(\\\"data\\\").getData(p, r, ruleGroup);\\n    let pageid = id + \\\"ypj-page\\\" + p;\\n    if (data.length > 0) {\\n        d.push({\\n            title: \\\"åŠ è½½ç¬¬\\\" + p + \\\"é¡µä¸­ï¼Œè¿›åº¦ï¼š1/\\\" + data.length,\\n            col_type: \\\"text_center_1\\\",\\n            extra: {\\n                id: pageid\\n            }\\n        });\\n    }\\n    setResult(d);\\n    if (data.length > 0) {\\n        //å¤šçº¿ç¨‹åŠ è½½        \\n        let realPage = \\\"\\\" == r ? 1 : p;\\n        let tasks = data.map(it => {\\n            return {\\n                func: function(rule) {\\n                    try {\\n                        return $.require(\\\"data\\\").carryRule(rule, s, realPage, searchMode);\\n                    } catch (e) {\\n                        log(rule.name + \\\":\\\" + e.toString());\\n                        /*if(data.length===1&&p===1){\\n                            return [{\\n                                title:\\\"â€œâ€œ\\\"+rule.name+\\\" ERRORâ€â€\\\",\\n                                desc: e.toString(),\\n                                col_type:\\\"text_center_1\\\",\\n                                url:\\\"hiker://empty\\\",\\n                                extra:{\\n                                    lineVisible: false\\n                                }\\n                            }];\\n                        }*/\\n                    }\\n                    //return rule.find(s, realPage);\\n                },\\n                param: it,\\n                id: \\\"rule@\\\" + it.name\\n            }\\n        });\\n\\n        batchExecute(tasks, {\\n            func: function(param, id, error, result) {\\n                param.i += 1;\\n                if (Array.isArray(result)) {\\n                    deleteItem(\\\"_nothave\\\");\\n                    addItemBefore(pageid, result);\\n                }\\n                if (param.i === param.all) {\\n                    if (!result || !result.length) {\\n                        deleteItem(\\\"_nothave\\\");\\n                        addItemBefore(pageid, {\\n                            col_type: \\\"text_center_1\\\",\\n                            url: \\\"hiker://empty\\\",\\n                            title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~ä»€ä¹ˆèµ„æºéƒ½æ²¡æœ‰å“¦~~~\\\".fontcolor(\\\"Gray\\\"),\\n                            extra: {\\n                                lineVisible: false,\\n                                id: \\\"_nothave\\\"\\n                            }\\n                        });\\n                    }\\n                    deleteItem(pageid);\\n                } else {\\n                    updateItem(pageid, {\\n                        title: \\\"åŠ è½½ç¬¬\\\" + MY_PAGE + \\\"é¡µä¸­ï¼Œè¿›åº¦ï¼š\\\" + (param.i + 1) + \\\"/\\\" + param.all,\\n                        col_type: \\\"text_center_1\\\",\\n                        url: \\\"hiker://empty\\\"\\n                    });\\n                }\\n            },\\n            param: {\\n                all: data.length,\\n                i: 0,\\n            }\\n        })\\n    }\\n}\\n\\nfunction setHistory() {\\n    d.push({\\n        title: '<span style=\\\"color:#ff6601\\\"><b>å†å²è®°å½•</b></span>',\\n        pic_url: \\\"hiker://images/icon_clock\\\",\\n        col_type: \\\"avatar\\\",\\n        url: $([\\\"æ¸…é™¤æœç´¢è®°å½•\\\", \\\"æ‰“å¼€è§‚çœ‹è®°å½•\\\"]).select((id) => {\\n            if (input === \\\"æ¸…é™¤æœç´¢è®°å½•\\\") {\\n                return $(\\\"ç¡®å®šæ¸…é™¤å…¨éƒ¨æœç´¢è®°å½•ï¼Ÿ\\\").confirm((id) => {\\n                    clearItem(\\\"searchHistory\\\");\\n                    deleteItemByCls(id + \\\":key\\\");\\n                    addItemAfter(id + \\\":searchHistory\\\", {\\n                        col_type: \\\"text_center_1\\\",\\n                        url: \\\"hiker://empty\\\",\\n                        title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰å“¦~~~\\\".fontcolor(\\\"Gray\\\"),\\n                        extra: {\\n                            cls: id + \\\":key\\\",\\n                            lineVisible: false\\n                        }\\n                    });\\n                }, id);\\n            } else {\\n                return \\\"hiker://history?rule=\\\" + MY_RULE.title;\\n            }\\n        }, id),\\n        extra: {\\n            id: id + \\\":searchHistory\\\",\\n        }\\n    });\\n\\n    let history = storage0.getItem(\\\"searchHistory\\\", []);\\n    let i = 0;\\n    for (let key of history) {\\n        d.push({\\n            title: key,\\n            url: $(\\\"#noLoading#\\\").lazyRule((id, key) => {\\n                let extra = findItem(id + \\\"ss\\\").extra;\\n                extra.defaultValue = key;\\n                updateItem({\\n                    extra: extra\\n                });\\n                return \\\"hiker://empty\\\";\\n            }, id, key),\\n            col_type: \\\"flex_button\\\",\\n            extra: {\\n                id: id + \\\":key:\\\" + key,\\n                cls: id + \\\":key\\\",\\n                longClick: [{\\n                    title: \\\"åˆ é™¤å…³é”®è¯:\\\" + key,\\n                    js: $.toString((id, key, i) => {\\n                        let history = storage0.getItem(\\\"searchHistory\\\", []);\\n                        history.splice(i, 1);\\n                        storage0.setItem(\\\"searchHistory\\\", history);\\n                        deleteItem(id + \\\":key:\\\" + key);\\n                        //toast();\\n                    }, id, key, i)\\n                }]\\n            }\\n        });\\n        i++;\\n    }\\n    if (history.length === 0) {\\n        d.push({\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰å“¦~~~\\\".fontcolor(\\\"Gray\\\"),\\n            extra: {\\n                cls: id + \\\":key\\\",\\n                lineVisible: false\\n            }\\n        });\\n    }\\n}\\n\\nfunction setTrendingTabEnd() {\\n    let hotClass = {\\n        \\\"ç™¾åº¦\\\": {\\n            \\\"ç”µè§†å‰§\\\": \\\"teleplay\\\",\\n            \\\"ç”µå½±\\\": \\\"movie\\\"\\n        },\\n        \\\"å¤¸å…‹\\\": {\\n            \\\"ç”µè§†å‰§\\\": \\\"ç”µè§†å‰§\\\",\\n            \\\"ç”µå½±\\\": \\\"ç”µå½±\\\",\\n            \\\"åŠ¨æ¼«\\\": \\\"åŠ¨æ¼«\\\",\\n            \\\"ç»¼è‰º\\\": \\\"ç»¼è‰º\\\"\\n        }\\n    };\\n    let dataSource = Object.keys(hotClass);\\n    let selectsource = getItem(\\\"dataSource\\\", dataSource[0]);\\n    let hotkeys = Object.keys(hotClass[selectsource]);\\n    let selectkey = getItem(\\\"hotkey\\\", hotkeys[0]);\\n    let tabkey = hotClass[selectsource][selectkey];\\n\\n    d.push({\\n        title: '<span style=\\\"color:#ff6601\\\"><b>' + selectsource + selectkey + 'çƒ­æœ</b></span>',\\n        url: $(hotkeys, 1, \\\"åˆ‡æ¢çƒ­æœ\\\").select(() => {\\n            setItem(\\\"hotkey\\\", input);\\n            refreshPage(false);\\n            return \\\"toast://å·²åˆ‡æ¢ä¸º\\\" + input;\\n        }),\\n        col_type: \\\"avatar\\\",\\n        pic_url: \\\"hiker://images/icon_fire\\\",\\n        extra: {\\n            longClick: [{\\n                title: \\\"åˆ‡æ¢æ•°æ®æº\\\",\\n                js: $.toString((dataSource) => {\\n                    return $(dataSource, 1, \\\"åˆ‡æ¢æ•°æ®æº\\\").select(() => {\\n                        setItem(\\\"dataSource\\\", input);\\n                        clearItem(\\\"hotkey\\\");\\n                        refreshPage(false);\\n                        return \\\"toast://å·²åˆ‡æ¢ä¸º\\\" + input;\\n                    });\\n                }, dataSource)\\n            }]\\n        }\\n    });\\n    d.push({\\n        title: \\\"æ­£åœ¨åŠ è½½...\\\",\\n        url: \\\"hiker://empty\\\",\\n        col_type: \\\"text_center_1\\\",\\n        extra: {\\n            id: id + \\\":hotkey\\\",\\n            lineVisible: false\\n        }\\n    });\\n    setResult(d);\\n    let sd = [];\\n    let setSearchKey = name => {\\n        putMyVar('s', name);\\n        refreshPage();\\n        return 'hiker://empty'\\n    };\\n\\n    let getTitle = (i, name) => {\\n        let color;\\n        switch (i) {\\n            case 0:\\n                color = \\\"#ff3300\\\";\\n                break;\\n            case 1:\\n                color = \\\"#ff6600\\\";\\n                break;\\n            case 2:\\n                color = \\\"#ff9900\\\"\\n                break;\\n            default:\\n                color = \\\"black\\\";\\n        }\\n        return \\\"â€œâ€œâ€â€\\\" + String(i + 1).fontcolor(color) + \\\"\\\\t\\\\t\\\\t\\\" + name;\\n    }\\n    try {\\n        switch (selectsource) {\\n            case \\\"ç™¾åº¦\\\":\\n                var json = request('https://top.baidu.com/api/board?platform=wise&tab=' + tabkey + '&tag=%7B%22category%22:%22%E5%85%A8%E9%83%A8%E7%B1%BB%E5%9E%8B%22%7D', {\\n                    headers: {\\n                        'User-Agent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Mobile Safari/537.36',\\n                        'Host': 'top.baidu.com',\\n                        'Accept': 'application/json, text/plain, */*',\\n                        'Accept-Language': 'zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7',\\n                        'Accept-Encoding': 'gzip, deflate, br',\\n                        'Referer': 'https://top.baidu.com/board?tab=novel',\\n                    }\\n                });\\n                //var s = Date.now();\\n                var list = JSON.parse(json).data.cards[0].content;\\n                for (let i = 0; i < list.length; i++) {\\n                    let item = list[i];\\n                    let name = item.word + ' (' + item.show[2] + ')';\\n                    let des = item.desc;\\n                    sd.push({\\n                        title: getTitle(i, name),\\n                        url: $('#noLoading#').lazyRule(setSearchKey, item.word),\\n                        desc: des,\\n                        img: item.img,\\n                        col_type: \\\"movie_1_vertical_pic\\\"\\n                    });\\n                }\\n                break;\\n            case \\\"å¤¸å…‹\\\":\\n                var json = request(\\\"https://news.myquark.cn/v2/toplist/movie?&channel=\\\" + tabkey + \\\"&rank_type=%E6%9C%80%E7%83%AD\\\");\\n                var xmlData = (JSON.parse(json).data || \\\"\\\").replace(/title>/g, \\\"h_title>\\\").replace(/src>/g, \\\"h_src>\\\").replace(/area>/g, \\\"h_area\\\");\\n                var list = pdfa(xmlData, \\\"body&&item\\\");\\n                var getText = t => t;\\n                var trend = [\\\"ã„§\\\", \\\"â†‘\\\", \\\"â†“\\\"];\\n                //var s = Date.now();\\n                for (let i = 0; i < list.length; i++) {\\n                    let item = list[i];\\n                    let name = pdfh(item, \\\"h_title&&Text\\\");\\n                    let des = \\\"çƒ­åº¦ï¼š\\\" + pdfh(item, \\\"hot_score&&Text\\\") + \\\" \\\" + trend.at(pdfh(item, \\\"hot_trend&&Text\\\")) +\\n                        \\\"\\\\nè¯„åˆ†ï¼š\\\" + pdfh(item, \\\"score_avg&&Text\\\").replace(/^0$/, \\\"æš‚æ— è¯„åˆ†\\\") +\\n                        \\\"\\\\n\\\" + pdfh(item, \\\"year&&Text\\\") + \\\"Â·\\\" + pdfh(item, \\\"h_area&&Text\\\") + \\\"Â·\\\" + pdfh(item, \\\"category&&Text\\\").replace(\\\",\\\", \\\"Â·\\\");\\n                    sd.push({\\n                        title: getTitle(i, name),\\n                        url: $('#noLoading#').lazyRule(setSearchKey, name),\\n                        desc: des,\\n                        img: pdfh(item, \\\"h_src&&Text\\\"),\\n                        col_type: \\\"movie_1_vertical_pic\\\"\\n                    });\\n                }\\n                break;\\n        }\\n        addItemAfter(id + \\\":hotkey\\\", sd);\\n    } catch (e) {\\n        log(e.toString());\\n    } finally {\\n        deleteItem(id + \\\":hotkey\\\");\\n    }\\n}\\nlet r = getItem(\\\"rule\\\", \\\"\\\");\\nlet hideSetting = MY_PARAMS.hideSetting || getParam(\\\"hideSetting\\\", \\\"\\\") === \\\"true\\\";\\nlet s = getMyVar('s', '') || MY_PARAMS.searchTerms || decodeURIComponent(getParam(\\\"searchTerms\\\", \\\"\\\"));\\nlet searchMode = getSearchMode();\\nlet openMode = getItem(\\\"openMode\\\", \\\"æœ¬åœ°è§£æ\\\");\\nlet id = Date.now() + MY_RULE.title;\\nlet ruleGroup = getItem(\\\"ruleGroup\\\", \\\"\\\");\\nlet d = [];\\nif (MY_PAGE === 1) {\\n    setPrepose();\\n    if (!hideSetting) {\\n        setClip();\\n        setHead();\\n    }\\n    setRuleItem();\\n    if (!s) {\\n        setHistory();\\n    }\\n}\\nif (s) {\\n    record();\\n    searchEnd();\\n} else if (MY_PAGE === 1) {\\n    setTrendingTabEnd();\\n} else {\\n    setResult([]);\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"ç½‘é¡µæµè§ˆ\",\"path\":\"ysfx\",\"rule\":\"js:\\nvar d = [];\\n\\nlet openMode = getItem(\\\"openMode\\\");\\nlet rule = MY_RULE.title;\\nlet url = decodeURIComponent(getParam(\\\"webUrl\\\",\\\"\\\"));\\n\\nfunction intercept(rule, origin, openMode) {\\n    let host = origin.replace(new RegExp(\\\"http://|https://\\\"), \\\"\\\").split(\\\"/\\\")[0];\\n    let hosts = host.split(\\\".\\\");\\n    if (hosts.length > 2) {\\n        host = hosts[hosts.length - 2] + \\\".\\\" + hosts[hosts.length - 1];\\n    }\\n    if (input.startsWith(\\\"magnet\\\")) {\\n        confirm({\\n            title: \\\"æ¸©é¦¨æç¤º\\\",\\n            content: \\\"æ£€æµ‹åˆ°æ–°çš„ç£é“¾åœ°å€ï¼Œç‚¹å‡»ç¡®å®šæŒ‰é’®å³å¯æ’­æ”¾ï¼Œç‚¹å‡»å–æ¶ˆæŒ‰é’®å¯ä»¥å¤åˆ¶é“¾æ¥\\\",\\n            confirm: $.toString((mag) => {\\n                return mag;\\n            }, input),\\n            cancel: $.toString((mag) => {\\n                return \\\"copy://\\\" + mag\\n            }, input)\\n        });\\n        return true;\\n    } else if ($.require(\\\"alitest?rule=\\\"+rule).test(input) && openMode != \\\"å®˜æ–¹APP\\\") {\\n        log(input);\\n        if (input.includes('checkurl?url=') && input.includes('&urlrefer')) {\\n            input = decodeURIComponent(input.split('&urlrefer')[0].split('checkurl?url=')[1]);\\n            //log('è´´å§'+input);\\n        }\\n        return $.toString((url, rule) => {\\n            fy_bridge_app.open(JSON.stringify({\\n                title: \\\"é˜¿é‡Œäº‘ç›˜\\\",\\n                url: \\\"hiker://page/aliyun?page=fypage&realurl=\\\" + encodeURIComponent(url) + \\\"&rule=\\\" + rule,\\n            }))\\n        }, input, rule);\\n    } else if(input.includes(\\\"quark.cn/s/\\\")&&fetch(\\\"hiker://home@Quark.ç®€\\\") != \\\"null\\\"){\\n        return $.toString((url) => {\\n            fy_bridge_app.open(JSON.stringify({\\n                title: \\\"å¤¸å…‹ç½‘ç›˜\\\",\\n                url: \\\"hiker://page/quarkList?rule=Quark.ç®€&realurl=\\\" + encodeURIComponent(url) + \\\"&sharePwd=\\\",\\n            }))\\n        },input);\\n    } else if (/\\\\.(mp3|flac|m4a)$/.test(input)) {\\n        log(input);\\n        return $.toString((url, rule) => {\\n            fy_bridge_app.playVideo(url);\\n        }, input, rule);\\n    } else if (!input.includes(host) && input.startsWith(\\\"http\\\")) {\\n        log(input);\\n        return $.toString((url, rule) => {\\n            fy_bridge_app.open(JSON.stringify({\\n                title: \\\"è¯¦æƒ…\\\",\\n                url: \\\"hiker://page/ysfx?webUrl=\\\"+encodeURIComponent(url)+\\\"&rule=\\\"+rule,\\n            }))\\n        }, input, rule);\\n    } else if (!input.startsWith(\\\"http\\\")) {\\n        log(input);\\n        //èƒ½å”¤èµ·APPçš„ç™½åå•\\n        let white = [\\n            \\\"qklink\\\",\\n            \\\"bdnetdisk\\\",\\n            \\\"xunleiapp\\\",\\n            \\\"smartdrive\\\"\\n        ];\\n        let inWhite = white.filter(it => input.startsWith(it)).length > 0;\\n        if (!inWhite) {\\n            return false;\\n        }\\n        return $.toString((url, rule) => {\\n            fy_bridge_app.openThirdApp && fy_bridge_app.openThirdApp(url);\\n        }, input, rule);\\n    }\\n}\\n\\nfunction loadJs() {\\n    try {\\n        if (document.title && document.title.length) {\\n            let r = $$$().lazyRule((t) => {\\n                setPageTitle(t);\\n            }, document.title);\\n            fy_bridge_app.parseLazyRule(r);\\n        }\\n    } catch (e) {\\n        fy_bridge_app.log(e.toString());\\n    }\\n}\\n\\nd.push({\\n    url: url,\\n    col_type: \\\"x5_webview_single\\\",\\n    desc: \\\"100%&&float\\\",\\n    extra: {\\n        urlInterceptor: $.toString(intercept, rule, getHome(url), openMode),\\n        js: $.toString(loadJs),\\n        canBack: true,\\n        jsLoadingInject: true,\\n        floatVideo: true\\n    }\\n});\\n\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"é˜¿é‡ŒLazy\",\"path\":\"alilazy\",\"rule\":\"const AliAccessApi = $.require(\\\"aliPlayApi\\\");\\nconst {\\n    openTokensFilepath,\\n    aliTokensFilepath\\n} = $.require(\\\"tokenPath\\\");\\n\\nfunction aliM3u8Proxy(fileId, shareId, sharePwd, shareToken, aliToken, title) {\\n    let playmode = (MY_PARAMS.mode&&MY_PARAMS.mode[0])||\\\"\\\";\\n    let suffix = playmode ? \\\"media.m3u8\\\" : \\\"ref_task.m3u8\\\";\\n    let urlname = playmode ? \\\"url\\\" : \\\"preview_url\\\";\\n    let cacheFilePath = \\\"hiker://files/_cache/\\\" + fileId + MY_PARAMS.timestamp[0]+ \\\".m3u8\\\"\\n    //è¿‡æœŸè·å–æ’­æ”¾åŸå§‹é“¾æ¥\\n    function getAliPlayUrl(fileId, line) {\\n        let aliurl;\\n        try {\\n            const AliAccessApi = $.require(\\\"hiker://page/aliPlayApi?rule=\\\" + title);\\n            let aliAccessApi = AliAccessApi.createDefault(shareId, sharePwd, shareToken, aliToken, null, title);\\n            let playUrlList = (MY_PARAMS.mode ? aliAccessApi.getAllVideoTemPlayUrl(fileId, true).preview : aliAccessApi.getShareVideoPreview(fileId)) || [];\\n\\n            aliurl = playUrlList.find(v => v.template_id == line)[urlname];\\n        } catch (e) {\\n            log(e.toString());\\n            throw e;\\n        }\\n        return aliurl;\\n    }\\n\\n    function getM3u8Content(playurl) {\\n        //media.m3u8\\n        let home = playurl.split(suffix)[0];\\n        let f = fetch(playurl, {\\n            headers: {\\n                \\\"User-Agent\\\": PC_UA,\\n                \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n            },\\n            timeout: 3000\\n        }).split(\\\"\\\\n\\\");\\n        let ff = f.map(it => {\\n            if (it.startsWith(\\\"media-\\\")) {\\n                return \\\"/proxy?url=\\\" + base64Encode(home + it)+\\\"&timestamp=\\\"+MY_PARAMS.timestamp[0]+\\\"&mode=\\\"+playmode;\\n            }\\n            return it;\\n        }).join(\\\"\\\\n\\\");\\n\\n        writeFile(cacheFilePath, ff);\\n        return ff;\\n    }\\n\\n    function updateTsUrl(url) {\\n        let fid = url.split('&f=')[1].split('&')[0];\\n        //log('sfid-' + fid);\\n        let f = fetch(cacheFilePath).split(\\\"\\\\n\\\");\\n        f.forEach(it => {\\n            if (it && it.startsWith('/proxy?url=')) {\\n                let furl = base64Decode(it.replace('/proxy?url=', '').split(\\\"&\\\")[0]);\\n                if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\\n                    url = furl;\\n                }\\n            }\\n        })\\n        let expires = url.split('x-oss-expires=')[1].split('&')[0];\\n        const lasttime = parseInt(expires) - Date.now() / 1000;\\n        if (lasttime < 60) {\\n            //log('è¿‡æœŸæ›´æ–°')\\n            let line = url.split('/media')[0]; //å–ä¹‹å‰æ’­æ”¾çš„tsæ®µçº¿è·¯\\n            line = line.substring(line.lastIndexOf('/') + 1);\\n            let f = getM3u8Content(getAliPlayUrl(fid, line)).split(\\\"\\\\n\\\");\\n            f.forEach(it => {\\n                if (it && it.startsWith('/proxy?url=')) {\\n                    let furl = base64Decode(it.replace('/proxy?url=', ''));\\n                    if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\\n                        url = furl;\\n                    }\\n                }\\n            })\\n\\n        }\\n        return url;\\n    }\\n    try {\\n        let url = base64Decode(MY_PARAMS.url[0]);\\n        if (url.includes(\\\".ts\\\")) {\\n            return JSON.stringify({\\n                statusCode: 302,\\n                headers: {\\n                    \\\"Location\\\": updateTsUrl(url),\\n                    \\\"User-Agent\\\": PC_UA,\\n                    \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n                }\\n            });\\n        } else {\\n            let templateId = MY_PARAMS.templateId[0];\\n            if(fileExist(cacheFilePath)){\\n                return getM3u8Content(getAliPlayUrl(fileId, templateId));\\n            }else{\\n                return getM3u8Content(url);\\n            }\\n        }\\n    } catch (e) {\\n        log(\\\"#ä»£ç†æ’­æ”¾å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n    }\\n}\\nconst transcoding = {\\n    UHD: \\\"4K è¶…æ¸…\\\",\\n    QHD: \\\"2K è¶…æ¸…\\\",\\n    FHD: \\\"1080 å…¨é«˜æ¸…\\\",\\n    HD: \\\"720 é«˜æ¸…\\\",\\n    SD: \\\"540 æ ‡æ¸…\\\",\\n    LD: \\\"360 æµç•…\\\"\\n};\\n\\nfunction getVideo(aliAccessApi, fileId) {\\n\\n    let playUrlList = aliAccessApi.getShareVideoPreview(fileId) || [];\\n\\n    let serverAddress = startProxyServer($.toString(aliM3u8Proxy, fileId, aliAccessApi.shareId, aliAccessApi.sharePwd, aliAccessApi.shareToken, aliAccessApi.aliToken, MY_RULE.title));\\n\\n    if (playUrlList.length > 0) {\\n        let urls = [],\\n            names = [];\\n        playUrlList.forEach((item) => {\\n            urls.push(serverAddress + \\\"?url=\\\" + base64Encode(item.preview_url) + \\\"&timestamp=\\\"+Date.now()+\\\"&templateId=\\\" + item.template_id + \\\"#.m3u8\\\");\\n            names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\\n        });\\n        let heads = new Array(playUrlList.length).fill({\\n            'Referer': 'https://www.aliyundrive.com/'\\n        });\\n        return {\\n            urls: urls,\\n            names: names,\\n            headers: heads,\\n        };\\n    } else {\\n        return {};\\n    }\\n\\n}\\n\\nfunction getSourceTransfer(aliAccessApi, fileId) {\\n    let playUrlInfo = aliAccessApi.getAllVideoTemPlayUrl(fileId);\\n    let playUrlList = playUrlInfo.preview;\\n\\n    let serverAddress = startProxyServer($.toString(aliM3u8Proxy, fileId, aliAccessApi.shareId, aliAccessApi.sharePwd, aliAccessApi.shareToken, aliAccessApi.aliToken, MY_RULE.title));\\n    if (playUrlList.length > 0) {\\n        let urls = [],\\n            names = [];\\n        playUrlList.forEach((item) => {\\n            urls.push(serverAddress + \\\"?url=\\\" + base64Encode(item.url) + \\\"&mode=1&timestamp=\\\"+Date.now()+\\\"&templateId=\\\" + item.template_id + \\\"#.m3u8\\\");\\n            names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\\n        });\\n        urls.push(playUrlInfo.origin);\\n        names.push(\\\"åŸç”»\\\");\\n        let heads = new Array(playUrlList.length).fill({\\n            'Referer': 'https://www.aliyundrive.com/'\\n        });\\n        return {\\n            urls: urls,\\n            names: names,\\n            headers: heads,\\n        };\\n    } else {\\n        return {};\\n    }\\n}\\n\\nfunction getPlayFormat(playUrl, title) {\\n    return {\\n        names: [title],\\n        urls: [playUrl + \\\"#isVideo=true##ignoreMusic=true#\\\"],\\n        headers: [{\\n            'Referer': 'https://www.aliyundrive.com/',\\n            \\\"User-Agent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36\\\"\\n        }]\\n    };\\n}\\n\\n\\n$.exports = function(shareId, sharePwd, shareToken, fileId, cate, zimu) {\\n    if (!fileExist(aliTokensFilepath)) {\\n        toast(\\\"è¯·å…ˆç™»é™†ç™»å½•è´¦å·\\\");\\n        return \\\"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\\\";\\n    }\\n    let aliToken = $.require(aliTokensFilepath);\\n    if (cate === \\\"video\\\") {\\n        let playList = [];\\n        let aliAccessApi;\\n        let playMode = getItem(\\\"aliyun_playMode\\\", \\\"è½¬ç \\\");\\n        try {\\n            aliAccessApi = AliAccessApi.createDefault(shareId, sharePwd, shareToken, aliToken);\\n            if (playMode === \\\"è½¬ç \\\") {\\n                playList = getVideo(aliAccessApi, fileId) || {};\\n            } else if (playMode === \\\"åŸç”»\\\") {\\n                playList = getPlayFormat(aliAccessApi.getVideoTemPlayUrl(fileId), playMode);\\n            } else if (playMode === \\\"æé€ŸåŸç”»\\\") {\\n                playList = getPlayFormat(aliAccessApi.getVideoTemPlayUrl(fileId) + \\\"#fastPlayMode##threads=\\\" + getItem(\\\"speedThread\\\", \\\"10\\\") + \\\"#\\\", playMode);\\n            } else if (playMode === \\\"åŸè½¬\\\") {\\n                playList = getSourceTransfer(aliAccessApi, fileId);\\n            }\\n        } catch (e) {\\n            log(\\\"#\\\" + playMode + \\\"æ’­æ”¾å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n            if (e.code === \\\"InvalidParameter.RefreshToken\\\") {\\n                toast(\\\"ç™»é™†è¿‡æœŸï¼Œè¯·é‡æ–°ç™»é™†\\\");\\n                return \\\"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\\\";\\n            } else if (e.code === \\\"QuotaExhausted.Drive\\\") {\\n                return \\\"toast://ç½‘ç›˜ç©ºé—´ä¸è¶³ï¼Œæ— æ³•æ’­æ”¾è¯·æ¸…ç†ã€‚\\\";\\n            }\\n            return \\\"toast://æ’­æ”¾å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å·²æ‰“å°ã€‚\\\\nè¯·æŸ¥çœ‹æ—¥å¿—(LOG)\\\";\\n        }\\n        let mountsub = storage0.getMyVar('mountzimu', {});\\n        if (Object.keys(mountsub).length > 0) {\\n            zimu = mountsub;\\n        }\\n        let subtitle;\\n        if (Object.keys(zimu || {}).length > 0 && playList && playList.urls && playList.urls.length > 0) {\\n            java.lang.Thread.sleep(100);\\n            try {\\n                var zmurl = aliAccessApi.getVideoTemPlayUrl(zimu.file_id);\\n                let path = 'hiker://files/cache/äº‘ç›˜å›/sub.' + zimu.ext;\\n                downloadFile(zmurl, path, {\\n                    'Referer': 'https://www.aliyundrive.com/'\\n                });\\n                subtitle = getPath(path);\\n            } catch (e) {\\n                toast(\\\"å­—å¹•åŠ è½½å¤±è´¥\\\");\\n                log(e.message);\\n            }\\n        }\\n        let dmlist = storage0.getMyVar(\\\"dmlist\\\", []);\\n        let dmlist_cache = getMyVar(\\\"dmlist_cache\\\", \\\"\\\");\\n        if (dmlist_cache && dmlist_cache.startsWith(fileId + \\\"#\\\")) {\\n            playList.danmu = dmlist_cache.replace(fileId + \\\"#\\\", \\\"\\\");\\n        } else if (dmlist.length > 0) {\\n            playList.danmu = \\\"hiker://files/cache/danmu/\\\" + dmlist.splice(0, 1)[0];\\n            putMyVar(\\\"dmlist_cache\\\", fileId + \\\"#\\\" + playList.danmu);\\n            storage0.putMyVar(\\\"dmlist\\\", dmlist);\\n            if (dmlist.length === 0) {\\n                toast(\\\"å¼¹å¹•åˆ—è¡¨å·²å…¨éƒ¨æŒ‚è½½\\\");\\n            }\\n        } /*else {\\n            playList.danmu = getVar(\\\"dm_share\\\", \\\"\\\");\\n        }*/\\n        playList.subtitle = subtitle;\\n        return JSON.stringify(playList);\\n    }\\n\\n    let aliAccessApi = AliAccessApi.createDefault(shareId, sharePwd, shareToken, aliToken, null);\\n    let url = aliAccessApi.getVideoTemPlayUrl(fileId);\\n\\n    if (cate === \\\"image\\\") {\\n        return url + \\\"#.jpg\\\";\\n    } else if (cate === \\\"audio\\\") {\\n        return url + \\\"#isMusic=true#\\\";\\n    } else {\\n        return \\\"download://\\\" + url;\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"é˜¿é‡Œåˆ—è¡¨\",\"path\":\"aliyun\",\"rule\":\"js:\\n//@author LoyDgIk\\nconst AliShareApi = $.require(\\\"AliApi\\\");\\n\\n\\nlet openAPIList = [\\\"alist\\\", \\\"drive\\\", \\\"tvbox\\\", \\\"XBY\\\", \\\"TV\\\"];\\n\\nlet realurl = decodeURIComponent(getParam(\\\"realurl\\\", \\\"\\\")).split(\\\"?\\\")[0];\\nlet urlData = realurl.split(\\\"/\\\");\\n//https://www.aliyundrive.com/s/{shareId}/folder/{fileId}?;\\n\\nlet shareId = MY_PARAMS.shareId || urlData[4];\\nlet sharePwd = getParam(\\\"sharePwd\\\", MY_PARAMS.sharePwd || \\\"\\\");\\nlet shareToken = getParam(\\\"shareToken\\\", MY_PARAMS.shareToken);\\n\\nlet fileId = (urlData[5] === \\\"folder\\\" ? urlData[6] : void 0) || MY_PARAMS.fileId;\\nlet searchKey = decodeURIComponent(getParam(\\\"searchKey\\\", \\\"\\\")) || undefined;\\nlet isSearch = !!searchKey;\\n\\nlet pageId = String(Date.now()).slice(6);\\n\\nlet skipFile = isSearch && getItem(\\\"skipFile\\\", \\\"0\\\") === \\\"1\\\";\\n\\nfunction formatDate(_date, fmt) {\\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\\n    return $.dateFormat(date, fmt || \\\"yyyy-MM-dd HH:mm:ss\\\")\\n}\\n\\nfunction formatSize(size) {\\n    if (!size) {\\n        return '';\\n    }\\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\\n    let i = 0;\\n    while (size >= 1024) {\\n        size /= 1024;\\n        i++;\\n    }\\n    size = i ? Number(size.toFixed(2)) : size;\\n    return `${size} ${units[i]}`;\\n}\\n\\nfunction setMyPaCache(key, value) {\\n    MY_PARAMS[key] = value;\\n}\\n\\nfunction saveMyPaCache() {\\n    setPageParams(MY_PARAMS);\\n}\\n\\nfunction setMarker(marker) {\\n    setMyPaCache(\\\"marker\\\", marker);\\n}\\n\\nfunction setToken(shareToken) {\\n    setMyPaCache(\\\"shareToken\\\", shareToken);\\n}\\nif (MY_PARAMS.noPic) {\\n    setPagePicUrl();\\n    setMyPaCache(\\\"noPic\\\", false);\\n}\\n/*\\nfunction setVideoItemCache(videoItemCache) {\\n    setMyPaCache(\\\"videoItemCache\\\", videoItemCache);\\n}\\n\\nfunction setSubtitleCache(subtitleCache) {\\n    setMyPaCache(\\\"subtitleCache\\\", subtitleCache);\\n}*/\\n\\nlet iconType = \\\"ai|apk|avi|css|dmg|exe|flv|gif|hiker|html|iso|jpg|js|json|log|mov|mp3|mp4|otf|php|png|ppt|psd|table|txt|wav|xls|zip|css|doc|epub|exc|htm|xlsx\\\".split('|');\\n\\nfunction getIcon(ext, type) {\\n    let root = \\\"https://gitcode.net/qq_32394351/dr/-/raw/master/img/æ–‡ä»¶ç±»å‹2/\\\";\\n    if (type === \\\"folder\\\") {\\n        return root + \\\"æ–‡ä»¶å¤¹.svg\\\";\\n    }\\n    if (iconType.includes((ext || \\\"\\\").toLowerCase())) {\\n        return root + ext + \\\".svg\\\";\\n    }\\n    return root + \\\"æ–‡ä»¶.svg\\\";\\n\\n}\\n\\nfunction load(items) {\\n    let aliShareApi = new AliShareApi(shareId, sharePwd, shareToken, (shareToken) => {\\n        setToken(shareToken);\\n        MY_PARAMS.shareToken = shareToken;\\n    });\\n    let orders = {\\n        \\\"åç§°æ­£åº\\\": \\\"name#ASC\\\",\\n        \\\"åç§°å€’åº\\\": \\\"name#DESC\\\",\\n        \\\"æ—¶é—´æ­£åº\\\": \\\"updated_at#ASC\\\",\\n        \\\"æ—¶é—´å€’åº\\\": \\\"updated_at#DESC\\\",\\n        \\\"å¤§å°æ­£åº\\\": \\\"size#ASC\\\",\\n        \\\"å¤§å°å€’åº\\\": \\\"size#DESC\\\"\\n    };\\n    let playMode = getItem(\\\"aliyun_playMode\\\", \\\"è½¬ç \\\");\\n    let ordersKeys = Object.keys(orders);\\n    let orderName = getItem(\\\"aliyun_order\\\", ordersKeys[0]);\\n    let order = orders[orderName].split(\\\"#\\\");\\n    let styles = [\\\"text_1\\\", \\\"movie_2\\\", \\\"card_pic_3\\\", \\\"avatar\\\", \\\"è¿½å‰§\\\", \\\"çœ‹å›¾\\\"];\\n    let style = getItem(\\\"aliyun_style\\\", styles[0]);\\n    if (MY_PAGE === 1) {\\n        if (!getMyVar(\\\"mountzimu\\\", \\\"\\\")) {\\n            storage0.putMyVar(\\\"mountzimu\\\", {});\\n            addListener(\\\"onClose\\\", $.toString(() => {\\n                clearMyVar(\\\"mountzimu\\\");\\n                clearMyVar(\\\"aliShareToken\\\");\\n                clearVar(\\\"dm_share\\\");\\n                clearMyVar(\\\"dmlist\\\");\\n                clearMyVar(\\\"listSearchKey\\\");\\n                clearMyVar(\\\"dm_listUrlList\\\");\\n            }));\\n        }\\n        setMarker();\\n        if (realurl && !isSearch) {\\n            let shareInfo = aliShareApi.getShareInfo();\\n            let fileInfo = shareInfo.file_infos || [];\\n            if (fileInfo.length === 1 && fileInfo[0].type === \\\"folder\\\" && !fileId) {\\n                fileId = fileInfo[0].file_id;\\n                setMyPaCache(\\\"fileId\\\", fileId);\\n                setPageTitle(fileInfo[0].file_name);\\n            } else {\\n                setPageTitle(shareInfo.share_name);\\n            }\\n            let deadline = \\\"æ°¸ä¹…æœ‰æ•ˆ\\\";\\n\\n            if (shareInfo.expiration) {\\n                deadline = \\\"æœ‰æ•ˆè‡³ï¼š\\\" + formatDate(shareInfo.expiration);\\n                //shareInfo.updated_at\\n            }\\n            items.push({\\n                title: (shareInfo.creator_name || shareInfo.creator_phone) + \\\"&nbsp;&nbsp;\\\" + deadline.small(),\\n                url: realurl + \\\"#noHistory#\\\",\\n                img: shareInfo.avatar || \\\"hiker://images/icon_unknown\\\",\\n                col_type: \\\"avatar\\\"\\n            });\\n        }\\n        if (!isSearch) {\\n            items.push({\\n                title: \\\"æœç´¢\\\",\\n                url: $.toString(() => {\\n                    input = input.trim();\\n                    if (!input) return \\\"toast://è¯·è¾“å…¥å…³é”®è¯\\\";\\n                    return \\\"hiker://page/aliyun#noHistory##fullTheme#?page=fypage&searchKey=\\\" + encodeURIComponent(input);\\n                }),\\n                col_type: \\\"input\\\",\\n                extra: {\\n                    onChange: \\\"putMyVar('listSearchKey',input)\\\",\\n                    sharePwd: sharePwd,\\n                    shareId: shareId,\\n                    shareToken: shareToken\\n                }\\n            });\\n        } else {\\n            items.push({\\n                title: \\\"â€œâ€œ\\\" + searchKey + \\\"â€â€çš„æœç´¢ç»“æœ\\\",\\n                url: \\\"hiker://empty\\\",\\n                col_type: \\\"text_center_1\\\",\\n                extra: {\\n                    lineVisible: false\\n                }\\n            });\\n        }\\n        let funcItems = [];\\n        funcItems.push({\\n            title: style,\\n            url: $(styles, 1, \\\"æ’å¸ƒæ ·å¼\\\").select(() => {\\n                setItem(\\\"aliyun_style\\\", input);\\n                refreshPage();\\n                return \\\"toast://å·²åˆ‡æ¢\\\";\\n            }),\\n            pic_url: \\\"http://123.56.105.145/img/ali_icon.svg\\\"\\n        }, {\\n            title: orderName,\\n            url: $(ordersKeys, 2, \\\"æ’åºæ–¹å¼\\\").select(() => {\\n                setItem(\\\"aliyun_order\\\", input);\\n                refreshPage();\\n                return \\\"toast://åˆ‡æ¢æˆåŠŸ\\\";\\n            }),\\n            pic_url: \\\"http://123.56.105.145/img/ali_sort.svg\\\"\\n        }, {\\n            title: playMode,\\n            url: $([\\\"è½¬ç \\\", \\\"åŸç”»\\\", \\\"åŸè½¬\\\", \\\"æé€ŸåŸç”»\\\"], 1, \\\"æ’­æ”¾æ¨¡å¼\\\").select(() => {\\n                setItem(\\\"aliyun_playMode\\\", input);\\n                refreshPage();\\n                return \\\"toast://åˆ‡æ¢æˆåŠŸ\\\";\\n            }),\\n            pic_url: \\\"http://123.56.105.145/img/ali_play.svg\\\",\\n        });\\n        if ([\\\"åŸè½¬\\\",\\\"åŸç”»\\\",\\\"æé€ŸåŸç”»\\\"].includes(playMode)) {\\n            funcItems.push({\\n                title: openAPIList[getItem(\\\"openApiMode\\\", \\\"0\\\")],\\n                url: $(openAPIList, 1, \\\"åŸç”»API(ä¸è¦é¢‘ç¹åˆ‡æ¢)\\\").select((openAPIList) => {\\n                    setItem(\\\"openApiMode\\\", String(openAPIList.indexOf(input)));\\n                    deleteFile($.require(\\\"tokenPath\\\").openTokensFilepath);\\n                    refreshPage(false);\\n                    return \\\"toast://å·²åˆ‡æ¢ä¸º\\\" + input;\\n                }, openAPIList),\\n                pic_url: \\\"http://123.56.105.145/img/ali_api.svg\\\",\\n            });\\n        }\\n        if (!isSearch) {\\n            funcItems.push({\\n                title: \\\"åŠŸèƒ½\\\",\\n                url: $([\\\"è½¬å­˜äº‘ç›˜\\\", \\\"ç™»é™†è´¦å·\\\", \\\"å¤åˆ¶åˆ†äº«é“¾æ¥\\\", \\\"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\", \\\"è·å–å¼¹å¹•æœç´¢è§„åˆ™\\\", \\\"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\\\", \\\"æ¨é€åˆ°TVBox\\\", \\\"è®¾ç½®æ”¶è—å°é¢\\\", \\\"è·å–æŠ•å±IP\\\" , \\\"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\\\" , \\\"è½¬å­˜å½“å‰æ–‡ä»¶å¤¹\\\"], 2, \\\"æ›´å¤šåŠŸèƒ½\\\").select((shareId, sharePwd, fileId) => {\\n                    switch (input) {\\n                        case \\\"è½¬å­˜äº‘ç›˜\\\":\\n                            return `smartdrive://share/browse?shareId=${shareId}&sharePwd=${sharePwd||\\\"\\\"}`;\\n                        case \\\"ç™»é™†è´¦å·\\\":\\n                            return \\\"hiker://page/login#noRecordHistory##noHistory#\\\";\\n                        case \\\"å¤åˆ¶åˆ†äº«é“¾æ¥\\\":\\n                            return $([\\\"å¤åˆ¶é“¾æ¥\\\", \\\"å¤åˆ¶æµ·é˜”å£ä»¤\\\"], 1, \\\"åˆ†äº«æ–¹å¼\\\").select((url) => {\\n                                if (input === \\\"å¤åˆ¶é“¾æ¥\\\") {\\n                                    return \\\"copy://\\\" + url;\\n                                } else {\\n                                    return \\\"copy://é˜¿é‡Œäº‘ç›˜åˆ†äº«å£ä»¤ã€Œ\\\" + getPageTitle() + \\\"ã€\\\\n\\\" + url + \\\" @import=js:`hiker://page/aliyun?realurl=${input.trim()}&rule=\\\" + MY_RULE.title + \\\"`;\\\";\\n                                }\\n                            }, \\\"https://www.aliyundrive.com/s/\\\" + shareId + (fileId ? \\\"/folder/\\\" + fileId : \\\"\\\"));\\n                        case \\\"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\\\":\\n                            return \\\"hiker://page/dmMount#noHistory##noRecordHistory#\\\";\\n                        case \\\"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\":\\n                            let zm = storage0.getMyVar(\\\"mountzimu\\\", {});\\n                            let tip = zm.name ? \\\"å½“å‰å­—å¹•æ–‡ä»¶\\\\n\\\" + zm.name + \\\".\\\" + zm.ext : \\\"è¿˜æœªæ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\";\\n                            confirm({\\n                                title: 'æ‰‹åŠ¨æŒ‚è½½å­—å¹•',\\n                                content: tip + \\\"\\\\n(ç‚¹å‡»å–æ¶ˆå¯ä»¥æ¸…é™¤æŒ‚è½½å­—å¹•)\\\",\\n                                cancel: () => {\\n                                    clearMyVar(\\\"mountzimu\\\");\\n                                    return \\\"toast://å·²æ¸…é™¤æ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\";\\n                                }\\n                            });\\n                            return;\\n                        case \\\"è·å–å¼¹å¹•æœç´¢è§„åˆ™\\\":\\n                            let rule = {\\n                                \\\"js\\\": JSON.stringify(\\\"hiker://page/loadDm?rule=\\\" + MY_RULE.title + \\\"&title=\\\") + \\\"+encodeURIComponent(playdata.title.split('-')[0]);\\\",\\n                                \\\"name\\\": MY_RULE.title + \\\"å¼¹å¹•æœç´¢\\\"\\n                            };\\n                            return \\\"rule://\\\" + base64Encode(\\\"ï¿¥projection_screenï¿¥\\\" + JSON.stringify(rule));\\n                        case \\\"æ¨é€åˆ°TVBox\\\":\\n                            return \\\"hiker://page/tvboxPush#noHistory##noRecordHistory#\\\";\\n                        case \\\"è®¾ç½®æ”¶è—å°é¢\\\":\\n                            return $([\\\"è®¾ç½®å°é¢åœ°å€\\\", \\\"æœç´¢å°é¢\\\"], 1).select(() => {\\n                                if (input === \\\"è®¾ç½®å°é¢åœ°å€\\\") {\\n                                    return $(\\\"\\\", \\\"è¯·è¾“å…¥å›¾ç‰‡åœ°å€\\\").input(() => {\\n                                        input = input.trim();\\n                                        if (!input) return \\\"toast://è¯·è¾“å…¥åœ°å€\\\";\\n                                        setPagePicUrl(input);\\n                                        return \\\"toast://ä¿®æ”¹æˆåŠŸ\\\";\\n                                    });\\n                                } else {\\n                                    return \\\"hiker://page/frontCover#noHistory##noRecordHistory#\\\";\\n                                }\\n                            });\\n                        case \\\"è·å–æŠ•å±IP\\\":\\n                            let ip = $.require(\\\"aliUtil\\\").getIPv4Address();\\n                            if (ip.startsWith(\\\"192.168.\\\")) {\\n                                return $(ip + \\\"\\\\nè¯¥IPé€‚ç”¨äºæµé‡+çƒ­ç‚¹çš„æŠ•å±\\\\nè¯·æ›¿æ¢é“¾æ¥ä¸­çš„0.0.0.0\\\").confirm((ip) => {\\n                                    return \\\"copy://\\\" + ip;\\n                                }, ip);\\n                            } else {\\n                                return $(ip + \\\"\\\\nè·å–å¤±è´¥éç¨³å®šIP,è¯·å¼€å¯çƒ­ç‚¹å†ä½¿ç”¨,è¯¥IPå¯èƒ½ä¼šå˜,ä¸èƒ½æŠ•å±\\\").confirm(() => {});\\n                            }\\n                        case \\\"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\\\":\\n                            return $(getItem(\\\"speedThread\\\", \\\"10\\\"), \\\"è¯·è¾“å…¥3-32ä¹‹é—´çš„æ•´æ•°\\\").input(() => {\\n                                let speedThread = parseInt(input);\\n                                if (speedThread < 3 || speedThread > 32) {\\n                                    return \\\"toast://è®¾ç½®ä¸åˆæ³•\\\";\\n                                }\\n                                setItem(\\\"speedThread\\\", String(speedThread));\\n                                return \\\"toast://è®¾ç½®æˆåŠŸ\\\";\\n                            });\\n                        case \\\"è½¬å­˜å½“å‰æ–‡ä»¶å¤¹\\\":\\n                            return \\\"hiker://page/myaliyun#noHistory##noRecordHistory#?page=fypage\\\";\\n                    }\\n                }, shareId, sharePwd, fileId),\\n                pic_url: \\\"http://123.56.105.145/img/ali_fileinto.svg\\\",\\n                extra: {\\n                    pageId: pageId,\\n                    fileId: fileId,\\n                    shareId: shareId,\\n                    shareToken: shareToken,\\n                    sharePwd: sharePwd,\\n                    transfer: true,\\n                    folderName: getPageTitle()\\n                }\\n            });\\n        } else {\\n            funcItems.push({\\n                title: [\\\"ALL\\\", \\\"è·³è¿‡æ–‡ä»¶\\\"][Number(skipFile)],\\n                url: $(\\\"#noLoading#\\\").lazyRule((skipFile) => {\\n                    setItem(\\\"skipFile\\\", String(skipFile ? \\\"0\\\" : \\\"1\\\"));\\n                    refreshPage(false);\\n                    return \\\"hiker://empty\\\";\\n                }, skipFile),\\n                pic_url: \\\"hiker://images/icon_search6\\\",\\n            });\\n        }\\n        let funStyle = [\\\"\\\", \\\"\\\", \\\"\\\", \\\"icon_small_3\\\", \\\"icon_round_small_4\\\", \\\"icon_5\\\"][funcItems.length];\\n        items.push.apply(items, funcItems.map(v => (v.col_type = funStyle) && v));\\n        items.push({\\n            col_type: \\\"line_blank\\\"\\n        });\\n    }\\n    let rescod = {};\\n    let marker = MY_PARAMS.marker;\\n    if (isSearch) {\\n        rescod = aliShareApi.getSearchListFile(searchKey, marker, order[0], order[1]);\\n    } else {\\n        rescod = aliShareApi.getListFile(fileId, marker, order[0], order[1]);\\n    }\\n    if (rescod.next_marker) {\\n        setMarker(rescod.next_marker);\\n    } else {\\n        setMarker();\\n    }\\n\\n    var conts = rescod.items;\\n    //å­—å¹•åŒ¹é…å‡†å¤‡\\n    let subExts = [\\\"vtt\\\", \\\"srt\\\", \\\"ass\\\"];\\n    var zimulist = [];\\n    conts.forEach((item) => {\\n        if (subExts.includes(item.file_extension && item.file_extension.toLowerCase())) {\\n            let name = item.name.replace('.' + item.file_extension, '');\\n            zimulist.push({\\n                ext: item.file_extension,\\n                file_id: item.file_id,\\n                name: name\\n            });\\n        }\\n    });\\n    //å¤„ç†å¤¸é¡µåŒ¹é…å­—å¹•\\n    /*\\n    let hasSub = zimulist.length > 0;\\n    if (hasSub&&rescod.next_marker) {\\n        if (zimulist.length > 4) {\\n            setSubtitleCache(zimulist.slice(-4));\\n        } else {\\n            setSubtitleCache(zimulist);\\n        }\\n    }\\n    let lastItem = conts.at(-1);\\n    if (hasSub&&lastItem&&lastItem.category === \\\"video\\\") {\\n        setVideoItemCache(conts.splice(conts.length-1,1));\\n    }\\n    if (MY_PAGE > 1) {\\n        let subtitleCache = MY_PARAMS.subtitleCache || [];\\n        zimulist = zimulist.concat(subtitleCache);\\n        let videoItemCache = MY_PARAMS.videoItemCache || [];\\n        conts = videoItemCache.concat(conts);\\n        setSubtitleCache();\\n        setVideoItemCache();\\n    }*/\\n    //ç®€ä½“ä¼˜å…ˆ\\n    zimulist.sort((a, b) => (b.name.endsWith(\\\".sc\\\") || b.name.endsWith(\\\".chs\\\")) - (a.name.endsWith(\\\".sc\\\") || a.name.endsWith(\\\".chs\\\")));\\n    //end\\n    let titleHead = {\\n        video: \\\"ğŸ¬\\\",\\n        audio: \\\"ğŸµ\\\",\\n        doc: \\\"ğŸ“‘\\\",\\n        image: \\\"ğŸ–¼\\\",\\n        zip: \\\"ğŸ“¦\\\",\\n        folder: \\\"ğŸ“‚\\\"\\n    };\\n\\n    function getHead(type, ext) {\\n        let head = titleHead[type];\\n        if (subExts.includes(ext)) {\\n            head = \\\"ğŸ•¸\\\";\\n        }\\n        return head || \\\"â“\\\";\\n    }\\n\\n    function getPreviewPic(fileItem) {\\n        if (fileItem.thumbnail) {\\n            return $(\\\"https://empty?\\\" + fileItem.file_id).image((pic) => {\\n                try {\\n                    return fetch(pic, {\\n                        inputStream: true\\n                    });\\n                } catch (e) {\\n                    return null;\\n                }\\n            }, fileItem.thumbnail);\\n        }\\n    }\\n    let folderStyle, fileStyle;\\n    let filterType = [];\\n    if (style === \\\"è¿½å‰§\\\") {\\n        folderStyle = \\\"avatar\\\";\\n        fileStyle = \\\"movie_2\\\";\\n        filterType.push(\\\"video\\\");\\n        items.push({\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"è¿½å‰§æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œè§†é¢‘\\\".small().fontcolor(\\\"grey\\\"),\\n            url: \\\"hiker://empty\\\",\\n            col_type: \\\"text_center_1\\\",\\n            extra: {\\n                lineVisible: false\\n            }\\n        });\\n    } else if (style === \\\"çœ‹å›¾\\\") {\\n        folderStyle = \\\"avatar\\\";\\n        fileStyle = \\\"card_pic_3\\\";\\n        filterType.push(\\\"image\\\");\\n        items.push({\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"çœ‹å›¾æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œå›¾ç‰‡\\\".small().fontcolor(\\\"grey\\\"),\\n            url: \\\"hiker://empty\\\",\\n            col_type: \\\"text_center_1\\\",\\n            extra: {\\n                lineVisible: false\\n            }\\n        });\\n    } else {\\n        folderStyle = fileStyle = style;\\n    }\\n    let noSkipFile = !skipFile;\\n    for (let i = 0; i < conts.length; i++) {\\n        let fileItem = conts[i];\\n        let cate = fileItem.category;\\n        let desc = formatDate(fileItem.updated_at);\\n        let pic_url = getIcon(fileItem.file_extension, fileItem.type);\\n\\n        if (fileItem.type === \\\"folder\\\") {\\n            let title = (folderStyle === \\\"text_1\\\" ? titleHead.folder : \\\"\\\") + fileItem.name;\\n            items.push({\\n                title: title,\\n                url: 'hiker://page/aliyun?page=fypage',\\n                col_type: folderStyle,\\n                desc: formatDate(fileItem.updated_at),\\n                pic_url: pic_url,\\n                extra: {\\n                    shareId: shareId,\\n                    shareToken: MY_PARAMS.shareToken,\\n                    fileId: fileItem.file_id,\\n                    sharePwd: sharePwd,\\n                    pageTitle: fileItem.name,\\n                    transfer: true,\\n                    noPic: true,\\n                    longClick: [{\\n                        title: \\\"è½¬å­˜\\\",\\n                        js: JSON.stringify(\\\"hiker://page/myaliyun#noHistory##noRecordHistory#?page=fypage\\\")\\n                    }]\\n                }\\n            });\\n        } else if (noSkipFile) {\\n            if (filterType.length > 0 && !filterType.includes(cate)) {\\n                continue;\\n            }\\n            let subtitle, cls, longc = [{\\n                title: \\\"è½¬å­˜\\\",\\n                js: JSON.stringify(\\\"hiker://page/myaliyun#noHistory##noRecordHistory#?page=fypage\\\")\\n            }];\\n            let title = fileItem.name;\\n            let nameNotExt = fileItem.name.replace('.' + fileItem.file_extension, '');\\n            if (subExts.includes(fileItem.file_extension)) {\\n                longc.push({\\n                    title: \\\"æŒ‚è½½å­—å¹•\\\",\\n                    js: $.toString((zm) => {\\n                        storage0.putMyVar('mountzimu', zm);\\n                        return 'toast://æŒ‚è½½å®Œæˆï¼Œå½“å‰å­—å¹•æ–‡ä»¶: ' + zm.name + '.' + zm.ext;\\n                    }, {\\n                        ext: fileItem.file_extension,\\n                        file_id: fileItem.file_id,\\n                        name: nameNotExt\\n                    }),\\n                });\\n            }\\n            if (cate === \\\"video\\\") {\\n                if (zimulist.length) {\\n                    subtitle = zimulist.find(v => v.name.includes(nameNotExt));\\n                }\\n                cls = \\\"playlist v\\\" + pageId;\\n            }\\n            if (fileStyle === \\\"text_1\\\") {\\n                desc += \\\"\\\\t\\\\t\\\" + formatSize(fileItem.size);\\n                title = getHead(cate, fileItem.file_extension) + title;\\n            } else if ([\\\"video\\\", \\\"image\\\"].includes(cate)) {\\n                pic_url = getPreviewPic(fileItem) || pic_url;\\n            }\\n            items.push({\\n                title: title,\\n                url: $(\\\"#noPre#\\\").lazyRule((shareId, sharePwd, shareToken, fileId, cate, subtitle) => {\\n                    return $.require(\\\"hiker://page/alilazy\\\")(shareId, sharePwd, shareToken, fileId, cate, subtitle);\\n                }, shareId, sharePwd, MY_PARAMS.shareToken, fileItem.file_id, cate, subtitle),\\n                desc: desc,\\n                pic_url: pic_url,\\n                extra: {\\n                    id: fileItem.file_id,\\n                    transfer: true,\\n                    shareInfo: {\\n                        pageId: pageId,\\n                        fileId: fileItem.file_id,\\n                        shareId: shareId,\\n                        shareToken: shareToken,\\n                        sharePwd: sharePwd,\\n                    },\\n                    longClick: longc,\\n                    cls: cls,\\n                    //inheritTitle: false,\\n                    pageTitle: fileItem.name\\n                },\\n                col_type: fileStyle\\n            });\\n        }\\n    }\\n    if (conts.length === 0) {\\n        items.push({\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\\\".fontcolor(\\\"Gray\\\"),\\n            extra: {\\n                lineVisible: false,\\n            }\\n        });\\n    }\\n}\\n\\nlet items = [];\\ntry {\\n    if (MY_PAGE > 1 && !MY_PARAMS.marker) {\\n        items.push({\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\\\".fontcolor(\\\"Gray\\\"),\\n            extra: {\\n                lineVisible: false,\\n            }\\n        });\\n    } else {\\n        load(items);\\n    }\\n} catch (e) {\\n    if (e.name === \\\"AliError\\\") {\\n        if (e.code === \\\"InvalidResource.SharePwd\\\") {\\n            items.push({\\n                title: \\\"è¯·è¾“å…¥æå–ç \\\",\\n                desc: sharePwd ? \\\"â€œâ€œæå–ç é”™è¯¯â€â€\\\" : \\\"\\\",\\n                url: $().input((MY_PARAMS) => {\\n                    setPageParams(Object.assign({}, MY_PARAMS, {\\n                        sharePwd: input\\n                    }));\\n                    refreshPage();\\n                }, MY_PARAMS),\\n                col_type: \\\"text_center_1\\\"\\n            });\\n        } else {\\n            if (e.significance === 1) {\\n                items.push({\\n                    title: \\\"â€œâ€œâ€â€\\\" + e.message.big().big().fontcolor(\\\"red\\\"),\\n                    url: \\\"hiker://empty\\\",\\n                    col_type: 'text_center_1',\\n                });\\n            } else if (e.significance === 3) {\\n                items.push({\\n                    title: \\\"â€œâ€œâ€â€\\\" + e.message.big().fontcolor(\\\"green\\\"),\\n                    url: \\\"hiker://empty\\\",\\n                    col_type: 'text_center_1'\\n                });\\n            }\\n        }\\n\\n    } else {\\n        log(\\\"åˆ—è¡¨åŠ è½½å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n        items.push({\\n            title: 'æ¬§æ¬§ï¼ŒæŠ¥é”™äº†ã€‚åœ¨åˆ·æ–°å‡ æ¬¡ï¼Ÿæˆ–è€…æ›´æ¢æ–‡ä»¶å¤¹ã€‚',\\n            url: \\\"hiker://empty\\\",\\n            desc: e.toString(),\\n            col_type: 'text_center_1'\\n        });\\n        //throw e;\\n    }\\n}\\nsaveMyPaCache();\\nsetResult(items);\"},{\"col_type\":\"movie_3\",\"name\":\"ç™»å½•è´¦å·\",\"path\":\"login\",\"rule\":\"js:\\nvar d = [];\\nsetPageTitle(\\\"ç™»å½•é˜¿é‡Œäº‘ç›˜\\\");\\nlet index = Number(getParam(\\\"index\\\", \\\"1\\\"));\\nif (Number.isNaN(index)) {\\n    index = 1;\\n}\\n\\n\\nfunction getQRCode() {\\n    let json = fetch(\\\"https://passport.aliyundrive.com/newlogin/qrcode/generate.do?appName=aliyun_drive&fromSite=52&appName=aliyun_drive&appEntrance=web&isMobile=false&lang=zh_CN&returnUrl=&bizParams=&_bx-v=2.2.3\\\");\\n    let qr = JSON.parse(json);\\n    if (!openAppIntent('com.alicloud.databox', 'com.taobao.login4android.scan.QrScanActivity', {\\n            \\\"key_scanParam\\\": json\\n        })) {\\n        createQRCode(qr.content.data.codeContent, false);\\n    }\\n    return qr;\\n}\\n\\nfunction backHome(t, i) {\\n    back(i);\\n    toast(t);\\n}\\n\\nfunction fromAppGetToken(qr) {\\n    let qr = getQRCode();\\n    if (!qr) return backHome(\\\"è·å–å¤±è´¥\\\");\\n    let ckk = qr.content.data;\\n    let body = {\\n        ck: ckk.ck,\\n        t: ckk.t + \\\"\\\",\\n        appName: \\\"aliyun_drive\\\",\\n        appEntrance: \\\"web\\\",\\n        isMobile: false,\\n        lang: \\\"zh_CN\\\",\\n        navPlatform: \\\"MacIntel\\\",\\n        returnUrl: \\\"\\\",\\n        navlanguage: \\\"zh-CN\\\",\\n        fromSite: 52,\\n        bizParams: \\\"\\\"\\n\\n    };\\n    /*\\n     {\\n        NEW: \\\"å¾…æ‰«æ\\\",\\n        CANCELED: \\\"å–æ¶ˆ\\\",\\n        SCANED:\\\"å·²æ‰«æ\\\",\\n        CANCELED: \\\"å®Œæˆ\\\"\\n    }*/\\n    let errorCount = 0;\\n    for (let i = 0; i < 30; i++) {\\n        try {\\n            let result = JSON.parse(post(\\\"https://passport.aliyundrive.com/newlogin/qrcode/query.do?appName=aliyun_drive&fromSite=52&_bx-v=2.2.3\\\", {\\n                body: body\\n            }));\\n            let qrCodeStatus = result.content.data.qrCodeStatus;\\n\\n            if (qrCodeStatus === \\\"CONFIRMED\\\") {\\n                if (result.content.data.bizExt) {\\n                    let info = JSON.parse(base64Decode(result.content.data.bizExt));\\n                    let aliTokensFilepath = $.require(\\\"hiker://page/tokenPath\\\").aliTokensFilepath;\\n                    let aliToken = {\\n                        refresh_token: info.pds_login_result.refreshToken\\n                    };\\n                    writeFile(aliTokensFilepath, JSON.stringify(aliToken));\\n                    addItemAfter(\\\"loginy\\\", {\\n                        title: \\\"ç™»å½•æˆåŠŸ(ç‚¹å‡»è¿”å›)\\\",\\n                        url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n                            back(false);\\n                            return \\\"hiker://empty\\\";\\n                        }),\\n                        col_type: \\\"text_center_1\\\",\\n                    });\\n                    backHome(\\\"ç™»å½•æˆåŠŸ\\\", true);\\n                } else {\\n                    backHome(\\\"ç™»å½•å¤±è´¥,è¯·å°è¯•å…¶ä»–çš„æ–¹æ³•\\\");\\n                }\\n                return;\\n            } else if (qrCodeStatus === \\\"CANCELED\\\") {\\n                backHome(\\\"å–æ¶ˆç™»å½•æˆæƒ\\\");\\n                return;\\n            }\\n            if ([\\\"NEW\\\", \\\"SCANED\\\"].includes(qrCodeStatus)) {\\n                java.lang.Thread.sleep(2500);\\n            } else {\\n                backHome(\\\"è¶…æ—¶\\\");\\n                return;\\n            }\\n        } catch (e) {\\n            errorCount++;\\n            if (errorCount > 4) {\\n                throw e;\\n            }\\n        }\\n    }\\n\\n}\\nif (index > -1) {\\n    let loginUrls = [\\\"https://www.aliyundrive.com/sign\\\", \\\"https://auth.aliyundrive.com/v2/oauth/authorize?login_type=custom&response_type=code&redirect_uri=https%3A%2F%2Fwww.aliyundrive.com%2Fsign%2Fcallback&client_id=25dzX3vbYqktVxyX&state=%7B%22origin%22%3A%22*%22%7D#/login\\\"];\\n    let url = loginUrls[index];\\n    let isRefresh = !getParam(\\\"noRefresh\\\");\\n    let aliTokensFilepath = $.require(\\\"tokenPath\\\").aliTokensFilepath;\\n\\n    var js = $.toString((isRefresh, aliTokensFilepath) => {\\n        setInterval(() => {\\n            var token = JSON.parse(localStorage.getItem('token'));\\n            if (token && token.user_id) {\\n                let token_url = aliTokensFilepath;\\n                fy_bridge_app.writeFile(token_url, JSON.stringify(token));\\n                localStorage.clear();\\n                fy_bridge_app.back(isRefresh);\\n                fy_bridge_app.toast('TOKENè·å–æˆåŠŸï¼Œè¯·å‹¿æ³„æ¼ä¸ªäººéšç§ï¼ï¼ï¼');\\n                return;\\n            }\\n        }, 300);\\n    }, isRefresh, aliTokensFilepath);\\n\\n    d.push({\\n        url: url,\\n        col_type: 'x5_webview_single',\\n        desc: '100%&&float',\\n        extra: {\\n            canBack: false,\\n            js: js,\\n            urlInterceptor: $.toString(() => true)\\n        }\\n    });\\n    setResult(d);\\n} else {\\n    \\n    d.push({\\n        col_type: \\\"text_center_1\\\",\\n        title: \\\"â€œâ€œâ€â€\\\" + \\\"ç­‰å¾…æˆæƒ...\\\".big().big(),\\n        desc: \\\"å¦‚æœå‡çº§äº†å®˜æ–¹Appï¼Œæ— æ³•è‡ªåŠ¨è°ƒèµ·æˆæƒï¼Œè¯·æ‰«ç ç™»å½•\\\",\\n        url: \\\"hiker://empty\\\",\\n        extra: {\\n            id: \\\"loginy\\\",\\n        }\\n    });\\n    setResult(d);\\n    try {\\n        fromAppGetToken();\\n    } catch (e) {\\n        backHome(\\\"å†…éƒ¨é”™è¯¯:\\\" + e.toString());\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"é˜¿é‡Œåˆ—è¡¨API\",\"path\":\"AliApi\",\"rule\":\"js:\\n//@author LoyDgIk\\nfunction AliError(errorCode, message, significance) {\\n    let errorType = AliError.errorCodeMap.get(errorCode) || [];\\n    this.code = errorCode;\\n    this.message = errorType[0] || message || \\\"\\\";\\n    this.name = \\\"AliError\\\";\\n    this.significance = errorType[1] || significance || 1;\\n}\\nAliError.errorCodeMap = new Map([\\n    [\\\"ShareLink.Cancelled\\\", [\\\"åˆ†äº«é“¾æ¥å·²å¤±æ•ˆ\\\"]],\\n    [\\\"ShareLink.Forbidden\\\", [\\\"è¿è§„èµ„æºå·²è¢«å°ç¦\\\"]],\\n    [\\\"NotFound.ShareLink\\\", [\\\"ä¸å­˜åœ¨è¯¥é“¾æ¥è¯·æ ¸å¯¹\\\"]],\\n    [\\\"AccessTokenInvalid\\\", [\\\"è®¿é—®ä»¤ç‰Œå¤±æ•ˆï¼Œè¯·é‡æ–°ç™»é™†\\\"]],\\n    [\\\"ShareLinkTokenInvalid\\\", [\\\"åˆ†äº«ä»¤ç‰Œå¤±æ•ˆ\\\"]],\\n    [\\\"ParamFlowException\\\", [\\\"è®¿é—®è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•\\\", 3]]\\n]);\\n\\nAliError.prototype = Object.assign(new Error(), {\\n    constructor: AliError\\n});\\n\\nfunction postApi(api, body, headers) {\\n    let result = request('https://api.aliyundrive.com' + api, {\\n        headers: Object.assign({\\n            'Content-Type': 'application/json',\\n        }, headers),\\n        body: JSON.stringify(body),\\n        method: 'POST'\\n    });\\n    result = JSON.parse(result);\\n    if (result.code) {\\n        throw new AliError(result.code, result.message);\\n    }\\n    return result;\\n}\\n\\nfunction AliShareApi(shareId, sharePwd, shareToken, refreshCallBack) {\\n    this.shareId = shareId;\\n    this.sharePwd = sharePwd;\\n    this.refreshCallBack = refreshCallBack || (() => void 0);\\n    this.shareToken = shareToken || this.getShareToken();\\n}\\nObject.assign(AliShareApi.prototype, {\\n    getShareToken() {\\n        let result = postApi(\\\"/v2/share_link/get_share_token\\\", {\\n            \\\"share_id\\\": this.shareId,\\n            \\\"share_pwd\\\": this.sharePwd,\\n        });\\n        this.shareToken = result.share_token;\\n        this.refreshCallBack(result.share_token, this);\\n        return result.share_token;\\n    },\\n    postTokenApi(api, body, headers, isRetry) {\\n        let result;\\n        try {\\n            result = postApi(api, body, Object.assign({\\n                \\\"X-Share-Token\\\": this.shareToken || this.getShareToken()\\n            }, headers));\\n        } catch (e) {\\n            if ((e.code === \\\"AccessTokenInvalid\\\" || e.code === \\\"ShareLinkTokenInvalid\\\") && !isRetry) {\\n                this.getShareToken();\\n                return this.postTokenApi(api, body, headers, true);\\n            }\\n            throw e;\\n        }\\n        return result;\\n    },\\n    getListFile(fileId, marker, orderBy, orderDirection) {\\n        let result = this.postTokenApi(\\\"/adrive/v3/file/list\\\"/*\\\"/adrive/v2/file/list_by_share\\\"*/, {\\n            \\\"share_id\\\": this.shareId,\\n            \\\"parent_file_id\\\": fileId || \\\"root\\\",\\n            \\\"limit\\\": 100,\\n            \\\"image_thumbnail_process\\\": \\\"image/resize,w_160/format,jpeg\\\",\\n            \\\"image_url_process\\\": \\\"image\\\\/resize,w_1920/format,jpeg\\\",\\n            \\\"video_thumbnail_process\\\": \\\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\\\",\\n            \\\"order_by\\\": orderBy || \\\"name\\\",\\n            \\\"order_direction\\\": orderDirection || \\\"ASC\\\",\\n            \\\"marker\\\": marker\\n        });\\n        return result;\\n    },\\n    getShareInfo() {\\n        let result = postApi(\\\"/adrive/v3/share_link/get_share_by_anonymous?share_id=\\\" + this.shareId, {\\n            \\\"share_id\\\": this.shareId,\\n        });\\n        return result;\\n    },\\n    getSearchListFile(key, marker, orderBy, orderDirection) {\\n        let result = this.postTokenApi(\\\"/recommend/v1/shareLink/search\\\", {\\n            \\\"share_id\\\": this.shareId,\\n            \\\"keyword\\\": key,\\n            \\\"limit\\\": 100,\\n            \\\"order_by\\\": orderBy + \\\" \\\" + orderDirection,\\n            \\\"marker\\\": marker || undefined\\n        });\\n        if (Object.keys(result).length === 0) {\\n            result.items = [];\\n        }\\n        return result;\\n    }\\n});\\n$.exports = AliShareApi;\"},{\"col_type\":\"movie_3\",\"name\":\"é˜¿é‡Œæ’­æ”¾API\",\"path\":\"aliPlayApi\",\"rule\":\"//@author LoyDgIk\\n\\nfunction AliAccessApi({\\n    shareId,\\n    sharePwd,\\n    shareToken,\\n    aliTokens,\\n    openTokens,\\n    openSuffix,\\n    refreshShareCallBack,\\n    refreshAccessCallBack,\\n    refreshOpenCallBack\\n}) {\\n    this.openSuffix = openSuffix || \\\"\\\";\\n    this.shareId = shareId;\\n    this.sharePwd = sharePwd;\\n    this.shareToken = shareToken;\\n    this.refreshShareCallBack = refreshShareCallBack || (() => void 0);\\n    this.refreshAccessCallBack = refreshAccessCallBack || (() => void 0);\\n    this.refreshOpenCallBack = refreshOpenCallBack || (() => void 0);\\n    this.aliTokens = aliTokens || {};\\n    if (!this.aliTokens.refresh_token) {\\n        throw new Error(\\\"æœªç™»é™†\\\");\\n    }\\n    if (!this.aliTokens.access_token) {\\n        this.refreshAccessToken();\\n    }\\n    this.defDriveId = this.aliTokens.resource_drive_id || this.aliTokens.default_drive_id;\\n    this.reaccessTk = (this.aliTokens.token_type || \\\"Bearer\\\") + ' ' + this.aliTokens.access_token;\\n    Object.defineProperty(this, \\\"shareToken\\\", {\\n        get() {\\n            return this._shareToken || this.getShareToken();\\n        },\\n        set(v) {\\n            this._shareToken = v;\\n        }\\n    });\\n    Object.defineProperty(this, \\\"openTools\\\", {\\n        get() {\\n            if (this._openTools) return this._openTools;\\n            let OpenApiTools;\\n            switch (getItem(\\\"openApiMode\\\", \\\"0\\\")) {\\n                case \\\"1\\\":\\n                    OpenApiTools = $.require(\\\"openApi_aliyundrive\\\" + this.openSuffix);\\n                    break;\\n                case \\\"2\\\":\\n                    OpenApiTools = $.require(\\\"openApi_tvbox\\\" + this.openSuffix);\\n                    break;\\n                case \\\"3\\\":\\n                    OpenApiTools = $.require(\\\"openApi_XBY\\\" + this.openSuffix);\\n                    break;\\n                case \\\"4\\\":\\n                    OpenApiTools = $.require(\\\"openApi_tv\\\" + this.openSuffix);\\n                    break;\\n                case \\\"0\\\":\\n                default:\\n                    OpenApiTools = $.require(\\\"openApi_alist\\\" + this.openSuffix);\\n            }\\n            this._openTools = new OpenApiTools(this);\\n            return this._openTools;\\n        }\\n    });\\n    Object.defineProperty(this, \\\"openTokens\\\", {\\n        get() {\\n            if (this._openTokens) return this._openTokens;\\n            this._openTokens = Object.assign({\\n                'RefreshTokenOpen': '',\\n                'AccessTokenOpen': '',\\n                'BindRefreshToken': '',\\n            }, openTokens);\\n            if (openTokens !== null && !this._openTokens.AccessTokenOpen) {\\n                this.refreshOpenToken();\\n            }\\n            return this._openTokens;\\n        }\\n    });\\n}\\nObject.assign(AliAccessApi.prototype, {\\n    _openTools: void 0,\\n    _openTokens: void 0,\\n    _shareToken: void 0,\\n    waitSleep(time) {\\n        java.lang.Thread.sleep(time || 600);\\n        return this;\\n    },\\n    postApi(api) {\\n        return httpRequest.post(api.startsWith(\\\"http\\\") ? api : 'https://api.aliyundrive.com' + api).bodyToString(true).error((err) => {\\n            throw err;\\n        }).errorType((err, res) => {\\n            let result = {};\\n            try {\\n                result = JSON.parse(res.body);\\n            } catch (e) {\\n                return err;\\n            }\\n            let rbody = (result.code ? result : (result && result.responses && result.responses[0] && result.responses[0].body)) || {};\\n            if (rbody.code) {\\n                let msg = rbody.display_message || rbody.message;\\n                let error = new Error(api + \\\"=>\\\" + rbody.code + \\\":\\\" + msg);\\n                error.code = rbody.code;\\n                error.judgeMsg = msg;\\n                return error;\\n            }\\n            return err;\\n        });\\n    },\\n    setMyDrividType(isBackup) {\\n        this.myDrividType = !!isBackup;\\n        return this;\\n    },\\n    trySolve(e) {\\n        if (e.code === \\\"ShareLinkTokenInvalid\\\" || e.code === \\\"InvalidParameterNotMatch.ShareId\\\") {\\n            this.waitSleep(20).getShareToken();\\n            return true;\\n        } else if (e.code === \\\"AccessTokenInvalid\\\" || e.code === \\\"AccessTokenExpired\\\") {\\n            this.waitSleep(20).refreshAccessToken();\\n            return true;\\n        } else if (e.code === \\\"ForbiddenNoPermission.File\\\" || (e.code === \\\"BadRequest\\\" && e.judgeMsg === \\\"ä»…å¯ä¿å­˜åˆ°è½¬å­˜ç©ºé—´\\\")) {\\n            this.aliTokens.resource_drive_id = undefined;\\n            this.waitSleep(20).refreshAccessToken();\\n            return true;\\n        }\\n        return false;\\n    },\\n    tryOpenApiSolve(e) {\\n        if (e.code === \\\"AccessTokenInvalid\\\" || e.code === \\\"AccessTokenExpired\\\") {\\n            this.waitSleep(20).refreshOpenToken();\\n            return true;\\n        } else {\\n            this.waitSleep(20).refreshAccessToken();\\n            this.waitSleep(20).refreshOpenToken();\\n            return true;\\n        }\\n        return false;\\n    },\\n    getShareToken() {\\n        if (!this.shareId) return;\\n        let result = this.postApi(\\\"/v2/share_link/get_share_token\\\").body({\\n            \\\"share_id\\\": this.shareId,\\n            \\\"share_pwd\\\": this.sharePwd,\\n        }).start(true);\\n        this.shareToken = result.share_token;\\n        this.refreshShareCallBack(result.share_token, this);\\n        return result.share_token;\\n    },\\n    refreshAccessToken() {\\n        let result = this.postApi(\\\"https://auth.aliyundrive.com/v2/account/token\\\")\\n            .body({\\n                \\\"grant_type\\\": \\\"refresh_token\\\",\\n                \\\"refresh_token\\\": this.aliTokens.refresh_token,\\n            }).headers({\\n                \\\"User-Agent\\\": PC_UA,\\n                \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n            }).error((e) => {\\n                if (e.code === \\\"InvalidParameter.RefreshToken\\\") {\\n                    e.message = \\\"#ç™»é™†è¿‡æœŸè¯·é‡æ–°ç™»é™†#\\\\n\\\" + e.message;\\n                    throw e;\\n                }\\n            }).start(true);\\n        delete result.user_data;\\n        let originDefdDriveId = this.aliTokens.default_drive_id;\\n        this.aliTokens = Object.assign(this.aliTokens, result);\\n        this.reaccessTk = this.aliTokens.token_type + ' ' + this.aliTokens.access_token;\\n        try {\\n            if ((originDefdDriveId !== this.aliTokens.default_drive_id) || this.aliTokens.resource_drive_id === undefined) {\\n                let resource_drive_id = this.getUserInfo().resource_drive_id;\\n                this.aliTokens.resource_drive_id = resource_drive_id;\\n                if (resource_drive_id) {\\n                    this.defDriveId = resource_drive_id;\\n                } else {\\n                    this.defDriveId = this.aliTokens.default_drive_id;\\n                }\\n            }\\n        } catch (e) {\\n            log(\\\"ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥ï¼š\\\" + e.toString());\\n        }\\n        this.refreshAccessCallBack(result, this);\\n        return this.aliTokens;\\n    },\\n    getUserInfo() {\\n        let info = this.postApi(\\\"https://user.aliyundrive.com/v2/user/get\\\").headers({\\n            \\\"User-Agent\\\": PC_UA,\\n            \\\"authorization\\\": this.reaccessTk,\\n            \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n        }).errorWithRetry((e, _, http) => {\\n            this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'authorization': this.reaccessTk\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return info;\\n    },\\n    cacheOpenToken(openResult) {\\n        this.openTokens.RefreshTokenOpen = openResult.refresh_token;\\n        this.openTokens.AccessTokenOpen = openResult.token_type + \\\" \\\" + openResult.access_token;\\n        this.openTokens.BindRefreshToken = this.aliTokens.refresh_token;\\n        this.refreshOpenCallBack(openResult, this);\\n    },\\n    refreshOpenToken() {\\n        try {\\n            let openResult;\\n            if (this.openTokens.RefreshTokenOpen && this.openTokens.BindRefreshToken === this.aliTokens.refresh_token) {\\n                openResult = this.openTools.refreshOpenToken() || {};\\n            } else {\\n                openResult = this.openTools.getOpenToken() || {};\\n            }\\n            if (openResult.refresh_token) {\\n                this.cacheOpenToken(openResult);\\n                return this.openTokens;\\n            } else {\\n                throw new Error(\\\"è¿”å›ç»“æœæ— Token\\\");\\n            }\\n        } catch (e) {\\n            throw new Error(\\\"OpenTokenè·å–å¤±è´¥:\\\" + e.toString());\\n        }\\n    },\\n    _cloudFileOperate(body, cloudFileId, operateUrl) {\\n        let result = this.postApi('https://api.aliyundrive.com/adrive/v2/batch').body({\\n            \\\"requests\\\": [{\\n                \\\"body\\\": body,\\n                \\\"headers\\\": {\\n                    \\\"Content-Type\\\": \\\"application/json\\\"\\n                },\\n                \\\"id\\\": cloudFileId || \\\"0\\\",\\n                \\\"method\\\": \\\"POST\\\",\\n                \\\"url\\\": operateUrl\\n            }],\\n            \\\"resource\\\": \\\"file\\\"\\n        }).headers({\\n            'User-Agent': PC_UA,\\n            'Referer': 'https://www.aliyundrive.com/',\\n            'authorization': this.reaccessTk,\\n            //getAccessToken\\n            'x-canary': 'client=web,app=share,version=v2.3.1',\\n            'x-share-token': this.shareToken\\n        }).errorWithRetry((e, _, http) => {\\n            if (e.code === \\\"QuotaExhausted.Drive\\\") {\\n                throw e;\\n            }\\n\\n            if (!this.trySolve(e)) {\\n                this.waitSleep(20).refreshAccessToken();\\n            }\\n            let body = http.options.body.requests[0].body;\\n            if (body.drive_id) {\\n                body.drive_id = this.getMyDrivid();\\n            }\\n            if (body.to_drive_id) {\\n                body.to_drive_id = this.getMyDrivid();\\n            }\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'authorization': this.reaccessTk,\\n                    'x-share-token': this.shareToken\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return result;\\n    },\\n    copyFileToCloudFile(fileId, parentFileId, retry) {\\n        let result = this._cloudFileOperate({\\n            \\\"file_id\\\": fileId,\\n            \\\"share_id\\\": this.shareId,\\n            \\\"auto_rename\\\": true,\\n            \\\"to_parent_file_id\\\": parentFileId || \\\"root\\\",\\n            \\\"to_drive_id\\\": this.getMyDrivid()\\n        }, \\\"0\\\", \\\"/file/copy\\\");\\n        let body = result && result.responses && result.responses[0] && result.responses[0].body || {};\\n        if (!body.file_id && !retry) {\\n            this.waitSleep(20).getShareToken();\\n            this.waitSleep(20).refreshAccessToken();\\n            return this.waitSleep(20).copyFileToCloudFile(fileId, parentFileId, true);\\n        } else if (!body.file_id) {\\n            let e = new Error(\\\"æ–‡ä»¶å¤åˆ¶å¤±è´¥:\\\\n\\\" + JSON.stringify(result));\\n            e.code = body.code;\\n            throw e;\\n        }\\n        return result.responses[0].body.file_id;\\n    },\\n    openCloudFileToDownUrl(cloudFileId) {\\n        let fileInfo = this.postApi('https://open.aliyundrive.com/adrive/v1.0/openFile/getDownloadUrl').body({\\n            'file_id': cloudFileId,\\n            'drive_id': this.getMyDrivid()\\n        }).headers({\\n            'User-Agent': PC_UA,\\n            'Referer': 'https://www.aliyundrive.com/',\\n            'authorization': this.openTokens.AccessTokenOpen\\n        }).errorWithRetry(2, (e, _, http) => {\\n            //this.waitSleep(30).trySolve(e);\\n            this.waitSleep(30).tryOpenApiSolve(e);\\n            http.mergeHeadAndBody({\\n                body: {\\n                    'drive_id': this.getMyDrivid(),\\n                },\\n                headers: {\\n                    'authorization': this.openTokens.AccessTokenOpen\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        if (!fileInfo.url || fileInfo.code) throw new Error(\\\"ä¸‹è½½é“¾æ¥è·å–å¤±è´¥\\\\n\\\" + fileInfo.code + \\\":\\\" + fileInfo.message);\\n        return fileInfo.url;\\n    },\\n    deleteeCloudFile(cloudFileId) {\\n        let result = this._cloudFileOperate({\\n            \\\"drive_id\\\": this.getMyDrivid(),\\n            \\\"file_id\\\": cloudFileId\\n        }, cloudFileId, \\\"/file/delete\\\");\\n        return result;\\n    },\\n    getVideoCloudPreview(cloudFileId) {\\n        let fileInfo = this.postApi('https://open.aliyundrive.com/adrive/v1.0/openFile/getVideoPreviewPlayInfo').body({\\n            'file_id': cloudFileId,\\n            'drive_id': this.getMyDrivid(),\\n            \\\"category\\\": \\\"live_transcoding\\\",\\n            \\\"template_id\\\": \\\"\\\",\\n            \\\"get_subtitle_info\\\": true,\\n            \\\"url_expire_sec\\\": 14400,\\n            \\\"with_play_cursor\\\": true\\n        }).headers({\\n            'User-Agent': PC_UA,\\n            'Referer': 'https://www.aliyundrive.com/',\\n            'authorization': this.openTokens.AccessTokenOpen\\n        }).errorWithRetry(2, (e, _, http) => {\\n            //this.waitSleep(30).trySolve(e);\\n            this.waitSleep(30).tryOpenApiSolve(e);\\n            http.mergeHeadAndBody({\\n                body: {\\n                    'drive_id': this.getMyDrivid(),\\n                },\\n                headers: {\\n                    'authorization': this.openTokens.AccessTokenOpen\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return fileInfo.video_preview_play_info.live_transcoding_task_list.reverse();\\n    },\\n    getAllVideoTemPlayUrl(fileId, onlyPreview) {\\n        let cloudFileId = this.copyFileToCloudFile(fileId);\\n        this.waitSleep(20);\\n        let playUrl = onlyPreview ? undefined : this.openCloudFileToDownUrl(cloudFileId);\\n        this.waitSleep(50);\\n        let preview = this.getVideoCloudPreview(cloudFileId);\\n        this.waitSleep(50);\\n        try {\\n            this.deleteeCloudFile(cloudFileId);\\n        } catch (e) {\\n            log(\\\"#æ–‡ä»¶åˆ é™¤å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n        }\\n        return {\\n            origin: playUrl,\\n            preview\\n        };\\n    },\\n    getVideoTemPlayUrl(fileId) {\\n        let cloudFileId = this.copyFileToCloudFile(fileId);\\n        this.waitSleep(20);\\n        let playUrl = this.openCloudFileToDownUrl(cloudFileId);\\n        this.waitSleep(50);\\n        try {\\n            this.deleteeCloudFile(cloudFileId);\\n        } catch (e) {\\n            log(\\\"#æ–‡ä»¶åˆ é™¤å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n        }\\n        return playUrl;\\n    },\\n    getFileToDownUrl(fileId) {\\n        let downloadInfo = this.postApi(\\\"/v2/file/get_share_link_download_url\\\").body({\\n            \\\"expire_sec\\\": 600,\\n            \\\"file_id\\\": fileId,\\n            \\\"share_id\\\": this.shareId\\n        }).headers({\\n            \\\"X-Share-Token\\\": this.shareToken,\\n            \\\"authorization\\\": this.aliTokens.access_token\\n        }).errorWithRetry((e, _, http) => {\\n            this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    \\\"X-Share-Token\\\": this.shareToken,\\n                    \\\"authorization\\\": this.aliTokens.access_token\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return downloadInfo.download_url;\\n    },\\n    \\n    getSign() {\\n        if (!this.aliTokens.device_id) {\\n            this.waitSleep(20).refreshAccessToken();\\n        }\\n        let calculateNewSign = () => {\\n            let sign = justTestSign(\\\"5dde4e1bdf9e4966b387ba58f4b3fdc3\\\", this.aliTokens.device_id, this.aliTokens.user_id).split(\\\"##\\\");\\n            return {\\n                signature: sign.at(0),\\n                pubKey: sign.at(-1)\\n            };\\n        };\\n        let newSign = calculateNewSign();\\n        let result = this.postApi('/users/v1/users/device/create_session').body({\\n            \\\"deviceName\\\": \\\"Edgeæµè§ˆå™¨\\\",\\n            \\\"modelName\\\": \\\"Windowsç½‘é¡µç‰ˆ\\\",\\n            \\\"pubKey\\\": newSign.pubKey,\\n        }).headers({\\n            'User-Agent': PC_UA,\\n            'Referer': 'https://www.aliyundrive.com',\\n            'Authorization': this.reaccessTk,\\n            'X-Share-Token': this.shareToken,\\n            'x-device-id': this.aliTokens.device_id,\\n            'x-signature': newSign.signature\\n        }).errorWithRetry(3, (e, _, http) => {\\n            if (e.message === \\\"x-device-id empty\\\") {\\n                this.waitSleep(20).refreshAccessToken();\\n            }\\n            this.trySolve(e);\\n            this.waitSleep(50);\\n            newSign = calculateNewSign();\\n            http.mergeHeadAndBody({\\n                body: {\\n                    \\\"pubKey\\\": newSign.pubKey\\n                },\\n                headers: {\\n                    'Authorization': this.reaccessTk,\\n                    'X-Share-Token': this.shareToken,\\n                    'x-device-id': this.aliTokens.device_id,\\n                    'x-signature': newSign.signature\\n                }\\n            });\\n            return true;\\n        }).error((err, res) => {\\n            return {};\\n        }).success((body) => {\\n            return body;\\n        }).start(true);\\n        if (result.success) {\\n            return newSign;\\n        } else {\\n            throw new Error(\\\"Signè·å–å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚\\\\ncode:\\\" + (result.code || \\\"\\\") + \\\"\\\\nmessage:\\\" + (result.message || \\\"\\\"));\\n        }\\n    },\\n    getShareVideoPreview(fileId) {\\n        let sign = this.getSign();\\n        let json = this.postApi('https://api.aliyundrive.com/v2/file/get_share_link_video_preview_play_info').body({\\n            \\\"category\\\": \\\"live_transcoding\\\",\\n            \\\"file_id\\\": fileId,\\n            \\\"get_preview_url\\\": true,\\n            \\\"share_id\\\": this.shareId,\\n            \\\"template_id\\\": \\\"\\\",\\n            \\\"get_subtitle_info\\\": true\\n        }).headers({\\n            'content-type': 'application/json;charset=UTF-8',\\n            \\\"origin\\\": \\\"https://www.aliyundrive.com\\\",\\n            \\\"referer\\\": \\\"https://www.aliyundrive.com/\\\",\\n            \\\"user-agent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.41\\\",\\n            \\\"x-canary\\\": \\\"client=web,app=adrive,version=v3.1.0\\\",\\n            \\\"x-share-token\\\": this.shareToken,\\n            \\\"fileid\\\": this.aliTokens.user_id,\\n            'Authorization': this.reaccessTk,\\n            'x-device-id': this.aliTokens.device_id,\\n            'x-signature': sign.signature\\n        }).errorWithRetry((e, _, http) => {\\n            this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'Authorization': this.reaccessTk,\\n                    'X-share-token': this.shareToken,\\n                    'x-device-id': this.aliTokens.device_id,\\n                    'x-signature': sign.signature\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return json.video_preview_play_info.live_transcoding_task_list.reverse();\\n    },\\n    getMyDrivid() {\\n        return (this.myDrividType ? this.aliTokens.default_drive_id : this.aliTokens.resource_drive_id) || this.defDriveId;\\n    },\\n    getListFile(fileId, marker, orderBy, orderDirection) {\\n        let result = this.postApi(\\\"https://open.aliyundrive.com/adrive/v1.0/openFile/list\\\").body({\\n            \\\"drive_id\\\": this.getMyDrivid(),\\n            \\\"parent_file_id\\\": fileId || \\\"root\\\",\\n            \\\"limit\\\": 100,\\n            \\\"all\\\": true,\\n            \\\"url_expire_sec\\\": 86400,\\n            \\\"image_thumbnail_process\\\": \\\"image/resize,w_400/format,jpeg\\\",\\n            \\\"image_url_process\\\": \\\"image/resize,w_1920/format,jpeg\\\",\\n            \\\"video_thumbnail_process\\\": \\\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\\\",\\n            \\\"order_by\\\": orderBy || \\\"name\\\",\\n            \\\"order_direction\\\": orderDirection || \\\"ASC\\\",\\n            \\\"marker\\\": marker\\n        }).headers({\\n            'User-Agent': PC_UA,\\n            'Referer': 'https://www.aliyundrive.com/',\\n            'authorization': this.openTokens.AccessTokenOpen\\n        }).errorWithRetry(2, (e, _, http) => {\\n\\n            this.waitSleep(30).tryOpenApiSolve(e);\\n            http.mergeHeadAndBody({\\n                body: {\\n                    'drive_id': this.getMyDrivid(),\\n                },\\n                headers: {\\n                    'authorization': this.openTokens.AccessTokenOpen\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return result;\\n    },\\n    getSearchListFile(key, marker, orderBy, orderDirection, mode) {\\n        let type = \\\"\\\";\\n        if (mode === 1) {\\n            type = \\\"type=\\\\\\\"file\\\\\\\" and \\\";\\n        } else if (mode === 2) {\\n            type = \\\"type=\\\\\\\"folder\\\\\\\" and \\\";\\n        }\\n        let result = this.postApi(\\\"https://api.alipan.com/adrive/v3/file/search\\\").body({\\n            \\\"drive_id\\\": this.getMyDrivid(),\\n            \\\"query\\\": type + \\\"name match \\\" + JSON.stringify(key),\\n            \\\"limit\\\": 100,\\n            \\\"order_by\\\": orderBy + \\\" \\\" + orderDirection,\\n            \\\"marker\\\": marker || undefined\\n        }).headers({\\n            'User-Agent': PC_UA,\\n            'Referer': 'https://www.aliyundrive.com/',\\n            'authorization': this.reaccessTk\\n        }).errorWithRetry(2, (e, _, http) => {\\n            this.waitSleep(20).refreshAccessToken();\\n            //this.waitSleep(30).tryOpenApiSolve(e);\\n            http.mergeHeadAndBody({\\n                body: {\\n                    'drive_id': this.getMyDrivid(),\\n                },\\n                headers: {\\n                    'authorization': this.reaccessTk\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        if (Object.keys(result).length === 0) {\\n            result.items = [];\\n        }\\n        return result;\\n    },\\n    signInReward() {\\n        let silData = this.postApi('https://member.aliyundrive.com/v1/activity/sign_in_list').body({\\n            'grant_type': 'refresh_token',\\n            'refresh_token': this.aliTokens.refresh_token\\n        }).headers({\\n            'Authorization': this.reaccessTk,\\n            'Content-Type': 'application/json'\\n        }).errorWithRetry((e, _, http) => {\\n            this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'Authorization': this.reaccessTk,\\n\\n                },\\n                body: {\\n                    'refresh_token': this.aliTokens.refresh_token\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        let day = silData.result.signInCount;\\n        let isReward = silData.result.signInLogs[day - 1].isReward;\\n        if (isReward) {\\n            let reward = silData.result.signInLogs[day - 1].reward;\\n            if (reward) {\\n                let rewnotice = reward.notice;\\n                return \\\"ä»Šå¤©å·²ç»ç­¾åˆ°ï¼Œè¯·ä¸è¦é‡å¤ç­¾åˆ°ï¼\\\\n\\\" + rewnotice;\\n            } else {\\n                //æ²¡æœ‰å¥–åŠ±ï¼Œåªæœ‰å¹¸è¿ç­¾åç‰‡\\n                return \\\"ä»Šå¤©å·²ç»ç­¾åˆ°ï¼Œè¯·ä¸è¦é‡å¤ç­¾åˆ°ï¼\\\\nä»Šæ—¥å¥½è¿ç­¾:\\\" + silData.result.blessing;\\n            }\\n        } else {\\n            let sirData = this.postApi('https://member.aliyundrive.com/v1/activity/sign_in_reward').body({\\n                \\\"signInDay\\\": day\\n            }).headers({\\n                'Authorization': this.reaccessTk,\\n                'Content-Type': 'application/json'\\n            }).start(true);\\n            let reward = sirData.result;\\n            if (reward) {\\n                let msg = \\\"ç­¾åˆ°æˆåŠŸ! è·å¾—å¥–åŠ±:\\\" + reward.notice + \\\"(\\\" + reward.subNotice + \\\") æœ¬æœˆå·²è¿ç»­ç­¾åˆ°:\\\" + day + \\\"å¤©\\\";\\n                return msg;\\n            } else {\\n                //æ²¡æœ‰å¥–åŠ±ï¼Œåªæœ‰å¹¸è¿ç­¾åç‰‡\\n                return \\\"ç­¾åˆ°æˆåŠŸï¼ä»Šæ—¥å¹¸è¿ç­¾:\\\" + silData.result.blessing;\\n            }\\n        }\\n    }\\n});\\n\\nAliAccessApi.createDefault = function(shareId, sharePwd, shareToken, aliToken, openToken, MY_TITLE) {\\n    const {\\n        openTokensFilepath,\\n        aliTokensFilepath\\n    } = $.require(\\\"tokenPath\\\" + (MY_TITLE ? \\\"?rule=\\\" + MY_TITLE : \\\"\\\"));\\n    if (!openToken && openToken !== null && fileExist(openTokensFilepath)) {\\n        openToken = $.require(openTokensFilepath);\\n    }\\n    if (!aliToken && fileExist(aliTokensFilepath)) {\\n        aliToken = $.require(aliTokensFilepath);\\n    }\\n    if (MY_TITLE) {\\n        shareToken = getVar(MY_TITLE + \\\"@aliShareToken\\\", shareToken);\\n    } else {\\n        shareToken = getMyVar(\\\"aliShareToken\\\", shareToken);\\n    }\\n    return new AliAccessApi({\\n        shareId,\\n        sharePwd,\\n        shareToken,\\n        aliTokens: aliToken,\\n        openTokens: openToken,\\n        openSuffix: (MY_TITLE ? \\\"?rule=\\\" + MY_TITLE : \\\"\\\"),\\n        refreshAccessCallBack(result, api) {\\n            writeFile(aliTokensFilepath, JSON.stringify(api.aliTokens));\\n        },\\n        refreshOpenCallBack(result, api) {\\n            writeFile(openTokensFilepath, JSON.stringify(api.openTokens));\\n        },\\n        refreshShareCallBack(result) {\\n            if (MY_TITLE) {\\n                shareToken = putVar(MY_TITLE + \\\"@\\\" + \\\"aliShareToken\\\", result);\\n            } else {\\n                shareToken = putMyVar(\\\"aliShareToken\\\", result);\\n            }\\n        }\\n    });\\n}\\n$.exports = AliAccessApi;\\n\\nfunction httpRequest(url, options) {\\n    this.retryCount = 0;\\n    this.url = url;\\n    this.options = Object.assign({}, options, {\\n        withHeaders: true\\n    });\\n    this.errorCallback = (err, res) => {\\n        throw err\\n    };\\n    this.errorCallbackWithRetry = (err, res, tryRestart) => false;\\n    this.successCallback = (body, res) => body;\\n    this.errorTypeCallback = (err, res) => err;\\n    this.startRequest = fetch;\\n    this._bodyToString = false;\\n}\\n\\nObject.assign(httpRequest.prototype, {\\n    bodyToString(flag) {\\n        this._bodyToString = !!flag;\\n        return this;\\n    },\\n    body(body) {\\n        this.options.body = body || void 0;\\n        return this;\\n    },\\n    setStartRequestFunc(func) {\\n        this.startRequest = func;\\n        return this;\\n    },\\n    headers(headers) {\\n        this.options.headers = headers || void 0;\\n        return this;\\n    },\\n    success(successCallback) {\\n        if (typeof successCallback !== \\\"function\\\") return this;\\n        this.successCallback = successCallback;\\n        return this;\\n    },\\n    error(errorCallback) {\\n        if (typeof errorCallback !== \\\"function\\\") return this;\\n        this.errorCallback = errorCallback;\\n        return this;\\n    },\\n    errorType(errorTypeCallback) {\\n        if (typeof errorTypeCallback !== \\\"function\\\") return this;\\n        this.errorTypeCallback = errorTypeCallback;\\n        return this;\\n    },\\n    errorWithRetry(retryCount, errorCallbackWithRetry) {\\n        if (typeof retryCount === \\\"function\\\" && typeof errorCallbackWithRetry === \\\"undefined\\\") {\\n            errorCallbackWithRetry = retryCount;\\n            retryCount = 1;\\n        }\\n        if (typeof errorCallbackWithRetry !== \\\"function\\\") {\\n            return this;\\n        }\\n        this.retryCount = Number(retryCount);\\n        this.errorCallbackWithRetry = errorCallbackWithRetry;\\n        return this;\\n    },\\n    start(toJson) {\\n        let options = Object.assign({}, this.options);\\n        if (typeof options.body === \\\"object\\\" && this._bodyToString) {\\n            options.body = JSON.stringify(options.body);\\n        }\\n        var res = JSON.parse(this.startRequest(this.url, options));\\n        try {\\n            if (res.statusCode >= 200 && res.statusCode <= 300) {\\n                let body = res.body;\\n                if (toJson) {\\n                    body = JSON.parse(body);\\n                }\\n                return this.successCallback(body, res);\\n            } else {\\n                throw new Error(String(res.statusCode));\\n            }\\n        } catch (err) {\\n            try {\\n                err = this.errorTypeCallback(err, res);\\n            } catch (e) {\\n\\n            }\\n            if (this.retryCount) {\\n\\n                let tryResult = this.errorCallbackWithRetry(err, res, this);\\n                if (tryResult) {\\n                    this.retryCount--;\\n                    return this.start(toJson);\\n                } else {\\n                    this.retryCount = 0;\\n                    return this.errorCallback(err, res);\\n                }\\n            } else {\\n                return this.errorCallback(err, res);\\n            }\\n        }\\n    },\\n    setOptions(options) {\\n        this.options = Object.assign({}, options, {\\n            withHeaders: true\\n        });\\n        return this;\\n    },\\n    mergeHeadAndBody(options) {\\n        options = options || {};\\n        this.options.headers = Object.assign(this.options.headers, options.headers);\\n        if (typeof this.options.body === \\\"object\\\" && typeof options.body === \\\"object\\\") {\\n            this.options.body = Object.assign(this.options.body, options.body);\\n        }\\n        return this;\\n    }\\n});\\n\\nObject.assign(httpRequest, {\\n    fetch(url, options) {\\n        return new httpRequest(url, options);\\n    },\\n    post(url, options) {\\n        return new httpRequest(url, options).setStartRequestFunc(post);\\n    },\\n    request(url, options) {\\n        return new httpRequest(url, options).setStartRequestFunc(request);\\n    },\\n    postRequest(url, options) {\\n        return new httpRequest(url, options).setStartRequestFunc(postRequest);\\n    },\\n    fetchCookie(url, options) {\\n        return new httpRequest(url, options).setStartRequestFunc(fetchCookie);\\n    }\\n});\"},{\"col_type\":\"movie_3\",\"name\":\"Tokenè·¯å¾„\",\"path\":\"tokenPath\",\"rule\":\"$.exports={\\n    \\\"openTokensFilepath\\\": \\\"hiker://files/rules/LoyDgIk/aliOpenToken.json\\\",\\n    \\\"aliTokensFilepath\\\": \\\"hiker://files/rules/LoyDgIk/aliToken.json\\\"\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"å¼¹å¼¹playå·¥å…·\",\"path\":\"danmu\",\"rule\":\"js:\\nlet basicUrl = \\\"https://api.dandanplay.net/\\\";\\nlet sevePath = \\\"hiker://files/cache/danmu/\\\";\\n\\nfunction getRefreshRate() {\\n    const Context = android.content.Context;\\n    const Display = android.view.Display;\\n    const WindowManager = android.view.WindowManager;\\n    const context = com.example.hikerview.ui.Application().getContext();\\n\\n    let windowManager = context.getSystemService(Context.WINDOW_SERVICE);\\n\\n    let display = windowManager.getDefaultDisplay();\\n\\n    let refreshRate = display.getRefreshRate();\\n    return refreshRate;\\n}\\n$.exports.getDanMu = function(key) {\\n    var qqUrl=basicUrl + \\\"api/v2/search/episodes?anime=\\\" + encodeURIComponent(decodeURIComponent(key))\\n   \\n     let search=request(qqUrl,{\\n        headers:{\\n            'X-AppId':'ddplayandroidv3',\\n            'X-AppSecret': 'pDa60YtGYCGKBpw28KfMe5iFiZuooF6V'\\n        }\\n        \\n    })\\n    return JSON.parse(search)\\n}\\n\\n\\nfunction encodeHtml(s) {\\n    let REGX_HTML_ENCODE = /â€œ|&|â€™|\\\\u003C|>|[\\\\x00-\\\\x20]|[\\\\x7F-\\\\xFF]|[\\\\u0100-\\\\u2700]/g;\\n   return s.replace(REGX_HTML_ENCODE, function($0) {\\n        var c = $0.charCodeAt(0),\\n            r = [\\\"&#\\\"];\\n        c = (c == 0x20) ? 0xA0 : c;\\n        r.push(c);\\n        r.push(\\\";\\\");\\n        return r.join(\\\"\\\");\\n    });\\n}\\n\\n\\n\\n//0é»˜è®¤ 1ç®€ä½“ 2ç¹ä½“\\n$.exports.downloadDanMu = function(episodeId, name) {\\n    let comment=basicUrl + \\\"api/v2/comment/\\\" + episodeId+\\\"?from=0&withRelated=true&chConvert=1\\\"\\n       \\n    let danMuData = JSON.parse(request(comment, {\\n        headers:{\\n            'X-AppId':'ddplayandroidv3',\\n            'X-AppSecret': 'pDa60YtGYCGKBpw28KfMe5iFiZuooF6V'\\n        }\\n        \\n    }));\\n    let dMcontext = \\\"\\\";\\n    //let fpsm = getRefreshRate()/60*0.95;\\n    //danMuData.comments.sort((v,x)=>v.p.split(\\\",\\\")[0]-x.p.split(\\\",\\\")[0]);\\n    for (let comment of danMuData.comments) {\\n        //dMcontext += `<d p=\\\"${Math.round(timepoint)},${ct},${size},${color},0\\\">${content}</d>\\\\n`;\\n        let paramText = comment.p;\\n        let commentText = comment.m;\\n        if (paramText == null || commentText == null) continue;\\n        let params = paramText.split(\\\",\\\");\\n        let paramsT = [];\\n        for (let i in params) {\\n            /*if (i == 0) {\\n                paramsT.push(parseInt(params[i]));\\n                continue;\\n            }*/\\n            if (i == 2) {\\n                paramsT.push(\\\"25\\\");\\n            }\\n            if (i == 3) {\\n                //é¢œè‰²å€¼ä¸º0æ—¶ï¼Œé»˜è®¤è®¾ç½®ä¸ºç™½è‰²\\n                if (params[i] == \\\"0\\\" || params[i] == \\\"-1\\\") {\\n                    paramsT.push(\\\"16777215\\\");\\n                    continue\\n                }\\n                break;\\n            }\\n            paramsT.push(params[i]);\\n        }\\n        paramsT.push(\\\"0\\\");\\n        let times=parseInt(params[0]/60)+\\\":\\\"+parseInt(params[0]%60);\\n        dMcontext += `<d p=\\\"${paramsT.join(',')}\\\">${encodeHtml(commentText)/*+\\\"#\\\"+times*/}</d>\\\\n`;\\n    }\\n    if (!dMcontext) return;\\n    dMcontext = `<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><i>\\\\n${dMcontext}</i>`;\\n    let path = sevePath + name.replace(/\\\\//g, \\\"_\\\") + \\\"_\\\" + episodeId + \\\".xml\\\";\\n    writeFile(path, dMcontext);\\n    return path;\\n}\\n$.exports.getLocalDanMu = function(episodeId, name) {\\n    let path = sevePath + name.replace(/\\\\//g, \\\"_\\\") + \\\"_\\\" + episodeId + \\\".xml\\\";\\n    if (fileExist(path)) {\\n        return path;\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"å¼¹å¹•æœç´¢&åŠ è½½\",\"path\":\"loadDm\",\"rule\":\"js:\\nlet d = [];\\nlet onlyDownload = !!MY_PARAMS.onlyDownload;\\nif (onlyDownload) {\\n    addListener(\\\"onClose\\\", () => {\\n        refreshPage(false);\\n    });\\n}\\nd.push({\\n    col_type: \\\"rich_text\\\",\\n    title: \\\"<font color='Gray'>â—å…³äº<br><small> å†…ç½®æœç´¢Pæ•°æ®æ¥æºäº[å¼¹å¼¹play]</small></font>\\\"\\n});\\nd.push({\\n    col_type: \\\"line\\\"\\n});\\nlet key = MY_PARAMS.name || getMyVar(\\\"s\\\") || decodeURIComponent(getParam(\\\"title\\\", \\\"\\\")) || \\\"\\\";\\nd.push({\\n    title: \\\"å†…ç½®æœç´¢P\\\",\\n    url: $(key, \\\"è¯·æœç´¢ç•ªå‰§åç§°\\\").input((MY_PARAMS) => {\\n        setPageParams(Object.assign(MY_PARAMS, {\\n            name: input,\\n        }));\\n        refreshPage();\\n    }, MY_PARAMS),\\n    col_type: \\\"text_3\\\"\\n});\\nd.push({\\n    title: \\\"å†…ç½®æœç´¢T\\\",\\n    url: $(key, \\\"æ ¼å¼ï¼šæœç´¢å…³é”®è¯[å›è½¦]é›†æ•°\\\").input((onlyDownload) => {\\n        try {\\n            showLoading(\\\"æ­£åœ¨æœç´¢å¹¶ä¸‹è½½...\\\");\\n            let [name, pos] = input.split(\\\"\\\\n\\\");\\n            if (!name || !pos) {\\n                throw \\\"æ ¼å¼é”™è¯¯\\\";\\n            }\\n            let urlInfo = fetch(buildUrl(\\\"https://azure.leuse.top/searchdm\\\", {\\n                params: {\\n                    \\\"name\\\": name,\\n                    \\\"pos\\\": pos\\n                }\\n            }));\\n            urlInfo = JSON.parse(urlInfo);\\n            if (!urlInfo.url) throw \\\"æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°è¯¥è§†é¢‘çš„å¼¹å¹•\\\";\\n            let xml = fetch(buildUrl(\\\"https://azure.leuse.top/danmu\\\", {\\n                params: urlInfo\\n            }));\\n            hideLoading();\\n            if (!xml) {\\n                throw \\\"è¿˜æ²¡æœ‰å¼¹å¹•å“Ÿ~\\\";\\n            }\\n            let path = \\\"hiker://files/cache/danmu/\\\" + urlInfo.platform + \\\"_\\\" + name + \\\"_\\\" + pos + \\\".xml\\\";\\n            writeFile(path, '<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\\\n' + xml);\\n            if (onlyDownload) return \\\"toast://ä¸‹è½½å®Œæˆ\\\";\\n            refreshVideoUrl({\\n                danmu: path\\n            });\\n            back(false);\\n            return \\\"toast://åŠ è½½å®Œæˆ\\\";\\n        } catch (e) {\\n            hideLoading();\\n            return \\\"toast://\\\" + e.toString();\\n        }\\n    }, onlyDownload),\\n    col_type: \\\"text_3\\\"\\n});\\nd.push({\\n    title: \\\"dmç›’å­æœç´¢\\\",\\n    url: $(\\\"#noLoading#\\\").lazyRule((key, onlyDownload) => {\\n        let dm = getVar(\\\"dm_share\\\");\\n        if (dm && !onlyDownload) {\\n            clearVar(\\\"dm_share\\\");\\n            refreshVideoUrl({\\n                danmu: dm\\n            });\\n            back(false);\\n            return \\\"toast://åŠ è½½å®Œæˆ\\\";\\n        } else {\\n            return $(key, \\\"dmç›’å­æœç´¢\\\").input(() => {\\n                toast(\\\"ä¸‹è½½å®Œæˆå¼¹å¹•åè¯·é‡æ–°ç‚¹å‡»æœç´¢\\\");\\n                return \\\"hiker://search?rule=dmç›’å­&s=\\\" + input;\\n            });\\n        }\\n    }, key, onlyDownload),\\n    col_type: \\\"text_3\\\"\\n});\\n\\nfunction search(d, name) {\\n    const danmu = $.require(\\\"danmu\\\");\\n    d.push({\\n        col_type: \\\"line\\\"\\n    });\\n    d.push({\\n        col_type: \\\"line\\\"\\n    });\\n    d.push({\\n        col_type: \\\"line\\\"\\n    });\\n    let dmList = danmu.getDanMu(name);\\n\\n    for (let anime of dmList.animes) {\\n        d.push({\\n            title: anime.animeTitle,\\n            desc: anime.typeDescription,\\n            col_type: \\\"avatar\\\",\\n            url: $(\\\"\\\", \\\"è¯·è¾“å…¥ä¸‹è½½èŒƒå›´(1,\\\" + anime.episodes.length + \\\")\\\").input((animeTitle, episodes) => {\\n                let [a, b] = input.split(/,|ï¼Œ/);\\n                a = Number(a), b = Number(b);\\n                if (Number.isNaN(a) || Number.isNaN(b)) {\\n                    return \\\"toast://è¯·æŒ‰æ ¼å¼è¾“å…¥æ•°å­—\\\";\\n                }\\n                if (a < 1 || b > episodes.length) {\\n                    return \\\"toast://è¯·è¾“å…¥è§„å®šèŒƒå›´å†…çš„æ•°å­—\\\";\\n                }\\n                const danmu = $.require(\\\"danmu\\\");\\n                try {\\n                    for (let i = a - 1, j = 1; i < b; i++, j++) {\\n                        let episode = episodes[i];\\n                        let dmTitle = animeTitle + \\\"_\\\" + episode.episodeTitle;\\n                        showLoading(\\\"æ­£åœ¨ä¸‹è½½ï¼š\\\" + episode.episodeTitle + \\\"\\\\t(\\\" + j + \\\"/\\\" + (b - a + 1) + \\\")\\\");\\n                        danmu.downloadDanMu(episode.episodeId, dmTitle);\\n                    }\\n                } catch (e) {\\n                    log(e.toString());\\n                    hideLoading();\\n                    return \\\"toast://å“¦å“¦ä¸‹è½½å¤±è´¥...\\\";\\n                }\\n                hideLoading();\\n                return \\\"toast://ä¸‹è½½å®Œæˆ\\\";\\n            }, anime.animeTitle, anime.episodes),\\n            pic_url: \\\"http://123.56.105.145/tubiao/movie/14.svg\\\"\\n        });\\n        d.push({\\n            col_type: \\\"line\\\"\\n        });\\n        for (let episode of anime.episodes) {\\n            let dmTitle = anime.animeTitle + \\\"_\\\" + episode.episodeTitle;\\n            d.push({\\n                title: episode.episodeTitle,\\n                url: $(episode.episodeId).lazyRule((url, title, onlyDownload) => {\\n                    const danmu = $.require(\\\"danmu\\\");\\n                    let path = danmu.getLocalDanMu(input, title) || danmu.downloadDanMu(input, title);\\n                    if (onlyDownload) return \\\"toast://ä¸‹è½½å®Œæˆ\\\";\\n                    let danmuText = fetch(path);\\n                    if (!danmuText) return \\\"toast://è¿˜æ²¡æœ‰å¼¹å¹•å“Ÿ~\\\";\\n                    refreshVideoUrl({\\n                        danmu: path\\n                    });\\n                    back(false);\\n                    return \\\"toast://åŠ è½½å®Œæˆ\\\";\\n                }, MY_PARAMS.durl, dmTitle, onlyDownload),\\n                col_type: \\\"text_1\\\",\\n                extra: {\\n                    longClick: [{\\n                        title: \\\"å¼ºåˆ¶ä¸‹è½½\\\",\\n                        js: $.toString((episodeTitle, episodeId) => {\\n                            showLoading(\\\"è¯·ç­‰å¾…\\\");\\n                            const danmu = $.require(\\\"danmu\\\");\\n                            danmu.downloadDanMu(episodeId, episodeTitle);\\n                            hideLoading();\\n                            return \\\"toast://é‡æ–°ä¸‹è½½å®Œæˆï¼Œå•å‡»æŒ‚è½½ã€‚\\\";\\n                        }, dmTitle, episode.episodeId)\\n                    }]\\n                }\\n            });\\n        }\\n        d.push({\\n            col_type: \\\"line_blank\\\"\\n        });\\n    }\\n    if (!dmList.animes.length) {\\n        d.push({\\n            title: \\\"æ²¡æœ‰æ‰¾åˆ°ä¸[\\\" + name + \\\"]ç›¸å…³çš„å¼¹å¹•\\\",\\n            url: \\\"hiker://empty\\\",\\n            desc: \\\"æœä¸åˆ°æ€ä¹ˆåŠï¼Ÿ\\\\næ£€æŸ¥åç§°æ˜¯å¦æ­£ç¡®ï¼›å¯ä»¥å°è¯•åˆ é™¤éƒ¨åˆ†é™å®šè¯ï¼Œå¦‚ç¬¬ä¸€å­£ç­‰ï¼›è€Œä¸”åªèƒ½æœç´¢ç•ªå‰§å“¦ï¼å…¶ä»–å¼¹å¹•å¯ç”¨dmç›’å­ã€‚\\\",\\n            col_type: \\\"text_center_1\\\"\\n        });\\n    }\\n}\\nlet name = getParam(\\\"name\\\", MY_PARAMS.name);\\nif (name) {\\n    try {\\n        search(d, name);\\n    } catch (e) {\\n        d.push({\\n            title: \\\"â€œâ€œERRORâ€â€\\\",\\n            desc: e.toString(),\\n            col_type: \\\"text_1\\\"\\n        });\\n    }\\n}\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"å…¬å¼€å·¥å…·\",\"path\":\"aliUtil\",\"rule\":\"//æä¾›ç»™è§„åˆ™ä½¿ç”¨çš„å¸¸ç”¨å‡½æ•°\\n$.exports = {\\n    checkali(realurl) {\\n        try {\\n            if (realurl.includes(\\\"com/s/\\\") && realurl != \\\"\\\") {\\n                let shareId = realurl.split(\\\"?\\\")[0].split(\\\"/\\\")[4];\\n                let share = fetch(\\\"https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous\\\", {\\n                    headers: {\\n                        'content-type': 'application/json',\\n                        \\\"User-Agent\\\": PC_UA,\\n                        \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n                    },\\n                    body: {\\n                        \\\"share_id\\\": shareId\\n                    },\\n                    method: 'POST'\\n                });\\n                if (share.includes(\\\"share_link is\\\") || share.includes(\\\"share_link cannot\\\")) return false;\\n            }\\n        } catch (e) {}\\n        return true;\\n    },\\n    bytesToSize(size) {\\n        if (!size) {\\n            return '0';\\n        }\\n        const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\\n        let i = 0;\\n        while (size >= 1024) {\\n            size /= 1024;\\n            i++;\\n        }\\n        size = i ? Number(size.toFixed(2)) : size;\\n        return `${size} ${units[i]}`;\\n    },\\n    getCryptoJS() {\\n        if (typeof CryptoJS === \\\"undefined\\\") {\\n            eval(getCryptoJS());\\n            return CryptoJS;\\n        }\\n        return CryptoJS;\\n    },\\n    matchAliUrl(text, isG) {\\n        return $.require(\\\"alitest\\\").matchAliUrl(text, isG);\\n    },\\n    getIPv4Address() {\\n        const NetworkInterface = java.net.NetworkInterface;\\n        try {\\n            for (let en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();) {\\n                let intf = en.nextElement();\\n                for (let enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements();) {\\n                    let inetAddress = enumIpAddr.nextElement();\\n                    if (!inetAddress.isLoopbackAddress() && inetAddress instanceof java.net.Inet4Address) {\\n                        return String(inetAddress.getHostAddress());\\n                    }\\n                }\\n            }\\n        } catch (ex) {\\n            log(ex.toString());\\n        }\\n        return \\\"0.0.0.0\\\";\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"å¼¹å¹•æ‰¹é‡æŒ‚è½½\",\"path\":\"dmMount\",\"rule\":\"js:\\nlet d = [];\\naddListener(\\\"onClose\\\", () => clearMyVar(\\\"dllastTime\\\"));\\nsetPageTitle(\\\"å¼¹å¹•æŒ‚è½½:\\\"+(MY_PARAMS.folderName||\\\"?\\\"));\\nd.push({\\n    title: \\\"æ¸…ç©ºæŒ‚è½½åˆ—è¡¨\\\",\\n    url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n        clearMyVar(\\\"dmlist\\\");\\n        refreshPage(false);\\n        return \\\"hiker://empty\\\";\\n    }),\\n    col_type: \\\"text_3\\\",\\n});\\nif(!MY_PARAMS.automaticadd){\\n    MY_PARAMS.automaticadd = getItem(\\\"automaticadd\\\",\\\"1\\\");\\n    setPageParams(MY_PARAMS);\\n}\\nd.push({\\n    title: \\\"æ£€æµ‹æ–°å¢:\\\"+[\\\"å…³é—­\\\",\\\"å¼€å¯\\\"][MY_PARAMS.automaticadd||\\\"0\\\"],\\n    url: $(\\\"#noLoading#\\\").lazyRule((v) => {\\n       setItem(\\\"automaticadd\\\", v.automaticadd===\\\"1\\\"?\\\"0\\\":\\\"1\\\");\\n       v.automaticadd = undefined;\\n       setPageParams(v);\\n       refreshPage(false);\\n       return \\\"hiker://empty\\\";\\n    }, MY_PARAMS),\\n    col_type: \\\"text_3\\\",\\n});\\nd.push({\\n    title: \\\"ä¸‹è½½å¼¹å¹•\\\",\\n    col_type: \\\"text_3\\\",\\n    url: \\\"hiker://page/loadDm#noHistory##noRecordHistory#\\\",\\n    extra: {\\n        onlyDownload: true,\\n        name: MY_PARAMS.name||decodeURIComponent(getParam(\\\"name\\\",\\\"\\\"))\\n    }\\n});\\nd.push({\\n    col_type: \\\"line_blank\\\"\\n});\\nd.push({\\n    title: \\\"â€œâ€œâ€â€\\\" + \\\"å·²æŒ‚è½½\\\".big(),\\n    url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n        let dmlist = storage0.getMyVar(\\\"dmlist\\\", []);\\n        let FileSorting = $.require(\\\"FileSorting\\\");\\n        dmlist.sort((a, b) => FileSorting.nameCompare(a, b));\\n        storage0.putMyVar(\\\"dmlist\\\", dmlist);\\n        refreshPage(false);\\n        return \\\"toast://æ’åºå®Œæˆ\\\";\\n    }),\\n    col_type: \\\"text_center_1\\\"\\n});\\nlet file = $.require(\\\"http://123.56.105.145/weisyr/js/file.js?v=1\\\");\\nlet dmlist = storage0.getMyVar(\\\"dmlist\\\", []);\\n\\nfor (let i = 0; i < dmlist.length; i++) {\\n    let dmname = dmlist[i];\\n    d.push({\\n        title: \\\"[\\\" + (i + 1) + \\\"]\\\\t\\\" + dmname,\\n        url: $(\\\"#noLoading#\\\").lazyRule((i) => {\\n            let dmlist = storage0.getMyVar(\\\"dmlist\\\", []);\\n            dmlist.splice(i, 1);\\n            storage0.putMyVar(\\\"dmlist\\\", dmlist);\\n            refreshPage(false);\\n            return \\\"hiker://empty\\\";\\n        }, i),\\n        col_type: \\\"text_1\\\"\\n    });\\n}\\nd.push({\\n    col_type: \\\"line_blank\\\"\\n});\\nd.push({\\n    title: \\\"â€œâ€œâ€â€\\\" + \\\"æœ¬åœ°æœªæŒ‚è½½\\\".big(),\\n    url: $(\\\"æ˜¯å¦æ¸…é™¤æ‰€æœ‰æœ¬åœ°å¼¹å¹•æ–‡ä»¶?\\\\n(å¼¹å¹•æ–‡ä»¶æ¯ä¸‰å¤©ä¼šè‡ªåŠ¨æ¸…é™¤)\\\").confirm(() => {\\n        let file = $.require(\\\"http://123.56.105.145/weisyr/js/file.js?v=1\\\");\\n        file.deleteFiles(getPath(\\\"hiker://files/cache/danmu/\\\").slice(7));\\n        clearMyVar(\\\"dmlist\\\");\\n        refreshPage(false);\\n        return \\\"toast://å·²åˆ é™¤\\\";\\n    }),\\n    col_type: \\\"text_center_1\\\"\\n});\\nlet dmListPath = getPath(\\\"hiker://files/cache/danmu/\\\").slice(7);\\nlet fileList = file.getFilePath(dmListPath, \\\"file\\\", \\\".xml\\\");\\nlet lastTime = 0;\\n\\nfor (let i = 0; i < fileList.length; i++) {\\n    let dmfile = fileList[i];\\n    lastTime = Math.max(lastTime, dmfile.lastModified);\\n    if (dmlist.includes(dmfile.name)) continue;\\n    d.push({\\n        title: dmfile.name,\\n        url: $(\\\"#noLoading#\\\").lazyRule((name) => {\\n            let dmlist = storage0.getMyVar(\\\"dmlist\\\", []);\\n            if (!dmlist.includes(name)) {\\n                dmlist.push(name);\\n            }\\n            storage0.putMyVar(\\\"dmlist\\\", dmlist);\\n            refreshPage(false);\\n            return \\\"hiker://empty\\\";\\n        }, dmfile.name),\\n        col_type: \\\"text_1\\\"\\n    });\\n}\\nlet lastRecord = Number(getMyVar(\\\"dllastTime\\\", \\\"-1\\\"));\\n\\nif (MY_PARAMS.automaticadd===\\\"1\\\"&&lastRecord!=-1&&lastRecord < lastTime) {\\n    confirm({\\n        title: \\\"æ–°å¼¹å¹•æ–‡ä»¶\\\",\\n        content: \\\"æ£€æŸ¥åˆ°æ–°ä¸‹è½½çš„å¼¹å¹•æ˜¯å¦å…¨éƒ¨æŒ‚è½½ï¼Ÿ\\\",\\n        confirm: $.toString((lastRecord, dmListPath) => {\\n            let file = $.require(\\\"http://123.56.105.145/weisyr/js/file.js?v=1\\\");\\n            let fileList = file.getFilePath(dmListPath, \\\"file\\\", \\\".xml\\\");\\n            let dmlist = storage0.getMyVar(\\\"dmlist\\\", []);\\n            fileList.forEach(v => {\\n                if (!dmlist.includes(v.name)&&v.lastModified > lastRecord) {\\n                    dmlist.push(v.name);\\n                }\\n            });\\n            storage0.putMyVar(\\\"dmlist\\\", dmlist);\\n            refreshPage(false);\\n            return \\\"toast://æŒ‚è½½æˆåŠŸã€‚\\\";\\n        }, lastRecord, dmListPath),\\n    });\\n}\\nif(lastTime>=0){\\n    putMyVar(\\\"dllastTime\\\", \\\"\\\" + lastTime);\\n}\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"ä¸»é¡µå¤„ç†\",\"path\":\"Main\",\"rule\":\"if (getItem(\\\"first\\\") == MY_RULE.version) {\\n    $.require(\\\"sou\\\");\\n} else if (MY_PAGE === 1) {\\n    let d = []\\n    let time = getItem(\\\"first\\\", \\\"\\\") ? 6 : 20;\\n    let id = Date.now();\\n    let subPass = \\\"æµ·é˜”è§†ç•Œè§„åˆ™åˆ†äº«ï¼Œå½“å‰åˆ†äº«çš„æ˜¯ï¼šåˆé›†è§„åˆ™è®¢é˜…ï¿¥home_subï¿¥äº‘ç›˜å›.ç®€@@http://hiker.nokia.press/hikerule/rulelist.json?id=6591&debug=true\\\";\\n    let content = `\\n    1. æœ¬å°ç¨‹åºæ‰€æœ‰ä»£ç å…¨éƒ¨å¼€æºï¼Œä¸”æœ¬è§„åˆ™ä¸ºå­¦ä¹ ç›®çš„ï¼Œè¯·äºå¯¼å…¥24å°æ—¶å†…åˆ é™¤ï¼ï¼ï¼\\n    2. æœ¬å°ç¨‹åº<b>å®Œå…¨å…è´¹</b>ï¼Œå¦‚æœä½ æ˜¯ä»˜è´¹è´­ä¹°çš„æ­å–œä½ è¢«éª—äº†ã€‚\\n    å½“ç„¶å¦‚æœæœ‰èƒ½åŠ›æƒ³é¼“åŠ±ä½œè€…çš„å¯ä»¥${\\\"æ”¯æŒä¸€ä¸‹\\\".link(\\\"hiker://page/Donate.v#noHistory##noRecordHistory#\\\")}</a>(<small>ç‚¹å‡»å¯è¿›å…¥æèµ ï¼Œå¯åœ¨ä¸»é¡µèœå•è¿›å…¥</small>)ã€‚\\n    3. æœ¬å°ç¨‹åºæ˜¯åœ¨åŸç‰ˆã€Œäº‘ç›˜å›ã€çš„åŸºç¡€è¿›è¡Œçš„äºŒæ¬¡ä¿®æ”¹ï¼Œè¯·æ”¯æŒåŸç‰ˆã€‚\\n    4. è¯·ã€Œäº‘ç›˜å›.ç®€ã€çš„äºŒæ¬¡ä¿®æ”¹å°Šé‡ä¸€ä¸‹åŸç‰ˆï¼Œè°¢è°¢ã€‚\\n    \\n    <b>å¼€å§‹ä½¿ç”¨æœ¬è§„åˆ™å³ä»£è¡¨éµå®ˆè§„åˆ™æ¡ä¾‹</b>\\n    å½“å‰ç‰ˆæœ¬ï¼š${MY_RULE.version}\\n    å¦‚æœä½ æƒ³ä¿æŒæœ€æ–°ç‰ˆè¯·${\\\"è®¢é˜…æ­¤è§„åˆ™\\\".link(\\\"rule://\\\" + base64Encode(subPass))}\\n    `;\\n    let updateInfo = \\\"ä¿®å¤å›¾æ ‡å¼‚å¸¸\\\";\\n    \\n    d.push({\\n        title: \\\"â€œâ€œâ€â€<strong>ä½¿ç”¨å‰é¡»çŸ¥</strong>\\\".big(),\\n        col_type: \\\"text_center_1\\\",\\n        url: \\\"hiker://empty\\\",\\n        extra: {\\n            lineVisible: false\\n        }\\n    });\\n    d.push({\\n        title: content.trim().replace(/\\\\n\\\\s*?/g, \\\"<br>\\\"),\\n        \\\"col_type\\\": \\\"rich_text\\\"\\n    }, {\\n        col_type: \\\"line\\\"\\n    }, {\\n        title: time + \\\"ç§’åç»§ç»­\\\",\\n        url: \\\"toast://è¯·è®¤çœŸé˜…è¯»ä»¥ä¸Šå†…å®¹\\\",\\n        col_type: \\\"text_center_1\\\",\\n        extra: {\\n            id: id + \\\"timer\\\"\\n        }\\n    });\\n    if (updateInfo) {\\n        confirm({\\n            title: \\\"æ›´æ–°å†…å®¹\\\",\\n            content: updateInfo,\\n            confirm(){},\\n            cancel(){}\\n        });\\n    }\\n    setResult(d);\\n    while (time != 0) {\\n        java.lang.Thread.sleep(1000);\\n        time -= 1;\\n        updateItem(id + \\\"timer\\\", {\\n            title: time + \\\"ç§’åç»§ç»­\\\"\\n        });\\n    }\\n    updateItem(id + \\\"timer\\\", {\\n        title: \\\"â€œâ€œæˆ‘åŒæ„ä»¥ä¸Šè¦æ±‚â€â€\\\",\\n        url: $(\\\"#noLoading#\\\").lazyRule((v) => {\\n            setItem(\\\"first\\\", String(v));\\n            refreshPage();\\n            return \\\"toast://æ„Ÿè°¢æ‚¨çš„ç†è§£\\\";\\n        }, MY_RULE.version),\\n        col_type: \\\"text_center_1\\\"\\n    });\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"æèµ \",\"path\":\"Donate.v\",\"rule\":\"js:\\nlet d = [];\\nsetPageTitle(\\\"æèµ /æ”¯æŒ\\\");\\nd.push({\\n    title: \\\"æèµ /æ”¯æŒ\\\",\\n    desc: \\\"è¿™ä¸ªæèµ ä¸èƒ½ä¸ºä½ å¸¦æ¥ç‰¹æƒï¼Œä½†æ‚¨çš„æ”¯æŒæ˜¯æˆ‘æ›´æ–°åˆ›ä½œçš„åŠ¨åŠ›ã€‚\\\",\\n    col_type: \\\"text_center_1\\\",\\n    url: \\\"toast://æ„Ÿè°¢æ‚¨çš„æ”¯æŒ\\\"\\n});\\nd.push({\\n    col_type: \\\"pic_1_full\\\",\\n    url: \\\"https://gitee.com/LoyDgIk/LoyDgIk_Rule/raw/master/67d8f0187f0186c1.png\\\",\\n    pic_url: \\\"https://gitee.com/LoyDgIk/LoyDgIk_Rule/raw/master/67d8f0187f0186c1.png\\\"\\n});\\nd.push({\\n    col_type: \\\"text_center_1\\\",\\n    title: \\\"â€œâ€œâ€â€\\\" + \\\"å›¾ç‰‡åŠ è½½ç¼“æ…¢è¯·ç¨ç­‰\\\".small().fontcolor(\\\"Gray\\\"),\\n    url: \\\"hiker://empty\\\",\\n    extra: {\\n        lineVisible: false\\n    }\\n});\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"TVBOXæ¨é€\",\"path\":\"tvboxPush\",\"rule\":\"js:\\n(function() {\\n    let d = [];\\n    const {\\n        pageId,\\n        shareId,\\n        folderName,\\n        fileId\\n    } = MY_PARAMS;\\n    setPageTitle(\\\"TVBOXæ¨é€:\\\" + folderName);\\n    const {\\n        aliTokensFilepath\\n    } = $.require(\\\"tokenPath\\\");\\n    let refreshToken = \\\"\\\";\\n    if (!fileExist(aliTokensFilepath)) {\\n        toast(\\\"è¯·å…ˆç™»é™†ç™»å½•è´¦å·\\\");\\n        back(false);\\n        return;\\n    } else {\\n        refreshToken = $.require(aliTokensFilepath).refresh_token;\\n    }\\n\\n    function getPush(name, url) {\\n        let push = {\\n            \\\"share_id\\\": shareId,\\n            \\\"refresh_token\\\": refreshToken,\\n            \\\"name\\\": name,\\n            \\\"url\\\": url\\n        };\\n        return \\\"hiker://page/push#noHistory##noRecordHistory#?rule=XYQæ¨é€&pushurl=\\\" + encodeURIComponent(JSON.stringify(push));\\n    }\\n    d.push({\\n        title: \\\"æ¨é€é˜¿é‡Œåˆ†äº«é“¾æ¥\\\",\\n        url: \\\"hiker://page/push#noHistory##noRecordHistory#?rule=XYQæ¨é€&pushurl=\\\" + encodeURIComponent(\\\"https://www.aliyundrive.com/s/\\\" + shareId + (fileId ? \\\"/folder/\\\" + fileId : \\\"\\\")),\\n        col_type: \\\"text_2\\\",\\n        extra: {\\n            inheritTitle: false\\n        }\\n    });\\n    let all = {\\n        title: \\\"æ¨é€å…¨éƒ¨å·²åŠ è½½è§†é¢‘\\\",\\n        col_type: \\\"text_2\\\",\\n        url: \\\"hiker://empty\\\",\\n        extra: {\\n            inheritTitle: false\\n        }\\n    }\\n    d.push(all);\\n    let allUrls = [];\\n    let list = findItemsByCls(\\\"v\\\" + pageId);\\n    if (!Array.isArray(list) || list.length === 0) {\\n        /*toast(\\\"è¿˜æ²¡æœ‰åŠ è½½å®Œæˆçš„è§†é¢‘\\\");\\n        back(false);\\n        return;*/\\n        d.push({\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~è¿˜æœ¨æœ‰è§†é¢‘å“¦~~~\\\".fontcolor(\\\"grey\\\"),\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            extra: {\\n                lineVisible: false\\n            }\\n        });\\n        all.url = \\\"toast://æ²¡æœ‰è§†é¢‘æ— æ³•æ¨é€\\\";\\n    } else {\\n        list.forEach(v => {\\n            v.col_type = v.type;\\n            let name = v.extra.pageTitle;\\n            let url = name.replace(/\\\\#/g, '_').replace(/\\\\$/g, '_') + \\\"$video|\\\" + v.extra.id;\\n            allUrls.push(url);\\n            v.url = getPush(name, url);\\n            v.extra.cls = v.extra.id = undefined;\\n            d.push(v);\\n        });\\n        all.url = getPush(folderName, allUrls.join(\\\"#\\\"));\\n    }\\n    setResult(d);\\n})();\"},{\"col_type\":\"movie_3\",\"name\":\"å°é¢æœç´¢\",\"path\":\"frontCover\",\"rule\":\"js:\\nlet d = [];\\nlet key = getMyVar(\\\"frontcoverkey\\\", \\\"\\\");\\nd.push({\\n    title: \\\"æœç´¢\\\",\\n    col_type: \\\"input\\\",\\n    url: $.toString(() => {\\n        putMyVar(\\\"frontcoverkey\\\", input.trim());\\n        refreshPage(false);\\n    }),\\n    extra: {\\n        defaultValue: key || getMyVar(\\\"s\\\", \\\"\\\")\\n    }\\n});\\nif (key) {\\n    let r = request('https://m.douban.com/search/?query=' + encodeURIComponent(key))\\n    let list = pdfa(r, \\\".search-results&&img\\\");\\n    for (let it of list) {\\n        let pic = pdfh(it, \\\"img&&src\\\");\\n        d.push({\\n            pic_url: pic,\\n            url: $(\\\"#noLoading#\\\").lazyRule((pic) => {\\n                putMyVar(\\\"frontcoverpic\\\", pic);\\n                back(false);\\n                return \\\"toast://è®¾ç½®æˆåŠŸ\\\";\\n            }, pic),\\n            col_type: \\\"pic_2_card\\\"\\n        });\\n    }\\n\\n}\\naddListener(\\\"onClose\\\", () => {\\n    let pic = getMyVar(\\\"frontcoverpic\\\");\\n    clearMyVar(\\\"frontcoverpic\\\");\\n    clearMyVar(\\\"frontcoverkey\\\");\\n    setPagePicUrl(pic);\\n});\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™æ–‡ä»¶\",\"path\":\"configs\",\"rule\":\"const path = \\\"hiker://files/rules/LoyDgIk/aliSimpleRules.json\\\";\\nlet data;\\n\\nfunction getJson() {\\n    if (Array.isArray(data)) {\\n        return data;\\n    }\\n    try {\\n        data = JSON.parse(readFile(path) || \\\"[]\\\");\\n    } catch (e) {\\n        deleteFile(path);\\n        data = [];\\n    }\\n    return data;\\n}\\n\\nfunction saveJson(json) {\\n    saveFile(path, JSON.stringify(json));\\n}\\n\\nfunction getUsefulJson() {\\n    return getJson().filter(v => !v.forbidden);\\n}\\n\\nfunction getForbiddenJson() {\\n    return getJson().filter(v => v.forbidden);\\n}\\n\\nfunction getGroupJson(group) {\\n    return getJson().filter(v => v.group === group);\\n}\\n\\nfunction getGroupNames() {\\n    return Array.from(new Set(getJson().map(v => v.group))).filter(v => v);\\n}\\n\\nif (!fileExist(path) && MY_RULE) {\\n    let rules = $.require(\\\"rules\\\");\\n    $.hiker.window = {};\\n    eval.call(null, fetch('hiker://assets/beautify.js'));\\n    rules = rules.map((v) => {\\n        v.find = window.js_beautify(v.find.toString().replace(/function.*?\\\\(s.*?page\\\\).*?\\\\{/, \\\"\\\").replace(/(\\\\}[\\\\s\\\\S].*?)$/, \\\"\\\"));\\n        if (v.findAliUrl) {\\n            v.findAliUrl = window.js_beautify(v.findAliUrl.toString().replace(/function.*?\\\\(input\\\\).*?\\\\{/, \\\"\\\").replace(/(\\\\}[\\\\s\\\\S].*?)$/, \\\"\\\"));\\n        }\\n        return v;\\n    });\\n    saveJson(rules);\\n    toast(\\\"å·²åˆå§‹åŒ–\\\");\\n}\\n$.exports = {\\n    getJson,\\n    saveJson,\\n    getUsefulJson,\\n    getForbiddenJson,\\n    path,\\n    getGroupNames,\\n    getGroupJson\\n};\"},{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™ç®¡ç†\",\"path\":\"ruleManage\",\"rule\":\"js:\\nvar d = [];\\nsetPageTitle(\\\"è§„åˆ™ç®¡ç†\\\");\\nlet configs = $.require(\\\"configs\\\");\\nlet arr = configs.getJson();\\nlet length = arr.length;\\nlet groups = configs.getGroupNames();\\nlet group = getItem(\\\"ruleManage_group\\\", \\\"\\\");\\nif (!groups.includes(group)) {\\n    clearItem(\\\"ruleManage_group\\\");\\n    group = \\\"\\\";\\n}\\nd.push({\\n    title: \\\"æ–°å¢\\\",\\n    url: \\\"hiker://page/ruleEdit#noRecordHistory##noHistory##noRefresh#\\\",\\n    col_type: \\\"icon_small_4\\\",\\n    pic_url: \\\"hiker://images/icon_domain_config\\\",\\n    extra: {\\n        pageTitle: \\\"æ–°å¢è§„åˆ™\\\"\\n    }\\n});\\n\\nd.push({\\n    title: \\\"åˆ†äº«\\\",\\n    url: $(\\\"-1\\\", \\\"è¾“å…¥ä½ è¦åˆ†äº«è§„åˆ™çš„åºå·\\\\n-1å…¨éƒ¨ï¼Œ-2å·²å¯ç”¨çš„ï¼Œ-3å·²ç¦ç”¨çš„ï¼Œ-4,ç»„ååˆ†äº«ç»„ï¼Œå¤šä¸ªç”¨'ï¼Œ'éš”å¼€\\\").input((length) => {\\n        let indexc = input.split(/,|ï¼Œ/);\\n        let indexs = [];\\n        let mo = parseInt(indexc[0]);\\n        if (!(indexc.length !== 0 && mo < 0 && mo > -5)) {\\n            for (let it of indexc) {\\n                let num = parseInt(it);\\n                if (Number.isNaN(num) || num >= length || num < 0) {\\n                    return \\\"toast://æ•°å­—ä¸åˆæ³•\\\";\\n                }\\n                indexs.push(num);\\n            }\\n        }\\n        return $([\\\"HIKER\\\", \\\"TXT\\\"].concat(getPastes()), 2, \\\"åˆ†äº«æ–¹å¼\\\").select((mo, indexs, ext) => {\\n            function up(rules) {\\n                let ruleb64 = base64Encode(JSON.stringify(rules));\\n                let getPass = (length, rule, type) => \\\"æµ·é˜”è§†ç•Œäº‘ç®€æœç´¢å¼•æ“ï¼Œå…±ã€Œ\\\" + length + \\\"ã€æ¡ï¼Œå¤åˆ¶æ•´æ¡å£ä»¤æ‰“å¼€è½¯ä»¶å°±ä¼šè‡ªåŠ¨å¯¼å…¥$\\\" + rule + \\\"$\\\" + type + \\\"@import=js:$.require('import?rule='+\\\" + JSON.stringify(MY_RULE.title) + \\\")(input)\\\";\\n                if (getPastes().includes(input)) {\\n                    let u = sharePaste(ruleb64, input);\\n                    return \\\"copy://\\\" + getPass(rules.length, u, \\\"b\\\");\\n                } else {\\n                    let path = \\\"hiker://files/_cache/äº‘ç®€æœç´¢å¼•æ“è§„åˆ™ã€Œ\\\" + rules.length + \\\"ã€æ¡.\\\" + (input === \\\"HIKER\\\" ? \\\"hiker\\\" : \\\"txt\\\");\\n                    writeFile(path, getPass(rules.length, ruleb64, \\\"a\\\"));\\n                    return \\\"share://\\\" + path;\\n                }\\n            }\\n            let rules;\\n            if (mo === -1) {\\n                rules = $.require(\\\"configs\\\").getJson();\\n            } else if (mo === -2) {\\n                rules = $.require(\\\"configs\\\").getUsefulJson();\\n            } else if (mo === -3) {\\n                rules = $.require(\\\"configs\\\").getForbiddenJson();\\n            } else if (mo === -4) {\\n                let group = ext;\\n                rules = $.require(\\\"configs\\\").getGroupJson(ext);\\n                if (!rules.length) return \\\"toast://ä¸å­˜åœ¨è¯¥ç»„\\\";\\n            } else {\\n                rules = $.require(\\\"configs\\\").getJson().filter((v, i) => indexs.includes(i));\\n            }\\n            rules = rules.map((v) => {\\n                v.user = undefined;\\n                v.forbidden = undefined;\\n                return v;\\n            });\\n            return up(rules);\\n        }, mo, indexs, indexc[1]);\\n\\n    }, length),\\n    col_type: \\\"icon_small_4\\\",\\n    pic_url: \\\"hiker://images/icon_share_green\\\"\\n});\\nd.push({\\n    title: \\\"é‡ç½®\\\",\\n    url: $(\\\"ä½ ç¡®å®šé‡ç½®ï¼Ÿ\\\\nè¯¥æ“ä½œä¼šåˆ é™¤ç°æœ‰è§„åˆ™ï¼Œæ¢å¤è‡ªå¸¦è§„åˆ™ã€‚\\\").confirm((path) => {\\n        deleteFile(path);\\n        refreshPage(false);\\n        return \\\"hiker://empty\\\";\\n    }, $.require(\\\"configs\\\").path),\\n    col_type: \\\"icon_small_4\\\",\\n    pic_url: \\\"hiker://images/icon_refresh\\\"\\n});\\nd.push({\\n    title: \\\"æ¸…ç©º\\\",\\n    url: $(\\\"ä½ ç¡®å®šå…¨éƒ¨åˆ é™¤ï¼Ÿ\\\\nè¯¥æ“ä½œä¼šåˆ é™¤ç°æœ‰è§„åˆ™ã€‚\\\").confirm((path) => {\\n        writeFile(path, \\\"[]\\\");\\n        refreshPage(false);\\n        return \\\"hiker://empty\\\";\\n    }, $.require(\\\"configs\\\").path),\\n    col_type: \\\"icon_small_4\\\",\\n    pic_url: \\\"hiker://images/icon_code_view\\\"\\n});\\n\\nd.push({\\n    //title: '<font color=\\\"#13B61B\\\">â– </font><b>è§„åˆ™åˆ—è¡¨<b> (' + String(length).fontcolor(\\\"#ff6601\\\") + \\\")\\\",\\n    col_type: \\\"rich_text\\\",\\n});\\nlet countTitle = d.at(-1);\\nd.push({\\n    title: group ? \\\"å…¨éƒ¨\\\" : \\\"â€œâ€œå…¨éƒ¨â€â€\\\",\\n    url: $(\\\"#noLoading#\\\").lazyRule((group, length) => {\\n        if (group) {\\n            clearItem(\\\"ruleManage_group\\\");\\n            refreshPage(false);\\n            return \\\"hiker://empty\\\";\\n        } else {\\n            return $(\\\"\\\", \\\"æ‰¹é‡åˆ é™¤\\\\næ ¼å¼:å¼€å§‹ä½ç½®ï¼Œç»“æŸä½ç½®(åŒºé—´[0,\\\" + (length - 1) + \\\"])\\\").input((length) => {\\n                let [start, end] = input.split(/,|ï¼Œ/);\\n                start = parseInt(start), end = parseInt(end);\\n                if (Number.isNaN(start) || Number.isNaN(end) || start < 0 || end > length - 1 || start > end) {\\n                    return \\\"toast://æ•°å­—ä¸åˆæ³•\\\";\\n                }\\n                let number = end - start + 1;\\n                return $(\\\"ç¡®è®¤åˆ é™¤ï¼š[\\\" + start + \\\",\\\" + end + \\\"]\\\\nå…±\\\" + number + \\\"æ¡æœç´¢å¼•æ“\\\").confirm((start, number) => {\\n                    let rules = $.require(\\\"configs\\\").getJson();\\n                    rules.splice(start, number);\\n                    $.require(\\\"configs\\\").saveJson(rules);\\n                    refreshPage(false);\\n                }, start, number);\\n            }, length);\\n        }\\n    }, group, length),\\n    col_type: \\\"scroll_button\\\"\\n});\\nfor (let it of groups) {\\n    d.push({\\n        title: it === group ? \\\"â€œâ€œ\\\" + it + \\\"â€â€\\\" : it,\\n        url: $(\\\"#noLoading#\\\").lazyRule((it, group) => {\\n            if (group !== it) {\\n                setItem(\\\"ruleManage_group\\\", it);\\n                refreshPage();\\n                return \\\"hiker://empty\\\";\\n            } else {\\n                return $([\\\"ç½®é¡¶\\\", \\\"ç½®åº•\\\", \\\"æ”¹å\\\", \\\"åˆ é™¤\\\"]).select((it) => {\\n                    if (\\\"æ”¹å\\\" === input) {\\n                        return $(it, \\\"è¯·è¾“å…¥æ–°åç§°\\\").input((it) => {\\n                            let rules = $.require(\\\"configs\\\").getJson();\\n                            rules.forEach(v => {\\n                                if (it === v.group) {\\n                                    v.group = input;\\n                                }\\n                            });\\n                            $.require(\\\"configs\\\").saveJson(rules);\\n                            clearItem(\\\"ruleManage_group\\\");\\n                            refreshPage(false);\\n                        }, it);\\n                    } else if (\\\"åˆ é™¤\\\" === input) {\\n                        return $(\\\"æ˜¯å¦åˆ é™¤è¯¥ç»„æœç´¢å¼•æ“ï¼š\\\" + it).confirm((it) => {\\n                            let rules = $.require(\\\"configs\\\").getJson();\\n                            rules = rules.filter(v => v.group !== it);\\n                            $.require(\\\"configs\\\").saveJson(rules);\\n                            clearItem(\\\"ruleManage_group\\\");\\n                            refreshPage(false);\\n                        }, it);\\n                    }\\n                    let rules = $.require(\\\"configs\\\").getJson();\\n                    let tgRules = [],\\n                        txRules = [];\\n                    rules.forEach((v) => {\\n                        if (it === v.group) {\\n                            tgRules.push(v);\\n                        } else {\\n                            txRules.push(v);\\n                        }\\n                    });\\n                    if (input === \\\"ç½®é¡¶\\\") {\\n                        tgRules = tgRules.concat(txRules);\\n                    } else {\\n                        tgRules = txRules.concat(tgRules);\\n                    }\\n                    $.require(\\\"configs\\\").saveJson(tgRules);\\n                    refreshPage(false);\\n                }, it);\\n            }\\n\\n        }, it, group),\\n        col_type: \\\"scroll_button\\\"\\n    });\\n}\\n\\nlet count = d.length;\\n\\nfor (let i = 0; i < length; i++) {\\n    let it = arr[i];\\n    if (group && group !== it.group) continue;\\n    let user = it.user || {};\\n\\n    d.push({\\n        title: 'â€œâ€œâ€â€[' + i + ']<b>  ' + it.name + (it.group ? \\\"|\\\" + it.group.small() : \\\"\\\") + '<b>' + (it.forbidden ? \\\" #â€œâ€œç¦ç”¨â€â€\\\".small() : \\\"\\\") + (it.registerUrl && !(user.password || user.account || user.extra) ? \\\" #éœ€è¦ç™»å½•\\\".small() : \\\"\\\"),\\n        url: $([\\\"ç¼–è¾‘\\\", \\\"è´¦å·\\\", \\\"åˆ†äº«\\\", \\\"ç¦ç”¨/å¯ç”¨\\\", \\\"ç§»åŠ¨\\\", \\\"ç½®é¡¶\\\", \\\"åˆ é™¤\\\"], 1, \\\"æ“ä½œï¼š\\\" + it.name).select((index, length, group) => {\\n            if (input === \\\"ç¼–è¾‘\\\") {\\n                return \\\"hiker://page/ruleEdit#noRecordHistory##noHistory##noRefresh#\\\";\\n            } else if (input === \\\"è´¦å·\\\") {\\n                return \\\"hiker://page/password#noRecordHistory##noHistory##noRefresh#\\\";\\n            } else if (input === \\\"åˆ†äº«\\\") {\\n                let ops = getPastes();\\n                ops.unshift(\\\"å®Œæ•´å£ä»¤\\\");\\n                return $(ops, 2, \\\"åˆ†äº«æ–¹å¼\\\").select((index) => {\\n                    let rule = $.require(\\\"configs\\\").getJson()[index];\\n                    rule.user = undefined;\\n                    rule.forbidden = undefined;\\n                    let ruleb64 = base64Encode(JSON.stringify(rule));\\n                    let getPass = (name, rule, type) => \\\"æµ·é˜”è§†ç•Œï¼Œã€Œ\\\" + name + \\\"ã€äº‘ç®€æœç´¢å¼•æ“ï¼Œå¤åˆ¶æ•´æ¡å£ä»¤æ‰“å¼€è½¯ä»¶å°±ä¼šè‡ªåŠ¨å¯¼å…¥$\\\" + rule + \\\"$\\\" + type + \\\"@import=js:$.require('import?rule='+\\\" + JSON.stringify(MY_RULE.title) + \\\")(input)\\\";\\n                    if (input == \\\"å®Œæ•´å£ä»¤\\\") {\\n                        return \\\"copy://\\\" + getPass(rule.name, ruleb64, \\\"a\\\");\\n                    } else {\\n                        let u = sharePaste(ruleb64, input);\\n                        return \\\"copy://\\\" + getPass(rule.name, u, \\\"b\\\");\\n                    }\\n                }, index);\\n            } else if (input === \\\"ç§»åŠ¨\\\") {\\n                return $(index + \\\"\\\", \\\"è¾“å…¥ä½ç½®\\\").input((index, length) => {\\n                    let newIndex = Number(input);\\n                    if (Number.isNaN(newIndex) || newIndex >= length) {\\n                        return \\\"toast://ä¸å’Œè§„çš„ä½ç½®\\\";\\n                    }\\n                    let rules = $.require(\\\"configs\\\").getJson();\\n                    let rule = rules.splice(index, 1)[0];\\n                    rules.splice(newIndex, 0, rule);\\n                    $.require(\\\"configs\\\").saveJson(rules);\\n                    refreshPage(false);\\n                }, index, length);\\n            } else if (input === \\\"ç½®é¡¶\\\") {\\n                let newIndex = 0;\\n                let rules = $.require(\\\"configs\\\").getJson();\\n                if (group) {\\n                    newIndex = rules.findIndex(v => v.group === group);\\n                    newIndex = newIndex === -1 ? 0 : newIndex;\\n                }\\n                let rule = rules.splice(index, 1)[0];\\n                rules.splice(newIndex, 0, rule);\\n                $.require(\\\"configs\\\").saveJson(rules);\\n                refreshPage(false);\\n            } else if (input === \\\"åˆ é™¤\\\") {\\n                return $(\\\"ç¡®è®¤åˆ é™¤ï¼Ÿ\\\").confirm((index) => {\\n                    let rules = $.require(\\\"configs\\\").getJson();\\n                    let rule = rules.splice(index, 1)[0];\\n                    $.require(\\\"configs\\\").saveJson(rules);\\n                    refreshPage(false);\\n                    return \\\"toast://å·²åˆ é™¤\\\" + rule.name;\\n                }, index);\\n            } else {\\n                let arr = $.require(\\\"configs\\\").getJson();\\n                let rule = arr[index];\\n                rule.forbidden = !rule.forbidden;\\n                $.require(\\\"configs\\\").saveJson(arr);\\n                refreshPage(false);\\n                //return \\\"toast://\\\" + (rule.forbidden ? \\\"ç¦ç”¨\\\" : \\\"å¯ç”¨\\\") + rule.name;\\n            }\\n        }, i, length, group),\\n        col_type: \\\"text_1\\\",\\n        extra: {\\n            i: i,\\n            pageTitle: it.name\\n        }\\n    });\\n}\\ncountTitle.title = '<font color=\\\"#13B61B\\\">â– </font><b>è§„åˆ™åˆ—è¡¨<b> (' + ((d.length - count) + \\\"/\\\" + length).fontcolor(\\\"#ff6601\\\") + \\\")\\\";\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™ç¼–è¾‘\",\"path\":\"ruleEdit\",\"rule\":\"js:\\nvar d = [];\\n\\naddListener(\\\"onClose\\\", $.toString(() => {\\n    clearMyVar(\\\"ps_name\\\");\\n    clearMyVar(\\\"ps_find\\\");\\n    clearMyVar(\\\"ps_findAliUrl\\\");\\n    clearMyVar(\\\"ps_page\\\");\\n    clearMyVar(\\\"ps_registerUrl\\\");\\n    clearMyVar(\\\"ps_basicUrl\\\");\\n    clearMyVar(\\\"ps_group\\\");\\n    clearMyVar(\\\"ps_author\\\");\\n    clearMyVar(\\\"ps_ruleType\\\");\\n}));\\nlet urlIndex = parseInt(getParam(\\\"index\\\", \\\"\\\"));\\nurlIndex = Number.isNaN(urlIndex) ? void(0) : urlIndex;\\nlet index = void(0) === urlIndex ? MY_PARAMS.i : urlIndex;\\nlet isImport = !!getParam(\\\"isImport\\\", \\\"\\\");\\nlet arr = $.require(\\\"configs\\\").getJson();\\nlet obj;\\nif (isImport) {\\n    try {\\n        obj = $.require(\\\"hiker://files/_cache/yunSimpleImport.json\\\");\\n        let tip = index !== void(0) ? \\\"æ›´æ–°è§„åˆ™\\\" : \\\"å¯¼å…¥è§„åˆ™\\\";\\n        setPageTitle(tip + \\\":\\\" + obj.name);\\n        d.push({\\n            title: \\\"â€˜â€˜\\\" + tip + \\\"â€™â€™\\\",\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            extra: {\\n                lineVisible: false\\n            }\\n        });\\n\\n    } catch (e) {\\n        obj = {};\\n        back();\\n        toast(\\\"å¯¼å…¥é”™è¯¯\\\");\\n    }\\n} else if (index !== void(0)) {\\n    obj = arr[index];\\n    setPageTitle(\\\"ç¼–è¾‘è§„åˆ™:\\\" + obj.name);\\n    if (obj.lastModify) {\\n        d.push({\\n            title: \\\"ä¸Šæ¬¡ä¿®æ”¹ï¼š\\\" + $.dateFormat(obj.lastModify, \\\"yyyy-MM-ddÂ HH:mm:ss\\\"),\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            extra: {\\n                lineVisible: false\\n            }\\n        });\\n    }\\n} else {\\n    obj = {\\n        page: true,\\n        author: com.example.hikerview.utils.PreferenceMgr.getString(getCurrentActivity(), \\\"myName\\\", \\\"\\\")\\n    };\\n    setPageTitle(\\\"æ–°å»ºè§„åˆ™\\\");\\n}\\n\\nd.push({\\n    col_type: \\\"input\\\",\\n    desc: \\\"åå­—(å¿…å¡«)\\\",\\n    extra: {\\n        onChange: $.toString(() => {\\n            putMyVar(\\\"ps_name\\\", input);\\n        }),\\n        defaultValue: obj.name,\\n        titleVisible: false\\n    }\\n});\\nd.push({\\n    title: \\\"ç­¾å\\\",\\n    col_type: \\\"input\\\",\\n    desc: \\\"ä½œè€…(é€‰å¡«)\\\",\\n    url: $.toString(() => {\\n        let author = getMyVar(\\\"ps_author\\\", \\\"\\\");\\n        let my = String(com.example.hikerview.utils.PreferenceMgr.getString(getCurrentActivity(), \\\"myName\\\", \\\"\\\"));\\n        let newAuthor = \\\"\\\";\\n        if (author && !author.includes(my)) {\\n            newAuthor = author + \\\"&\\\" + my;\\n        } else {\\n            newAuthor = my;\\n        }\\n        updateItem(\\\"id@ps_author\\\", {\\n            extra: Object.assign(findItem(\\\"id@ps_author\\\").extra, {\\n                defaultValue: newAuthor\\n            })\\n        });\\n    }),\\n    extra: {\\n        onChange: $.toString(() => {\\n            putMyVar(\\\"ps_author\\\", input);\\n        }),\\n        defaultValue: obj.author,\\n        id: \\\"id@ps_author\\\"\\n        //titleVisible: false\\n    }\\n});\\nd.push({\\n    title: \\\"é€‰æ‹©\\\",\\n    col_type: \\\"input\\\",\\n    desc: \\\"åˆ†ç»„(é€‰å¡«)\\\",\\n    url: $.toString(() => {\\n        let group = $.require(\\\"configs\\\").getGroupNames();\\n        if (!group.length) {\\n            return \\\"\\\";\\n        }\\n        return $(group).select(() => {\\n            let extra = findItem(\\\"ruleEditGroup\\\").extra;\\n            updateItem(\\\"ruleEditGroup\\\", {\\n                extra: Object.assign(extra, {\\n                    defaultValue: input\\n                })\\n            });\\n        });\\n    }),\\n    extra: {\\n        onChange: $.toString(() => {\\n            putMyVar(\\\"ps_group\\\", input);\\n        }),\\n        id: \\\"ruleEditGroup\\\",\\n        defaultValue: obj.group,\\n    }\\n});\\nd.push({\\n    col_type: \\\"input\\\",\\n    desc: \\\"æœç´¢è§„åˆ™(å¿…å¡«)\\\\nå†…ç½®å˜é‡ï¼šsæœç´¢å…³é”®è¯ï¼Œpageé¡µæ•°ï¼ŒbasicUrlåŸºæœ¬é“¾æ¥ï¼Œuserç”¨æˆ·è´¦å·ä¿¡æ¯(user.account,user.password)\\\",\\n    extra: {\\n        type: \\\"textarea\\\",\\n        height: 3,\\n        highlight: true,\\n        onChange: $.toString(() => {\\n            putMyVar(\\\"ps_find\\\", input);\\n        }),\\n        defaultValue: obj.find,\\n        titleVisible: false,\\n    }\\n});\\nd.push({\\n    col_type: \\\"input\\\",\\n    desc: \\\"URLè§„åˆ™(é€‰å¡«)\\\\nå†…ç½®å˜é‡ï¼šinputé“¾æ¥ï¼ŒbasicUrlåŸºæœ¬é“¾æ¥\\\",\\n    extra: {\\n        type: \\\"textarea\\\",\\n        height: 3,\\n        highlight: true,\\n        onChange: $.toString(() => {\\n            putMyVar(\\\"ps_findAliUrl\\\", input);\\n        }),\\n        defaultValue: obj.findAliUrl,\\n        titleVisible: false,\\n    }\\n});\\nd.push({\\n    col_type: \\\"input\\\",\\n    desc: \\\"åŸºæœ¬é“¾æ¥(é€‰å¡«) ä»£ç ä¸­ç”¨basicUrlå¼•ç”¨\\\",\\n    extra: {\\n        onChange: $.toString(() => {\\n            putMyVar(\\\"ps_basicUrl\\\", input);\\n        }),\\n        defaultValue: obj.basicUrl,\\n        titleVisible: false,\\n    }\\n});\\nd.push({\\n    col_type: \\\"input\\\",\\n    desc: \\\"æ³¨å†Œåœ°å€(é€‰å¡«)\\\",\\n    extra: {\\n        onChange: $.toString(() => {\\n            putMyVar(\\\"ps_registerUrl\\\", input);\\n        }),\\n        defaultValue: obj.registerUrl,\\n        titleVisible: false,\\n    }\\n});\\nd.push({\\n    title: \\\"æ˜¯å¦å¯ä»¥ç¿»é¡µï¼š\\\" + obj.page,\\n    col_type: \\\"text_2\\\",\\n    url: $(\\\"#noLoading#\\\").lazyRule((page) => {\\n        let isPage = !!getMyVar(\\\"ps_page\\\", page ? \\\"1\\\" : \\\"\\\");\\n        putMyVar(\\\"ps_page\\\", isPage ? \\\"\\\" : \\\"1\\\");\\n        updateItem(\\\"ruleedps_page\\\", {\\n            title: \\\"æ˜¯å¦å¯ä»¥ç¿»é¡µï¼š\\\" + !isPage\\n        });\\n        return \\\"hiker://empty\\\";\\n    }, obj.page),\\n    extra: {\\n        id: \\\"ruleedps_page\\\"\\n    }\\n});\\nputMyVar(\\\"ps_ruleType\\\", (obj.ruleType||\\\"\\\"));\\nd.push({\\n    title: \\\"è§£ææ¨¡å¼ï¼š\\\" + (obj.ruleType || \\\"JS\\\"),\\n    col_type: \\\"text_2\\\",\\n    url: $([\\\"JS\\\", \\\"JSON\\\", \\\"HTML\\\"]).select(() => {\\n\\n        putMyVar(\\\"ps_ruleType\\\", input === \\\"JS\\\" ? \\\"\\\" : input);\\n        updateItem(\\\"ps_ruleType\\\", {\\n            title: \\\"è§£ææ¨¡å¼ï¼š\\\" + input\\n        });\\n        return \\\"hiker://empty\\\";\\n    }),\\n    extra: {\\n        id: \\\"ps_ruleType\\\"\\n    }\\n});\\nd.push({\\n    title: \\\"åˆ é™¤\\\",\\n    url: $(\\\"#noLoading#\\\").lazyRule((index, urlIndex) => {\\n        if (index === void(0)) {\\n            return \\\"toast://æ­¤é¡¹æ— æ³•åˆ é™¤\\\";\\n        }\\n        if (urlIndex !== void(0)) {\\n            return \\\"toast://æ­£åœ¨æ›´æ–°è§„åˆ™ï¼Œåˆ é™¤è¯·ä»è§„åˆ™ç®¡ç†è¿›å…¥\\\";\\n        }\\n        confirm({\\n            title: \\\"æ¸©é¦¨æç¤º\\\",\\n            content: \\\"ç¡®å®šè¦åˆ é™¤æ­¤è§„åˆ™å—ï¼Ÿæ³¨æ„åˆ é™¤åæ— æ³•æ¢å¤\\\",\\n            confirm: $.toString((index) => {\\n                let arr = $.require(\\\"configs\\\").getJson();\\n                arr.splice(index, 1);\\n                $.require(\\\"configs\\\").saveJson(arr);\\n                back(true);\\n                return \\\"toast://åˆ é™¤æˆåŠŸ\\\";\\n            }, index)\\n        });\\n        return \\\"hiker://empty\\\"\\n    }, index, urlIndex),\\n    col_type: \\\"text_3\\\",\\n});\\nd.push({\\n    title: \\\"æµ‹è¯•\\\",\\n    url: $(\\\"#noLoading#\\\").lazyRule(page => {\\n        let testKeyword = getItem(\\\"testKeyword\\\", \\\"\\\");\\n        return $(testKeyword, \\\"è¯·è¾“å…¥å…³é”®è¯\\\").input((page) => {\\n            setItem(\\\"testKeyword\\\", input);\\n            let name = getMyVar(\\\"ps_name\\\", \\\"\\\");\\n            let find = getMyVar(\\\"ps_find\\\", \\\"\\\");\\n            if (!find) {\\n                return \\\"toast://æœç´¢è§„åˆ™ä¸èƒ½ä¸ºç©º\\\";\\n            }\\n            let arr = $.require(\\\"configs\\\").getJson();\\n            let testRule = {\\n                name: name,\\n                find: find,\\n                basicUrl: getMyVar(\\\"ps_basicUrl\\\", \\\"\\\"),\\n                findAliUrl: getMyVar(\\\"ps_findAliUrl\\\", \\\"\\\"),\\n                page: !!getMyVar(\\\"ps_page\\\", page ? \\\"1\\\" : \\\"\\\"),\\n                ruleType: getMyVar(\\\"ps_ruleType\\\", \\\"\\\"),\\n            };\\n            return $(\\\"hiker://empty#noRecordHistory##noHistory#?fypage\\\").rule((testRule, key) => {\\n                if (MY_PAGE > 1 && !testRule.page) setResult([]);\\n                setResult($.require(\\\"data\\\").carryRule(testRule, key, MY_PAGE, 0));\\n            }, testRule, input);\\n        }, page);\\n    }, obj.page),\\n    col_type: \\\"text_3\\\",\\n});\\n\\n\\nd.push({\\n    title: \\\"ä¿å­˜\\\",\\n    url: $(\\\"#noLoading#\\\").lazyRule((index, page, isImport) => {\\n        let name = getMyVar(\\\"ps_name\\\", \\\"\\\");\\n        if (!name) {\\n            return \\\"toast://åå­—å¾—æœ‰ä¸€ä¸ªå§\\\";\\n        }\\n        let find = getMyVar(\\\"ps_find\\\", \\\"\\\");\\n        if (!find) {\\n            return \\\"toast://æœç´¢è§„åˆ™ä¸èƒ½ä¸ºç©º\\\";\\n        }\\n        let arr = $.require(\\\"configs\\\").getJson();\\n        let obj1 = {\\n            name: name,\\n            author: getMyVar(\\\"ps_author\\\", \\\"\\\"),\\n            find: find,\\n            basicUrl: getMyVar(\\\"ps_basicUrl\\\", \\\"\\\"),\\n            findAliUrl: getMyVar(\\\"ps_findAliUrl\\\", \\\"\\\"),\\n            page: !!getMyVar(\\\"ps_page\\\", page ? \\\"1\\\" : \\\"\\\"),\\n            registerUrl: getMyVar(\\\"ps_registerUrl\\\", \\\"\\\") || undefined,\\n            lastModify: Date.now(),\\n            group: getMyVar(\\\"ps_group\\\", \\\"\\\"),\\n            ruleType: getMyVar(\\\"ps_ruleType\\\", \\\"\\\"),\\n        };\\n        if (index === void(0)) {\\n            if (arr.some(v => v.name === name)) {\\n                return \\\"toast://å·²ç»å­˜åœ¨è¯¥è§„åˆ™\\\";\\n            }\\n            if (obj1.group) {\\n                let group = obj1.group;\\n                let index = arr.findIndex(v => v.group === group);\\n                if (index === -1) {\\n                    arr.unshift(obj1);\\n                } else {\\n                    arr.splice(index, 0, obj1);\\n                }\\n            } else {\\n                if (isImport) {\\n                    arr.push(obj1);\\n                } else {\\n                    arr.unshift(obj1);\\n                }\\n            }\\n        } else {\\n            let namey = arr[index].name;\\n            if (name !== namey) {\\n                if (arr.some(v => v.name === name)) {\\n                    return \\\"toast://å·²ç»å­˜åœ¨è¯¥è§„åˆ™\\\";\\n                }\\n            }\\n            obj1 = Object.assign(arr[index], obj1);\\n            arr.splice(index, 1, obj1);\\n        }\\n        $.require(\\\"configs\\\").saveJson(arr);\\n        back(true);\\n        return \\\"toast://ä¿å­˜æˆåŠŸ\\\";\\n    }, index, obj.page, isImport),\\n    col_type: \\\"text_3\\\",\\n});\\n\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™è´¦å·\",\"path\":\"password\",\"rule\":\"js:\\n(function() {\\n    var d = [];\\n    addListener(\\\"onClose\\\", $.toString(() => {\\n        clearMyVar(\\\"ps_account\\\");\\n        clearMyVar(\\\"ps_password\\\");\\n        clearMyVar(\\\"ps_extra\\\");\\n    }));\\n    let index = MY_PARAMS.i;\\n    let arr = $.require(\\\"configs\\\").getJson();\\n    let obj = arr[index] || {};\\n    setPageTitle(\\\"è®¾ç½®è´¦å·:\\\" + obj.name);\\n    let registerUrl = obj.registerUrl;\\n    if (registerUrl) {\\n        d.push({\\n            col_type: \\\"text_center_1\\\",\\n            title: \\\"å‰å¾€æ³¨å†Œ\\\",\\n            url: $(\\\"hiker://empty#noRecordHistory##noHistory#\\\").rule((registerUrl)=>{\\n                setResult([{\\n                    col_type:\\\"x5_webview_single\\\",\\n                    url:registerUrl,\\n                    desc:\\\"float&&100%\\\"\\n                }]);\\n            }, registerUrl),\\n            extra:{\\n                pageTitle: \\\"æ³¨å†Œè´¦å·:\\\" + obj.name\\n            }\\n        });\\n    }\\n    obj = obj.user || {};\\n    d.push({\\n        col_type: \\\"input\\\",\\n        desc: \\\"ç”¨æˆ·å\\\",\\n        extra: {\\n            onChange: $.toString(() => {\\n                putMyVar(\\\"ps_account\\\", input);\\n            }),\\n            defaultValue: obj.account,\\n            titleVisible: false\\n        }\\n    });\\n    d.push({\\n        col_type: \\\"input\\\",\\n        desc: \\\"å¯†ç \\\",\\n        extra: {\\n            type: \\\"password\\\",\\n            onChange: $.toString(() => {\\n                putMyVar(\\\"ps_password\\\", input);\\n            }),\\n            defaultValue: obj.password,\\n            titleVisible: false,\\n        }\\n    });\\n    d.push({\\n        col_type: \\\"input\\\",\\n        desc: \\\"é¢å¤–\\\",\\n        extra: {\\n            type: \\\"textarea\\\",\\n            onChange: $.toString(() => {\\n                putMyVar(\\\"ps_extra\\\", input);\\n            }),\\n            defaultValue: obj.extra,\\n            titleVisible: false,\\n            height: -1\\n        }\\n    });\\n    d.push({\\n        title: \\\"ä¿å­˜\\\",\\n        url: $(\\\"#noLoading#\\\").lazyRule((index) => {\\n            let account = getMyVar(\\\"ps_account\\\", \\\"\\\");\\n            let password = getMyVar(\\\"ps_password\\\", \\\"\\\");\\n            let extra = getMyVar(\\\"ps_extra\\\", \\\"\\\");\\n            /*if (!(account||password||extra)) {\\n                return \\\"toast://ä¸èƒ½å…¨éƒ¨ä¸ºç©º\\\";\\n            }*/\\n            let arr = $.require(\\\"configs\\\").getJson();\\n            let item = arr[index];\\n            item.user = {};\\n            item.user.account = account\\n            item.user.password = password;\\n            item.user.extra = extra;\\n            if (index === void(0)) {\\n                return \\\"toast://idé”™è¯¯\\\";\\n            } else {\\n                arr.splice(index, 1, item);\\n            }\\n            $.require(\\\"configs\\\").saveJson(arr);\\n            back(true);\\n            return \\\"toast://ä¿å­˜æˆåŠŸ\\\";\\n        }, index),\\n        col_type: \\\"text_center_1\\\",\\n    });\\n    setResult(d);\\n})()\"},{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™å¯¼å…¥\",\"path\":\"import\",\"rule\":\"js:\\nfunction saveCache(json) {\\n    writeFile(\\\"hiker://files/_cache/yunSimpleImport.json\\\", JSON.stringify(json));\\n}\\n$.exports = function(pass) {\\n    try {\\n        let [_, rule, type] = pass.split(\\\"$\\\");\\n        if (type === \\\"b\\\") {\\n            rule = parsePaste(rule);\\n        }\\n        let rules = JSON.parse(base64Decode(rule));\\n        if (!Array.isArray(rules)) {\\n            rules = [rules];\\n        }\\n        //rules.reverse();\\n        MY_URL = module.id;\\n        let ruleTitle = getParam(\\\"rule\\\");\\n        let arr = $.require(\\\"configs?rule=\\\" + ruleTitle).getJson();\\n        let newI = 0;\\n        for (let rule of rules) {\\n            let index = arr.findIndex(v => v.name === rule.name);\\n            if (index > -1) {\\n                rule = Object.assign(arr[index], rule);\\n                arr.splice(index, 1, rule);\\n                if (rules.length === 1) {\\n                    saveCache(rule);\\n                    return \\\"hiker://page/ruleEdit#noHistory##noRecordHistory#?isImport=true&index=\\\" + index + \\\"&rule=\\\" + ruleTitle;\\n                    //toast(\\\"å·²æ›´æ–°è§„åˆ™ï¼š\\\" + rule.name);\\n                } else {\\n                    log(\\\"å·²æ›´æ–°è§„åˆ™ï¼š\\\" + rule.name)\\n                }\\n            } else {\\n                newI++;\\n                arr.push(rule);\\n                if (rules.length === 1) {\\n                    saveCache(rule);\\n                    return \\\"hiker://page/ruleEdit#noHistory##noRecordHistory#?isImport=true&rule=\\\" + ruleTitle;\\n                    //toast(\\\"å·²å¯¼å…¥è§„åˆ™ï¼š\\\" + rule.name);\\n                } else {\\n                    log(\\\"å·²å¯¼å…¥è§„åˆ™ï¼š\\\" + rule.name)\\n                }\\n            }\\n        }\\n        if (rules.length > 1) {\\n            $.require(\\\"configs?rule=\\\" + ruleTitle).saveJson(arr);\\n            toast(\\\"æ–°å¢ï¼š\\\" + newI + \\\" è¦†ç›–æ›´æ–°ï¼š\\\" + (rules.length - newI));\\n        }\\n    } catch (e) {\\n        log(e.toString());\\n        toast(\\\"å¯¼å…¥å¤±è´¥\\\");\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™åˆ—è¡¨\",\"path\":\"rules\",\"rule\":\"js:\\n$.exports = [{\\n        name: \\\"å°äº‘\\\",\\n        page: true,\\n        find(s, page) {\\n            let basicUrl = \\\"https://www.yunso.net\\\";\\n            let api = \\\"/api/validate/search?wd=\\\" + encodeURIComponent(s) + \\\"&mode=90001&stype=20100&uk=&page=\\\" + page + \\\"&limit=20&screen_filetype=undefined\\\";\\n            let json = post(basicUrl + api, {\\n                body: \\\"data=\\\" + api,\\n                headers: {\\n                    Referer: \\\"https://www.yunso.net/index/user/s?wd=\\\" + encodeURIComponent(s)\\n                }\\n            });\\n            let html = JSON.parse(json).data;\\n            let list = pdfa(html, \\\"body&&.layui-card:has(a)\\\");\\n            let d = [];\\n            for (let item of list) {\\n                let title = pdfh(item, \\\"a&&Text\\\").replace(\\\"#æ–‡ä»¶å¤¹ \\\", \\\"\\\");\\n                //let time = /\\\\d{4}(-\\\\d{2}){2} \\\\d{2}(\\\\:\\\\d{2}){2}/.exec(pdfh(item, \\\".layui-card-body&&Text\\\")) || [];\\n                d.push({\\n                    title: title,\\n                    //desc: time[0],\\n                    url: base64Decode(pdfh(item, \\\"a&&url\\\"))\\n                });\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"æ··åˆç›˜\\\",\\n        page: true,\\n        find(s, page) {\\n            let url = \\\"https://api.hunhepan.com/v1/search\\\";\\n            let json = post(url, {\\n                headers: {\\n                    Referer: \\\"https://hunhepan.com/\\\"\\n                },\\n                body: JSON.stringify({\\n                    \\\"q\\\": s,\\n                    \\\"page\\\": page,\\n                    \\\"size\\\": 15\\n                })\\n            });\\n            json = JSON.parse(json);\\n            let list = json.data.list;\\n            let d = [];\\n            for (let i = 0; i < list.length; i++) {\\n                let it = list[i];\\n                if (it.disk_type !== \\\"ALY\\\" || it.share_user === \\\"ä¸¶***ä¸¶\\\") continue;\\n                d.push({\\n                    title: it.disk_name,\\n                    pic_url: pd(it, \\\"img&&src\\\", url),\\n                    url: it.link,\\n                    desc: it.update_time + \\\"\\\\n\\\" + it.link,\\n                });\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"èµ„æºå¸®\\\",\\n        page: true,\\n        find(s, page) {\\n            function search() {\\n                let rtnList = [];\\n                let resp = request(\\\"https://zyb.upyunso.com/v15/search?keyword=\\\" + en_aes(s) + \\\"&s_type=2&page=\\\" + page + \\\"&atk=&did=\\\" + generateRandomHexString(64), {\\n                    headers: {\\n                        \\\"user-agent\\\": \\\"Mozilla/5.0 (Linux; Android 10; Redmi Note 7 Build/QKQ1.190910.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/81.0.4044.138 Mobile Safari/537.36 uni-app Html5Plus/1.0 (Immersed/29.09091)\\\",\\n                    },\\n                });\\n                let respData = de_aes(resp);\\n                let jsonData = JSON.parse(respData) || {};\\n                let result = jsonData.result || {};\\n                let items = result.items || [];\\n\\n                for (let i = 0; i < items.length; i++) {\\n                    let item = items[i];\\n                    let content = item.content || [];\\n                    if (content.length == 0 || !item.page_url) continue;\\n                    let url = de_aes(item.page_url) || \\\"\\\";\\n                    if (!url) continue;\\n                    rtnList.push({\\n                        title: (item.title.length > 30 ? item.title.slice(0, 27) + \\\"...\\\" : item.title) || \\\"\\\",\\n                        desc: \\\"åˆ†äº«æ—¶é—´ï¼š\\\" + item.insert_time,\\n                        url: url\\n                    });\\n                }\\n\\n                return rtnList;\\n            }\\n\\n            function generateRandomHexString(length) {\\n                let result = \\\"\\\";\\n                const characters = \\\"0123456789abcdef\\\";\\n                const charactersLength = characters.length;\\n                for (let i = 0; i < length; i++) {\\n                    result += characters.charAt(Math.floor(Math.random() * charactersLength));\\n                }\\n                return result;\\n            }\\n            let aliUtil = $.require(\\\"aliUtil\\\");\\n            let CryptoJS = aliUtil.getCryptoJS();\\n\\n            function en_aes(e) {\\n                let i = \\\"qq1920520460qqzz\\\";\\n                // en_aes\\n                let key = CryptoJS.enc.Utf8.parse(i);\\n                var t = CryptoJS.enc.Utf8.parse(e),\\n                    r = CryptoJS.AES.encrypt(t, key, {\\n                        iv: key,\\n                        mode: CryptoJS.mode.CBC,\\n                    });\\n                return r.ciphertext.toString();\\n            }\\n\\n            function de_aes(vv) {\\n                let i = \\\"qq1920520460qqzz\\\";\\n                // de_aes\\n                let key = CryptoJS.enc.Utf8.parse(i);\\n                let hexVal = CryptoJS.enc.Hex.parse(vv),\\n                    val = CryptoJS.enc.Base64.stringify(hexVal),\\n                    decrypted = CryptoJS.AES.decrypt(val, key, {\\n                        iv: key,\\n                        mode: CryptoJS.mode.CBC,\\n                    });\\n                return decrypted.toString(CryptoJS.enc.Utf8);\\n            }\\n            return search();\\n        }\\n    }, {\\n        name: \\\"äº‘ç›˜èµ„æº\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://res.yunpan.win/?PageIndex=\\\" + page + \\\"&PageSize=12&Keyword=\\\" + s + \\\"&Type=&Tag=\\\";\\n            let html = request(url, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://res.yunpan.win/\\\"\\n                }\\n            });\\n\\n            let arr = pdfa(html, \\\"main&&.card\\\");\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = pdfh(it, \\\".card-link,1&&onclick\\\").match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n                u = u.length > 0 ? u[0] : url;\\n                d.push({\\n                    title: pdfh(it, \\\".card-title&&Text\\\"),\\n                    pic_url: pd(it, \\\"img&&src\\\", url),\\n                    url: u,\\n                    desc: pdfh(it, \\\".card-text,-1&&Text\\\") + \\\"\\\\n\\\" + u,\\n                });\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"UPäº‘æœ\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://api.upyunso2.com/search?keyword=\\\" + s + \\\"&page=\\\" + page + \\\"&s_type=1\\\";\\n            let html = request(url, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://www.upyunso.com\\\",\\n                    \\\"Cookie\\\": \\\"code=1919\\\"\\n                }\\n            });\\n            //log(base64Decode(html));\\n            let arr = JSON.parse(base64Decode(html)).result.items;\\n            //log(arr);\\n            let d = [];\\n            if (!arr) return [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = it.page_url;\\n                //u = u.length > 0 ? u[0] : url;\\n                if (!u.includes(\\\"aliyundrive\\\")) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: it.title,\\n                    url: u,\\n                    desc: \\\"\\\\n\\\" + (u),\\n                });\\n\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"çŒ«ç‹¸ç›˜æœ\\\",\\n        page: false,\\n        find: function(s, page) {\\n            let html = request(\\\"https://www.alipansou.com/search?k=\\\" + s, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://www.alipansou.com/search?k=\\\" + s\\n                }\\n            });\\n            let arr = pdfa(html, \\\"#app&&a\\\");\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = \\\"<div>\\\" + arr[i] + \\\"</div>\\\";\\n                let u = pdfh(it, \\\"a&&href\\\");\\n                //log(u);\\n                if (!u.includes(\\\"/s/\\\")) {\\n                    continue;\\n                }\\n                u = \\\"https://www.alipansou.com\\\" + u.replace(\\\"/s/\\\", \\\"/cv/\\\");\\n                d.push({\\n                    title: pdfh(it, \\\"template&&Text\\\"),\\n                    url: u,\\n                    desc: pdfh(it, \\\"template,1&&Text\\\"),\\n                });\\n            }\\n            return d;\\n        },\\n        findAliUrl(input) {\\n            let html = request(input, {\\n                headers: {\\n                    \\\"Cookie\\\": \\\"no_show_donate=1\\\",\\n                    \\\"Referer\\\": input.replace(\\\"/cv/\\\", \\\"/s/\\\")\\n                },\\n                redirect: false\\n            });\\n            html = parseDomForHtml(html, 'a&&href');\\n            if (html.length > 0) {\\n                return html;\\n            } else {\\n                return input;\\n            }\\n        }\\n    },\\n    {\\n        name: \\\"æ˜“æœ\\\",\\n        page: true,\\n        registerUrl: \\\"https://yiso.fun\\\",\\n        find: function(s, page) {\\n            let aliUtil = $.require(\\\"aliUtil\\\");\\n            let CryptoJS = aliUtil.getCryptoJS();\\n\\n            function keyen(str) {\\n                var key = CryptoJS.enc.Utf8.parse(\\\"4OToScUFOaeVTrHE\\\"),\\n                    iv = CryptoJS.enc.Utf8.parse(\\\"9CLGao1vHKqm17Oz\\\");\\n                var encrypted = CryptoJS.AES.decrypt({\\n                    ciphertext: CryptoJS.enc.Base64.parse(str)\\n                }, key, {\\n                    iv: iv,\\n                    mode: CryptoJS.mode.CBC,\\n                    padding: CryptoJS.pad.Pkcs7\\n                }).toString(CryptoJS.enc.Utf8);\\n                return encrypted;\\n            }\\n            let html = request(\\\"https://yiso.fun/api/search?name=\\\" + s + \\\"&pageNo=\\\" + page, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://yiso.fun/info?searchKey=\\\" + s,\\n                    \\\"Cookie\\\": getItem('yisoucooke', '')\\n                }\\n            });\\n            //log(html);\\n            if (html.includes('ç™»å½•ç”¨æˆ·æ— é™åˆ¶')) {\\n                var i = 0;\\n                do {\\n                    var tyimglin = 'https://yiso.fun/api/user/login/captcha?t=' + parseInt(new Date().getTime()) + '';\\n                    let img = convertBase64Image(tyimglin).split(',')[1];\\n                    let cod = request('https://api.xhofe.top/ocr/b64/text', {\\n                        headers: {\\n                            'Content-Type': 'text/plain'\\n                        },\\n                        body: img,\\n                        method: 'POST'\\n                    });\\n                    var ver = JSON.parse(request('https://yiso.fun/api/user/login', {\\n                        headers: {\\n                            'content-type': 'application/json',\\n                            'referer': 'https://yiso.fun/login',\\n                            'Cookie': getCookie(tyimglin)\\n                        },\\n                        body: {\\n                            \\\"userName\\\": user.account,\\n                            \\\"password\\\": user.password,\\n                            \\\"code\\\": cod\\n                        },\\n                        method: 'POST'\\n                    }));\\n                    if (ver.code == 200) {\\n                        log('æ˜“æœç™»å…¥éªŒè¯æˆåŠŸ');\\n                        setItem('yisoucooke', getCookie('https://yiso.fun'));\\n                        html = request(\\\"https://yiso.fun/api/search?name=\\\" + s + \\\"&pageNo=\\\" + page, {\\n                            headers: {\\n                                \\\"Referer\\\": \\\"https://yiso.fun/info?searchKey=\\\" + s,\\n                                \\\"Cookie\\\": getItem('yisoucooke', '')\\n                            }\\n                        });\\n                        break;\\n                    }\\n                    i++;\\n                } while (i < 4);\\n\\n            }\\n            let arr = JSON.parse(html).data.list;\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = keyen(it.url);\\n                //log(u);\\n                if (u == null || !u.includes(\\\"aliyun\\\")) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: it.name,\\n                    url: u,\\n                    desc: (it.gmtShare || it.gmtCreate) + \\\"\\\\n\\\" + (u),\\n                });\\n\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"å°çº¸æ¡\\\",\\n        page: false,\\n        find: function(s, page) {\\n            let aliUtil = $.require(\\\"aliUtil\\\");\\n\\n            function gettoken() {\\n                if (getMyVar('xzytoken', '').length == 0) {\\n                    let token = JSON.parse(post('https://gitcafe.net/tool/alipaper/', {\\n                        headers: {\\n                            'Referer': 'https://u.gitcafe.ink/'\\n                        },\\n                        body: {\\n                            action: 'get_token'\\n                        }\\n                    })).data;\\n                    putMyVar('xzttoken', token);\\n                }\\n                return getMyVar('xzttoken', '');\\n            }\\n\\n            function cat_code(a) {\\n                var d, e, b = [\\\"åè¯­ç”µè§†\\\", \\\"æ—¥éŸ©ç”µè§†\\\", \\\"æ¬§ç¾ç”µè§†\\\", \\\"å…¶ä»–ç”µè§†\\\", \\\"åè¯­ç”µå½±\\\", \\\"æ—¥éŸ©ç”µå½±\\\", \\\"æ¬§ç¾ç”µå½±\\\", \\\"å…¶ä»–ç”µå½±\\\", \\\"åè¯­åŠ¨æ¼«\\\", \\\"æ—¥éŸ©åŠ¨æ¼«\\\", \\\"æ¬§ç¾åŠ¨æ¼«\\\", \\\"çºªå½•ç‰‡\\\", \\\"ç»¼è‰ºç‰‡\\\", \\\"æ•™è‚²åŸ¹è®­\\\", \\\"å…¶ä»–è§†é¢‘\\\", \\\"åè¯­éŸ³ä¹\\\", \\\"æ—¥éŸ©éŸ³ä¹\\\", \\\"æ¬§ç¾éŸ³ä¹\\\", \\\"å…¶ä»–éŸ³ä¹\\\", \\\"å¨±ä¹è½¯ä»¶\\\", \\\"ç³»ç»Ÿè½¯ä»¶\\\", \\\"ç½‘ç»œè½¯ä»¶\\\", \\\"åŠå…¬è½¯ä»¶\\\", \\\"å…¶ä»–è½¯ä»¶\\\", \\\"æ¼«ç”»\\\", \\\"å°è¯´\\\", \\\"å‡ºç‰ˆä¹¦\\\", \\\"çŸ¥è¯†åŸ¹è®­\\\", \\\"å…¶ä»–æ–‡æ¡£\\\", \\\"å£çº¸\\\", \\\"äººç‰©\\\", \\\"é£æ™¯\\\", \\\"å…¶ä»–å›¾ç‰‡\\\", \\\"å…¶ä»–\\\"],\\n                    c = [\\\"hyds\\\", \\\"rhds\\\", \\\"omds\\\", \\\"qtds\\\", \\\"hydy\\\", \\\"rhdy\\\", \\\"omdy\\\", \\\"qtdy\\\", \\\"hydm\\\", \\\"rhdm\\\", \\\"omdm\\\", \\\"jlp\\\", \\\"zyp\\\", \\\"jypx\\\", \\\"qtsp\\\", \\\"hyyy\\\", \\\"rhyy\\\", \\\"omyy\\\", \\\"qtyy\\\", \\\"kfrj\\\", \\\"xtrj\\\", \\\"wlrj\\\", \\\"bgrj\\\", \\\"qtrj\\\", \\\"mh\\\", \\\"xs\\\", \\\"cbs\\\", \\\"zspx\\\", \\\"qtwd\\\", \\\"bz\\\", \\\"rw\\\", \\\"fj\\\", \\\"qttp\\\", \\\"qt\\\"];\\n                for (d = 0, e = c.length; e > d; d++)\\n                    if (c[d] == a) return b[d];\\n            }\\n            let d = [];\\n            let html = post(\\\"https://gitcafe.net/tool/alipaper/\\\", {\\n                headers: {\\n                    'Referer': 'https://u.gitcafe.ink/'\\n                },\\n                body: {\\n                    action: \\\"search\\\",\\n                    from: \\\"web\\\",\\n                    token: gettoken(),\\n                    keyword: s\\n                }\\n            })\\n            let list = JSON.parse(html);\\n            if (list.data) {\\n                list = list.data;\\n            }\\n            for (let i = 0; i < list.length; i++) {\\n                let it = list[i]\\n                let title = it.title;\\n                let murl = 'https://www.aliyundrive.com/s/' + it.alikey\\n                if (!aliUtil.checkali(murl)) {\\n                    continue;\\n                }\\n                if (title.includes(s)) {\\n                    d.push({\\n                        title: \\\"âˆš \\\" + title,\\n                        desc: cat_code(it.cat),\\n                        extra: {\\n                            des: it.des\\n                        },\\n                        url: murl\\n                    });\\n                }\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"ç©å¶å“¥å“¥\\\",\\n        page: true,\\n        basicUrl: \\\"http://wogg.xyz\\\",\\n        find: function(s, page) {\\n            let url = basicUrl + \\\"/index.php/vodsearch/\\\" + s + \\\"----------\\\" + page + \\\"---.html\\\";\\n            let html = request(url);\\n            let arr = parseDomForArray(html, \\\".module-items&&.module-search-item\\\");\\n\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let utitle = pdfh(it, \\\"h3&&a&&Text\\\");\\n                let userial = pdfh(it, \\\".video-serial&&Text\\\");\\n                let uimage = pdfh(it, \\\"img&&data-src\\\");\\n                let u = pd(it, \\\"h3&&a&&href\\\", basicUrl);\\n                bet.push({\\n                    title: utitle,\\n                    url: u,\\n                    pic_url: uimage,\\n                    desc: userial\\n                });\\n            }\\n\\n            return bet;\\n        },\\n        findAliUrl(input) {\\n            return pdfa(request(input), \\\"body&&.module-row-text.copy\\\").map(v => pdfh(v, \\\"a&&data-clipboard-text\\\"));\\n        }\\n    },\\n    {\\n        name: \\\"é˜¿é‡Œäº‘ç›˜ç½‘\\\",\\n        page: true,\\n        basicUrl: \\\"https://www.alypw.cn\\\",\\n        find: function(s, page) {\\n            let url = basicUrl + \\\"/search.php?q=\\\" + s + \\\"&page=\\\" + page;\\n            let html = request(url, {});\\n            let arr = pdfa(html, \\\".list&&li\\\");\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let utitle = pdfh(it, \\\"a&&title\\\");\\n                let userial = pdfh(it, \\\".fa-clock-o&&Text\\\");\\n                let uimage = pdfh(it, \\\"img&&src\\\");\\n                let u = pd(it, \\\"a&&href\\\", basicUrl);\\n                if (!utitle.includes(s)) {\\n                    continue;\\n                }\\n                bet.push({\\n                    title: utitle,\\n                    url: u,\\n                    pic_url: uimage,\\n                    desc: userial\\n                });\\n            }\\n\\n            return bet;\\n        },\\n        findAliUrl(input) {\\n            return pdfa(request(input), \\\"body&&a[href^=https://www.aliyundrive.com/s/]\\\").map(v => pdfh(v, \\\"a&&href\\\"));\\n        }\\n    },\\n    {\\n        name: \\\"åœŸæ‹¨é¼ \\\",\\n        page: false,\\n        find: function(s, page) {\\n            let html = fetch('https://www.tbsdy.com/search.html?keyword=' + s + '&category=983920&data_type=987910', {\\n                headers: {\\n                    'User-Agent': PC_UA\\n                }\\n            });\\n\\n            let arr = parseDomForArray(html, '.search_result_netdisk_list&&a');\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                //log(it);\\n                let u = parseDomForHtml(it, 'a&&href');\\n                let tit = parseDomForHtml(it, '.netdisk_item_detail_name&&Text');\\n                if (!tit.includes(s)) {\\n                    continue;\\n                }\\n                //log(u);\\n                d.push({\\n                    title: tit,\\n                    url: u,\\n                    desc: \\\"\\\\n\\\" + u,\\n                });\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"é˜¿é‡Œæœ\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let d = [];\\n            let html = request('https://aliso.cc/s/' + s + '-' + page + '-0.html', {});\\n\\n            let list = parseDomForArray(html, '.search-result&&.resource-item');\\n            for (let j = 0; j < list.length; j++) {\\n                let u = list[j];\\n                let tit = parseDomForHtml(u, 'h3&&Text');\\n                if (!tit.includes(s)) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: tit,\\n                    url: parseDom(u, 'h3&&a&&href', 'https://aliso.cc/'),\\n                    desc: parseDomForHtml(u, '.time&&Text'),\\n                });\\n\\n            }\\n            return d;\\n        },\\n        findAliUrl(input) {\\n            eval(getCryptoJS());\\n\\n            function decry(str) {\\n                var key = CryptoJS.enc.Utf8.parse(\\\"9EB20DDFD6AFBD68\\\");\\n                var encrypted = CryptoJS.AES.decrypt(str, key, {\\n                    iv: key,\\n                    mode: CryptoJS.mode.CBC,\\n                    padding: CryptoJS.pad.Pkcs7\\n                }).toString(CryptoJS.enc.Utf8);\\n                return encrypted;\\n            }\\n\\n            let html = request(input);\\n            let but = parseDom(html, '.button&&href', 'https://aliso.cc/');\\n            //log(but);\\n            let got = request(but);\\n            //log(got);\\n            eval(parseDomForHtml(got, 'head&&script,1&&Html'));\\n            return decry(base64.split('!')[0]);\\n        }\\n    },\\n    {\\n        name: \\\"äº‘ç›˜åˆ†äº«ç¤¾\\\",\\n        page: false,\\n        find: function(s, page) {\\n            let aliUtil = $.require(\\\"aliUtil\\\");\\n            let CryptoJS = aliUtil.getCryptoJS();\\n\\n            function decry(str) {\\n                var key = CryptoJS.enc.Utf8.parse(\\\"5F6B2AK33DASD123\\\");\\n                var encrypted = CryptoJS.AES.decrypt(str, key, {\\n                    mode: CryptoJS.mode.ECB,\\n                    padding: CryptoJS.pad.Pkcs7\\n                }).toString(CryptoJS.enc.Utf8);\\n                return encrypted;\\n            }\\n            let html = request(\\\"https://www.yunpanfenxiang.cn/api/bbs/api/getdata?key=\\\" + s + \\\"&type=video\\\", {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://www.yunpanfenxiang.cn/\\\"\\n                }\\n            });\\n            let json = decry(JSON.parse(html).data);\\n            let arr = JSON.parse(json);\\n\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let url = it.pid;\\n                bet.push({\\n                    url: \\\"https://www.yunpanfenxiang.cn/api/bbs/api/getarticle?id=\\\" + url,\\n                    title: it.title,\\n                    desc: it.createtime\\n                });\\n            }\\n\\n            return bet;\\n        },\\n        findAliUrl(input) {\\n            let json = JSON.parse(request(input, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://www.yunpanfenxiang.cn/\\\"\\n                }\\n            })).data;\\n            let list = json.download.split(\\\"@\\\");\\n            let alist = new Set();\\n            for (let j = 0; j < list.length; j++) {\\n                alist.add(\\\"https://www.aliyundrive.com/s/\\\" + list[j]);\\n            }\\n            return Array.from(alist);\\n        }\\n    },\\n    {\\n        name: \\\"ç›˜æœ\\\",\\n        page: true,\\n        find: function(s, page) {\\n            page = (page - 1) * 10;\\n            let url = \\\"https://www.pansearch.me/search?keyword=\\\" + s + \\\"&offset=\\\" + page + \\\"&pan=aliyundrive\\\";\\n            let html = request(url, {});\\n\\n            let arr = parseDomForArray(html, '.grid&&.shadow:has(a[href^=https://www.aliyundrive.com/s/])');\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = parseDomForHtml(it, 'a[href^=https://www.aliyundrive.com/s/]&&href');\\n                let pic_url = parseDomForHtml(it, 'img&&src');\\n                d.push({\\n                    title: parseDomForHtml(it, '.break-all&&Text').split('http')[0],\\n                    pic_url: pic_url === \\\"/favicon.png\\\" ? \\\"https://www.pansearch.me/\\\" + pic_url : pic_url,\\n                    url: u,\\n                    desc: parseDomForHtml(it, 'p&&Text') + \\\"\\\\n\\\" + u,\\n                });\\n\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"DOVXæœ\\\",\\n        page: false,\\n        find: function(s, page) {\\n            let url = \\\"https://api.dovx.tk/ali/search?wd=\\\" + s;\\n            let html = request(url);\\n            let arr = JSON.parse(html).list;\\n            let d = [];\\n            let aliUtil = $.require(\\\"aliUtil\\\");\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = it.vod_content;\\n                if (!u.includes(\\\"aliyundrive\\\") || !aliUtil.checkali(u)) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: \\\"âˆš \\\" + it.vod_name,\\n                    pic_url: it.vod_pic,\\n                    url: u,\\n                    desc: \\\"\\\\n\\\" + u,\\n                });\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"å¿…åº”\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://cn.bing.com/search?q=\\\" + s + \\\"+aliyundrive&qs=ds&form=QBRE\\\";\\n            if (page != 1) {\\n                url = getMyVar(\\\"bing\\\", url);\\n            }\\n            let html = request(url, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://cn.bing.com/\\\",\\n                    //\\\"X-Requested-With\\\": \\\"com.example.hikerview\\\",\\n                    \\\"Accept\\\": \\\"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\\\"\\n                }\\n            });\\n            let arr = pdfa(html, \\\"body&&a\\\");\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = pd(it, \\\"a&&href\\\", url);\\n                let t = pdfh(it, \\\"a&&Text\\\");\\n                if (it.includes(\\\"Next page\\\") || it.includes(\\\"ä¸‹ä¸€é¡µ\\\")) {\\n                    let u2 = pd(it, \\\"a&&href\\\", url);\\n                    //log(\\\"next page\\\");\\n                    //log(u2);\\n                    putMyVar(\\\"bing\\\", u2);\\n                }\\n                if (u == null || t == null || !it.includes(s)) {\\n                    continue;\\n                }\\n                if (!it.includes(\\\"ç½‘ç›˜\\\") && !it.includes(\\\"äº‘ç›˜\\\") &&\\n                    !it.includes(\\\"aliyundrive\\\") && !it.includes(\\\"yunpan\\\")) {\\n                    continue;\\n                }\\n                if (u.startsWith(\\\"https://cn.bing.com/\\\")) {\\n                    continue;\\n                }\\n                let dom = getHome(u).replace(\\\"http://\\\", \\\"\\\").replace(\\\"https://\\\", \\\"\\\");\\n                let _links = t.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n                let c = null;\\n                if (_links.length > 1 && _links[1].replace(_links[0], \\\"\\\").replace(/[a-zA-Z0-9]+/g, \\\"\\\") == \\\"\\\") {\\n                    c = _links[1];\\n                } else if (_links.length > 0) {\\n                    c = _links[0];\\n                }\\n                d.push({\\n                    title: t,\\n                    desc: dom,\\n                    url: c != null ? c : u,\\n                    extra: {\\n                        longClick: [{\\n                            title: \\\"è¿›å…¥ç½‘ç«™\\\",\\n                            js: JSON.stringify(\\\"hiker://page/ysfx?webUrl=\\\" + encodeURIComponent(u))\\n                        }]\\n                    }\\n                });\\n            }\\n            return d;\\n        },\\n        findAliUrl(input) {\\n            if (input.includes(\\\"aliyundrive\\\")) return input;\\n            let html = request(input);\\n            var _links = html.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n            if (_links.length > 1 && _links[1].replace(_links[0], \\\"\\\").replace(/[a-zA-Z0-9]+/g, \\\"\\\") == \\\"\\\") {\\n                return _links[1];\\n            } else if (_links.length > 0) {\\n                return _links[0];\\n            } else {\\n                return \\\"hiker://page/ysfx?webUrl=\\\" + encodeURIComponent(input);\\n            }\\n\\n        }\\n    },\\n    {\\n        name: 'CCOF',\\n        page: true,\\n        find: function(s, page) {\\n            let d = []\\n            let aliUtil = $.require(\\\"aliUtil\\\");\\n            let html = fetch('https://pan.ccof.cc/api/search', {\\n                headers: {\\n                    \\\"content-type\\\": 'application/json',\\n                    'Referer': 'https://pan.ccof.cc/search?keyword=' + s\\n                },\\n                body: {\\n                    \\\"pageSize\\\": 20,\\n                    \\\"pageNum\\\": page,\\n                    \\\"keyword\\\": s,\\n                    \\\"fromMobile\\\": true\\n                },\\n                method: 'POST'\\n            })\\n            let list = JSON.parse(html)\\n                .data.rows\\n            for (let i = 0; i < list.length; i++) {\\n                let it = list[i];\\n                let title = it.fileName\\n                let murl = it.url\\n                let type = it.type.replace(/folder/, 'æ–‡ä»¶å¤¹').replace(/file/, 'æ–‡ä»¶')\\n                if (title.includes(s)) {\\n                    d.push({\\n                        title: title,\\n                        desc: 'æ–‡ä»¶ç±»å‹ï¼š' + type + 'ï¼Œæ–‡ä»¶å¤§å°ï¼š' + aliUtil.bytesToSize(it.size),\\n                        url: murl\\n                    })\\n                }\\n            }\\n            return d\\n        }\\n    },\\n    {\\n        name: 'é˜¿é‡Œå°ç«™',\\n        page: true,\\n        find: function(s, page) {\\n            let home = \\\"https://pan666.net\\\";\\n            let d = [];\\n            let html = request(buildUrl(home + \\\"/api/discussions\\\", {\\n                \\\"include\\\": \\\"user,lastPostedUser,mostRelevantPost,mostRelevantPost.user,tags,tags.parent,firstPost\\\",\\n                \\\"filter[q]\\\": s /* + \\\" tag:video,comic\\\"*/ ,\\n                //\\\"filter[tag]\\\": \\\"video,comic\\\",\\n                \\\"page[offset]\\\": 20 * (page - 1)\\n            }), {\\n                headers: {\\n                    \\\"content-type\\\": \\\"application/json\\\",\\n                    \\\"Referer\\\": \\\"https://pan666.net/?q=\\\" + s\\n                }\\n            });\\n            let list = JSON.parse(html).data;\\n            for (let i = 0; i < list.length; i++) {\\n                let item = list[i].attributes;\\n                let url = home + \\\"/d/\\\" + item.slug;\\n                d.push({\\n                    title: item.title,\\n                    desc: 'å‘å¸ƒæ—¶é—´ï¼š' + $.dateFormat(new Date(item.createdAt), \\\"yyyy-MM-dd HH:mm:ss\\\"),\\n                    url: url,\\n                    extra: {\\n                        longClick: [{\\n                            title: \\\"è¿›å…¥å¸–å­\\\",\\n                            js: JSON.stringify(\\\"hiker://page/ysfx?webUrl=\\\" + encodeURIComponent(url))\\n                        }]\\n                    }\\n                });\\n            }\\n            return d;\\n        },\\n        findAliUrl(input) {\\n            let html = pdfh(request(input), \\\"Text\\\");\\n            let _links = html.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n            let sharePwd = html.match(/æå–ç [:ï¼š]\\\\s*?(\\\\w{4})/);\\n            sharePwd = Array.isArray(sharePwd) && sharePwd.length > 0 ? sharePwd[1] : \\\"\\\";\\n            if (_links.length > 1 && _links[1].replace(_links[0], \\\"\\\").replace(/[a-zA-Z0-9]+/g, \\\"\\\") == \\\"\\\") {\\n                return {\\n                    aliUrl: _links[1],\\n                    sharePwd: sharePwd\\n                };\\n            } else if (_links.length > 0) {\\n                return {\\n                    aliUrl: _links[0],\\n                    sharePwd: sharePwd\\n                };\\n            } else {\\n                return \\\"hiker://page/ysfx?webUrl=\\\" + encodeURIComponent(input);\\n            }\\n        }\\n    },\\n    {\\n        name: 'äº‘ç›˜åˆ†äº«ç¤¾åŒº',\\n        page: true,\\n        find: function(s, page) {\\n            let home = \\\"https://yunpan1.cc\\\";\\n            let d = [];\\n            let html = request(buildUrl(home + \\\"/api/discussions\\\", {\\n                \\\"include\\\": \\\"user,lastPostedUser,mostRelevantPost,mostRelevantPost.user,tags,tags.parent,firstPost\\\",\\n                \\\"filter[q]\\\": s /* + \\\" tag:video,comic\\\"*/ ,\\n                //\\\"filter[tag]\\\": \\\"video,comic\\\",\\n                \\\"page[offset]\\\": 20 * (page - 1)\\n            }), {\\n                headers: {\\n                    \\\"content-type\\\": \\\"application/json\\\",\\n                    \\\"Referer\\\": \\\"https://pan666.net/?q=\\\" + s\\n                }\\n            });\\n            let list = JSON.parse(html).data;\\n            for (let i = 0; i < list.length; i++) {\\n                let item = list[i].attributes;\\n                let url = home + \\\"/d/\\\" + item.slug;\\n                d.push({\\n                    title: item.title,\\n                    desc: 'å‘å¸ƒæ—¶é—´ï¼š' + $.dateFormat(new Date(item.createdAt), \\\"yyyy-MM-dd HH:mm:ss\\\"),\\n                    url: url,\\n                    extra: {\\n                        longClick: [{\\n                            title: \\\"è¿›å…¥å¸–å­\\\",\\n                            js: JSON.stringify(\\\"hiker://page/ysfx?webUrl=\\\" + encodeURIComponent(url))\\n                        }]\\n                    }\\n                });\\n            }\\n            return d;\\n        },\\n        findAliUrl(input) {\\n            let html = pdfh(request(input), \\\"Text\\\");\\n            let _links = html.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n            let sharePwd = html.match(/æå–ç [:ï¼š]\\\\s*?(\\\\w{4})/);\\n            sharePwd = Array.isArray(sharePwd) && sharePwd.length > 0 ? sharePwd[1] : \\\"\\\";\\n            if (_links.length > 1 && _links[1].replace(_links[0], \\\"\\\").replace(/[a-zA-Z0-9]+/g, \\\"\\\") == \\\"\\\") {\\n                return {\\n                    aliUrl: _links[1],\\n                    sharePwd: sharePwd\\n                };\\n            } else if (_links.length > 0) {\\n                return {\\n                    aliUrl: _links[0],\\n                    sharePwd: sharePwd\\n                };\\n            } else {\\n                return \\\"hiker://page/ysfx?webUrl=\\\" + encodeURIComponent(input);\\n            }\\n        }\\n    }, {\\n        name: \\\"çˆ±çœ‹ç¾å‰§\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://www.2kmj.cn/search.php?q=\\\" + s + \\\"&page/\\\" + page + \\\"/\\\";\\n            let html = request(url);\\n            let arr = parseDomForArray(html, \\\".list-it&&li\\\");\\n\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let utitle = parseDomForHtml(it, \\\"a&&title\\\");\\n                let userial = parseDomForHtml(it, \\\".info&&span:not(:has(a))--i&&Text\\\");\\n                let uimage = parseDom(it, \\\"img&&src\\\");\\n                let u = parseDom(it, \\\"a&&href\\\");\\n                bet.push({\\n                    title: utitle,\\n                    url: u,\\n                    pic_url: uimage,\\n                    desc: userial\\n                });\\n            }\\n\\n            return bet;\\n\\n        },\\n        findAliUrl(input) {\\n            return pdfa(request(input), \\\"body&&#download\\\").map(v => pdfh(v, \\\".down&&href\\\"));\\n        }\\n    },\\n    {\\n        name: \\\"å¥‡å¦™æœç´¢\\\",\\n        page: true,\\n        find(s, page) {\\n            let url;\\n            if (page === 1) {\\n                url = buildUrl(\\\"https://www.magicalsearch.top/api/pshou/getData\\\", {\\n                    word: s,\\n                    type: \\\"é˜¿é‡Œç½‘ç›˜\\\"\\n                });\\n            } else {\\n                url = buildUrl(\\\"https://www.magicalsearch.top/api/pshou/getNextPage\\\", {\\n                    url: \\\"https://api.upyunso2.com/search?s_type=2@page=\\\" + page + \\\"@keyword=\\\" + encodeURIComponent(s),\\n                    website: \\\"é˜¿é‡Œç½‘ç›˜\\\"\\n                });\\n            }\\n            let result = request(url, {\\n                headers: {\\n                    Referer: buildUrl(\\\"https://www.magicalsearch.top/search\\\", {\\n                        word: s,\\n                        cpage: 0\\n                    })\\n                }\\n            });\\n            result = JSON.parse(JSON.parse(result));\\n            let list = result.result.items;\\n            let d = [];\\n            for (let it of list) {\\n                if (it.id == -1) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: it.title,\\n                    desc: \\\"æ—¥æœŸï¼š\\\" + it.insert_time + \\\"\\\\nè·¯å¾„ï¼š\\\" + it.path,\\n                    url: it.page_url\\n                });\\n            }\\n            return d;\\n        }\\n    }\\n];\"},{\"col_type\":\"movie_3\",\"name\":\"æ–‡ä»¶æ’åº\",\"path\":\"FileSorting\",\"rule\":\"let chnNumChar = {\\n    é›¶: 0,\\n    ä¸€: 1,\\n    äºŒ: 2,\\n    ä¸‰: 3,\\n    å››: 4,\\n    äº”: 5,\\n    å…­: 6,\\n    ä¸ƒ: 7,\\n    å…«: 8,\\n    ä¹: 9\\n};\\n\\nlet chnNameValue = {\\n    å: {\\n        value: 10,\\n        secUnit: false\\n    },\\n    ç™¾: {\\n        value: 100,\\n        secUnit: false\\n    },\\n    åƒ: {\\n        value: 1000,\\n        secUnit: false\\n    },\\n    ä¸‡: {\\n        value: 10000,\\n        secUnit: true\\n    },\\n    äº¿: {\\n        value: 100000000,\\n        secUnit: true\\n    }\\n}\\n\\nfunction ChineseToNumber(chnStr) {\\n    let rtn = 0;\\n    let section = 0;\\n    let number = 0;\\n    let secUnit = false;\\n    let str = chnStr.split('');\\n\\n    for (let i = 0; i < str.length; i++) {\\n        let num = chnNumChar[str[i]];\\n        if (typeof num !== 'undefined') {\\n            number = num;\\n            if (i === str.length - 1) {\\n                section += number;\\n            }\\n        } else {\\n            let unit = chnNameValue[str[i]].value;\\n            secUnit = chnNameValue[str[i]].secUnit;\\n            if (secUnit) {\\n                section = (section + number) * unit;\\n                rtn += section;\\n                section = 0;\\n            } else {\\n                section += (number * unit);\\n            }\\n            number = 0;\\n        }\\n    }\\n    return rtn + section;\\n}\\n\\nfunction nameCompare(a, b) {\\n    if (a == null || b == null)\\n        return a == null ? b == null ? 0 : -1 : 1;\\n\\n    a = a.replace(/([é›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹åç™¾åƒä¸‡äº¿])/g, function(match, p1, p2, p3, offset, string) {\\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\\n        return ChineseToNumber(p1);\\n    })\\n    b = b.replace(/([é›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹åç™¾åƒä¸‡äº¿])/g, function(match, p1, p2, p3, offset, string) {\\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\\n        return ChineseToNumber(p1);\\n    })\\n\\n    let NUMBERS = java.util.regex.Pattern.compile(\\\"(?<=\\\\\\\\D)(?=\\\\\\\\d)|(?<=\\\\\\\\d)(?=\\\\\\\\D)\\\")\\n    let split1 = NUMBERS.split(new java.lang.String(a));\\n    let split2 = NUMBERS.split(new java.lang.String(b));\\n\\n    for (let i = 0; i < Math.min(split1.length, split2.length); i++) {\\n        let c1 = split1[i].charCodeAt(0);\\n        let c2 = split2[i].charCodeAt(0);\\n        let cmp = 0;\\n        let zeroCharCode = '0'.charCodeAt(0);\\n        let nineCharCode = '9'.charCodeAt(0);\\n\\n        if (c1 >= zeroCharCode && c1 <= nineCharCode && c2 >= zeroCharCode && c2 <= nineCharCode) {\\n            cmp = new java.math.BigInteger(split1[i]).compareTo(new java.math.BigInteger(split2[i]));\\n        }\\n\\n        if (cmp === 0) {\\n            let regex = /[a-zA-Z0-9]/\\n            let s1 = String(split1[i])\\n            let s2 = String(split2[i])\\n            if (regex.test(s1) || regex.test(s2)) {\\n                cmp = new java.lang.String(split1[i]).compareTo(new java.lang.String(split2[i]));\\n                // cmp = s1.localeCompare(s2, 'en')\\n            } else {\\n                cmp = s1.localeCompare(s2, 'zh')\\n            }\\n        }\\n\\n        if (cmp !== 0) {\\n            return cmp;\\n        }\\n    }\\n    let lengthCmp = split1.length - split2.length;\\n    // if (lengthCmp !== 0) lengthCmp = lengthCmp > 0 ? -1 : 1;\\n    return lengthCmp;\\n}\\n$.exports.nameCompare = nameCompare;\"},{\"col_type\":\"movie_3\",\"name\":\"ç™»å½•æ–¹å¼\",\"path\":\"loginMode\",\"rule\":\"$.exports = $([\\\"APPæˆæƒç™»å½•\\\", \\\"ç½‘é¡µç™»å½•â‘ \\\", \\\"ç½‘é¡µç™»å½•â‘¡\\\", \\\"TOKENç™»å½•\\\"], 1, \\\"ç™»å½•æ–¹å¼\\\").select(() => {\\n    if (\\\"ç½‘é¡µç™»å½•â‘ \\\" == input) {\\n        return \\\"hiker://page/login#noRecordHistory##noHistory#?pageTitle=ç™»å½•é˜¿é‡Œäº‘ç›˜\\\"\\n    }\\n    if (\\\"ç½‘é¡µç™»å½•â‘¡\\\" == input) {\\n        return \\\"hiker://page/login#noRecordHistory##noHistory#?index=0&pageTitle=ç™»å½•é˜¿é‡Œäº‘ç›˜\\\"\\n    }\\n    if (\\\"APPæˆæƒç™»å½•\\\" == input) {\\n        return \\\"hiker://page/login#noRefresh##noRecordHistory##noHistory#?index=-1&pageTitle=ç™»å½•é˜¿é‡Œäº‘ç›˜\\\"\\n    }\\n    if (\\\"TOKENç™»å½•\\\" == input) {\\n        return $(\\\"\\\", \\\"è¾“å…¥TOKEN\\\").input(() => {\\n            let aliTokensFilepath = $.require(\\\"hiker://page/tokenPath\\\").aliTokensFilepath;\\n            let aliToken = {\\n                refresh_token: input.trim()\\n            };\\n            writeFile(aliTokensFilepath, JSON.stringify(aliToken));\\n            refreshPage();\\n        });\\n    }\\n    if (\\\"åŸç”»ç™»å½•\\\" == input) {\\n        return \\\"hiker://page/openApiLogin#noRefresh##noRecordHistory##noHistory#\\\";\\n    }\\n});\"},{\"col_type\":\"movie_3\",\"name\":\"é˜¿é‡Œé“¾æ¥åŒ¹é…\",\"path\":\"alitest\",\"rule\":\"js:\\nlet matchReg = /https?:\\\\/\\\\/www.ali(pan|yundrive).com\\\\/s\\\\/[a-zA-Z0-9]{11}(\\\\/folder\\\\/[a-z0-9]{40})?/;\\nlet matchRegG = /https?:\\\\/\\\\/www.ali(pan|yundrive).com\\\\/s\\\\/[a-zA-Z0-9]{11}(\\\\/folder\\\\/[a-z0-9]{40})?/g;\\nlet testReg = /www.ali(pan|yundrive).com\\\\/s\\\\//;\\n$.exports = {\\n    matchAliUrl(text, isG) {\\n        if (isG) {\\n            let url = text.match(matchRegG);\\n            if (url) return url;\\n            else return [];\\n        } else {\\n            let url = text.match(matchReg);\\n            return url = url && url[0] || \\\"\\\";\\n        }\\n    },\\n    test(text){\\n        return testReg.test(text);\\n    }\\n}\\n\"},{\"col_type\":\"movie_3\",\"name\":\"openApiç™»å½•-åºŸå¼ƒ\",\"path\":\"openApiLogin\",\"rule\":\"js:\\nsetPageTitle(\\\"openApiç™»å½•\\\");\\naddListener(\\\"onClose\\\", () => clearMyVar(\\\"Loggingin\\\"));\\n\\nlet d = [];\\nd.push({\\n    title: \\\"ç‚¹å‡»è·å–æ‰«ç ç™»å½•äºŒç»´ç \\\",\\n    desc: \\\"ç‚¹å‡»å›¾ç‰‡å¯ä»¥ä¿å­˜\\\",\\n    col_type: \\\"text_center_1\\\",\\n    extra: {\\n        cls: \\\"login\\\",\\n        id:\\\"getQC\\\"\\n    },\\n    url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n        putMyVar(\\\"Loggingin\\\", \\\"true\\\");\\n        showLoading(\\\"æ­£åœ¨è·å–äºŒç»´ç \\\");\\n\\n        function get_qrcode_status(sid) {\\n            let res = fetch(\\\"https://openapi.aliyundrive.com/oauth/qrcode/\\\" + sid + \\\"/status\\\");\\n            return JSON.parse(res);\\n        }\\n\\n        function get_refresh_token(code) {\\n            let res = post(\\\"https://aliyundrive-oauth.messense.me/oauth/access_token\\\", {\\n                body: JSON.stringify({\\n                    \\\"grant_type\\\": \\\"authorization_code\\\",\\n                    \\\"code\\\": code,\\n                }),\\n            });\\n            let data = JSON.parse(res);\\n            return data[\\\"refresh_token\\\"];\\n        }\\n        let res = post(\\\"https://aliyundrive-oauth.messense.me/oauth/authorize/qrcode\\\", {\\n            body: JSON.stringify({\\n                \\\"scopes\\\": [\\\"user:base\\\", \\\"file:all:read\\\", \\\"file:all:write\\\"],\\n                \\\"width\\\": 300,\\n                \\\"height\\\": 300,\\n            }),\\n        });\\n        let data = JSON.parse(res);\\n        let sid = data[\\\"sid\\\"];\\n        let qrcode_url = data[\\\"qrCodeUrl\\\"];\\n        updateItem(\\\"infoOutput\\\", {\\n            pic_url: qrcode_url,\\n            url: qrcode_url + \\\"#.jpg\\\",\\n            col_type: \\\"pic_1_full\\\"\\n        });\\n        addItemAfter(\\\"infoOutput\\\", {\\n            title: \\\"â€˜â€˜â€™â€™\\\" + \\\"ä½¿ç”¨é˜¿é‡Œäº‘ç›˜ App æ‰«ç \\\".fontcolor(\\\"grey\\\"),\\n            col_type: \\\"text_center_1\\\",\\n            extra: {\\n                cls: \\\"login\\\"\\n            }\\n        });\\n        deleteItem(\\\"getQC\\\");\\n        hideLoading();\\n        let refresh_token;\\n        while (true) {\\n            let data;\\n            try {\\n                data = get_qrcode_status(sid);\\n            } catch (e) {\\n                return \\\"toast://æŸ¥è¯¢æ‰«ç ç»“æœè¶…æ—¶, å¯èƒ½æ˜¯è§¦å‘äº†é˜¿é‡Œäº‘ç›˜æ¥å£é™åˆ¶, è¯·ç¨åå†è¯•.\\\";\\n            }\\n            let status = data[\\\"status\\\"];\\n            if (status == \\\"LoginSuccess\\\") {\\n                refresh_token = get_refresh_token(data[\\\"authCode\\\"]);\\n                break\\n            } else if (status == \\\"QRCodeExpired\\\") {\\n                return \\\"toast://äºŒç»´ç å·²è¿‡æœŸ, è¯·åˆ·æ–°é¡µé¢åé‡è¯•\\\";\\n            }\\n            if (!getMyVar(\\\"Loggingin\\\", \\\"\\\")) {\\n                return \\\"toast://cancel\\\";\\n            }\\n            java.lang.Thread.sleep(1500);\\n        }\\n        if (refresh_token) {\\n            const {\\n                openTokensFilepath,\\n            } = $.require(\\\"tokenPath\\\");\\n            let open = {\\n                RefreshTokenOpen: refresh_token,\\n                isV2: true\\n            };\\n            writeFile(openTokensFilepath, JSON.stringify(open));\\n            addItemAfter(\\\"infoOutput\\\", {\\n                title: \\\"ç™»å½•æˆåŠŸ(ç‚¹å‡»è¿”å›)\\\",\\n                url:$(\\\"#noLoading#\\\").lazyRule(()=>{\\n                    back(false);\\n                    return \\\"hiker://empty\\\";\\n                }),\\n                col_type: \\\"text_center_1\\\",\\n            });\\n            deleteItemByCls(\\\"login\\\");\\n\\n            return \\\"toast://success\\\";\\n        }\\n        return \\\"toast://fail\\\";\\n    })\\n});\\n\\nd.push({\\n    col_type: \\\"blank_block\\\",\\n    extra: {\\n        id: \\\"infoOutput\\\",\\n        cls: \\\"login\\\"\\n    }\\n});\\n\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"openApi:alist\",\"path\":\"openApi_alist\",\"rule\":\"function OpenApiAlist($this) {\\n    this.$this = $this;\\n}\\nObject.assign(OpenApiAlist.prototype, {\\n    getOpenTokenCode() {\\n        let result = this.$this.postApi('https://open.aliyundrive.com/oauth/users/authorize?client_id=' + '76917ccccd4441c39457a04f6084fb2f' + '&redirect_uri=https://alist.nn.ci/tool/aliyundrive/callback' + '&scope=user:base,file:all:read,file:all:write&state=').body({\\n            \\\"authorize\\\": 1,\\n            \\\"scope\\\": \\\"user:base,file:all:read,file:all:write\\\"\\n        }).headers({\\n            'User-Agent': PC_UA,\\n            'Referer': 'https://www.aliyundrive.com/',\\n            'authorization': this.$this.reaccessTk, //getAccessToken\\n            'x-canary': 'client=web,app=share,version=v2.3.1',\\n            'x-share-token': this.$this.shareToken\\n        }).errorWithRetry((e, _, http) => {\\n            this.$this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'authorization': this.$this.reaccessTk,\\n                    'x-share-token': this.$this.shareToken\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        let code = result.redirectUri.split(\\\"code=\\\")[1];\\n        return code;\\n    },\\n    getToken(body) {\\n        let json = post('https://api.xhofe.top/alist/ali_open/code', {\\n            headers: {\\n                'User-Agent': PC_UA,\\n                'Referer': 'https://www.aliyundrive.com/'\\n            },\\n            body: JSON.stringify(body),\\n        });\\n        if (!json) {\\n            json = post('https://api-cf.nn.ci/alist/ali_open/code', {\\n                headers: {\\n                    'User-Agent': PC_UA,\\n                    'Referer': 'https://www.aliyundrive.com/'\\n                },\\n                body: JSON.stringify(body),\\n            });\\n        }\\n        if (json.includes('Too Many Requests') || json.includes(\\\"502 Bad Gateway\\\")) {\\n            throw new Error(\\\"é¢‘ç¹è¯·æ±‚æš‚æ—¶è¢«å°ç¦\\\\n\\\" + json);\\n        } else {\\n            let openResult = JSON.parse(json);\\n            return openResult;\\n        }\\n    },\\n    getOpenToken() {\\n        return this.getToken({\\n            code: this.getOpenTokenCode(),\\n            grant_type: \\\"authorization_code\\\"\\n        });\\n    },\\n    refreshOpenToken() {\\n        return this.getToken({\\n            grant_type: \\\"refresh_token\\\",\\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\\n        });\\n    }\\n});\\n$.exports = OpenApiAlist;\"},{\"col_type\":\"movie_3\",\"name\":\"openApi:aliyundrive\",\"path\":\"openApi_aliyundrive\",\"rule\":\"js:\\nfunction OpenApi($this, postApi) {\\n    this.$this = $this;\\n}\\n\\nObject.assign(OpenApi.prototype, {\\n    getOpenTokenCode() {\\n        function get_qrcode_code(sid) {\\n            let res = fetch(\\\"https://openapi.aliyundrive.com/oauth/qrcode/\\\" + sid + \\\"/status\\\");\\n            return JSON.parse(res).authCode;\\n        }\\n\\n        let res = post(\\\"https://aliyundrive-oauth.messense.me/oauth/authorize/qrcode\\\", {\\n            body: JSON.stringify({\\n                \\\"scopes\\\": [\\\"user:base\\\", \\\"file:all:read\\\", \\\"file:all:write\\\"],\\n                \\\"width\\\": 300,\\n                \\\"height\\\": 300,\\n            }),\\n        });\\n        let data = JSON.parse(res);\\n        let sid = data[\\\"sid\\\"];\\n        let body = {\\n            \\\"authorize\\\": 1,\\n            \\\"scope\\\": \\\"user:base,file:all:read,file:all:write\\\",\\n            \\\"drives\\\": [\\\"backup\\\", \\\"resource\\\"],\\n            \\\"scopes\\\": [\\\"user:base\\\", \\\"file:all:read\\\", \\\"file:all:write\\\"],\\n            \\\"sid\\\": sid\\n        }\\n        let headers = {\\n            'authorization': this.$this.reaccessTk\\n        };\\n        let res2 = this.$this.postApi(\\\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\\\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\\n            this.$this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'authorization': this.$this.reaccessTk,\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return get_qrcode_code(sid);\\n    },\\n    getToken(body) {\\n        let res = post(\\\"https://aliyundrive-oauth.messense.me/oauth/access_token\\\", {\\n            body: JSON.stringify(body),\\n        });\\n        let data = JSON.parse(res);\\n\\n        return data;\\n    },\\n    getOpenToken() {\\n        return this.getToken({\\n            code: this.getOpenTokenCode(),\\n            grant_type: \\\"authorization_code\\\"\\n        });\\n    },\\n    refreshOpenToken() {\\n        return this.getToken({\\n            grant_type: \\\"refresh_token\\\",\\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\\n        });\\n    }\\n});\\n$.exports = OpenApi;\"},{\"col_type\":\"movie_3\",\"name\":\"openApi:tvbox\",\"path\":\"openApi_tvbox\",\"rule\":\"function OpenApi($this) {\\n    this.$this = $this;\\n}\\n\\nObject.assign(OpenApi.prototype, {\\n    getOpenTokenCode() {\\n        function get_qrcode_code(sid) {\\n            let res = fetch(\\\"https://openapi.aliyundrive.com/oauth/qrcode/\\\" + sid + \\\"/status\\\");\\n            return JSON.parse(res).authCode;\\n        }\\n\\n        let res = fetch(\\\"http://159.75.208.47/cloudisk/api/oauth/authorize/qrcode\\\");\\n        let data = JSON.parse(res);\\n        let sid = data[\\\"sid\\\"];\\n        let body = {\\n            \\\"authorize\\\": 1,\\n            \\\"scope\\\": \\\"user:base,file:all:read,file:all:write\\\",\\n            \\\"drives\\\": [\\\"backup\\\", \\\"resource\\\"],\\n            \\\"scopes\\\": [\\\"user:base\\\", \\\"file:all:read\\\", \\\"file:all:write\\\"],\\n            \\\"sid\\\": sid\\n        }\\n        let headers = {\\n            'authorization': this.$this.reaccessTk\\n        };\\n        let res2 = this.$this.postApi(\\\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\\\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\\n            this.$this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'authorization': this.$this.reaccessTk,\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return get_qrcode_code(sid);\\n    },\\n    getToken(body) {\\n        let url = \\\"\\\";\\n        if (body.code) {\\n            url = buildUrl(\\\"http://159.75.208.47/cloudisk/api/oauth/accessToken\\\", {\\n                authCode: body.code\\n            });\\n        } else {\\n            url = buildUrl(\\\"http://159.75.208.47/cloudisk/api/oauth/accessToken\\\", {\\n                refreshToken: body.refresh_token\\n            });\\n        }\\n        let res = fetch(url);\\n        let data = JSON.parse(res);\\n        let ret = {\\n            refresh_token: data.refreshToken,\\n            token_type: data.tokenType,\\n            access_token: data.accessToken\\n        };\\n        return ret;\\n    },\\n    getOpenToken() {\\n        return this.getToken({\\n            code: this.getOpenTokenCode(),\\n            grant_type: \\\"authorization_code\\\"\\n        });\\n    },\\n    refreshOpenToken() {\\n        return this.getToken({\\n            grant_type: \\\"refresh_token\\\",\\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\\n        });\\n    }\\n});\\n$.exports = OpenApi;\"},{\"col_type\":\"movie_3\",\"name\":\"openApi:XBY\",\"path\":\"openApi_XBY\",\"rule\":\"js:\\nfunction OpenApi($this, postApi) {\\n    this.$this = $this;\\n}\\n\\nObject.assign(OpenApi.prototype, {\\n    client_secret: \\\"63f06c3c5c5d4e1196e2c13e8588ae29\\\",\\n    client_id: \\\"df43e22f022d4c04b6e29964f3b8b46d\\\",\\n    getOpenTokenCode() {\\n        function get_qrcode_code(sid) {\\n            let res = fetch(\\\"https://openapi.aliyundrive.com/oauth/qrcode/\\\" + sid + \\\"/status\\\");\\n            return JSON.parse(res).authCode;\\n        }\\n\\n        let res = post(\\\"https://openapi.aliyundrive.com/oauth/authorize/qrcode\\\", {\\n            body: JSON.stringify({\\n                \\\"scopes\\\": [\\\"user:base\\\", \\\"file:all:read\\\", \\\"file:all:write\\\"],\\n                \\\"client_secret\\\": this.client_secret,\\n                \\\"client_id\\\": this.client_id,\\n                \\\"width\\\": 350,\\n                \\\"height\\\": 350,\\n            }),\\n        });\\n        let data = JSON.parse(res);\\n        let sid = data[\\\"sid\\\"];\\n        let body = {\\n            \\\"authorize\\\": 1,\\n            \\\"scope\\\": \\\"user:base,file:all:read,file:all:write\\\",\\n            \\\"drives\\\": [\\\"backup\\\", \\\"resource\\\"],\\n            \\\"scopes\\\": [\\\"user:base\\\", \\\"file:all:read\\\", \\\"file:all:write\\\"],\\n            \\\"sid\\\": sid\\n        }\\n        let headers = {\\n            'authorization': this.$this.reaccessTk\\n        };\\n        let res2 = this.$this.postApi(\\\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\\\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\\n            this.$this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'authorization': this.$this.reaccessTk,\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return get_qrcode_code(sid);\\n    },\\n    getToken(body) {\\n        let res = post(\\\"https://openapi.aliyundrive.com/oauth/access_token\\\", {\\n            body: JSON.stringify(body),\\n        });\\n        let data = JSON.parse(res);\\n\\n        return data;\\n    },\\n    getOpenToken() {\\n        return this.getToken({\\n            code: this.getOpenTokenCode(),\\n            grant_type: \\\"authorization_code\\\",\\n            client_secret: this.client_secret,\\n            client_id: this.client_id,\\n        });\\n    },\\n    refreshOpenToken() {\\n        return this.getToken({\\n            grant_type: \\\"refresh_token\\\",\\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\\n            client_secret: this.client_secret,\\n            client_id: this.client_id,\\n        });\\n    }\\n});\\n$.exports = OpenApi;\"},{\"col_type\":\"movie_3\",\"name\":\"é“¾æ¥å®šå‘\",\"path\":\"redirect\",\"rule\":\"js:\\nconst openMode = getItem(\\\"openMode\\\", \\\"æœ¬åœ°è§£æ\\\");\\nif (openMode === \\\"æœ¬åœ°è½¬ç \\\") {\\n    setItem(\\\"openMode\\\", \\\"æœ¬åœ°è§£æ\\\");\\n    openMode = \\\"æœ¬åœ°è§£æ\\\";\\n}\\n\\nfunction dealArray(array) {\\n    let isString = typeof array[0] === \\\"string\\\";\\n    if (array.length === 1) {\\n        return dealResult(array[0]);\\n    } else if (isString) {\\n        array = array.map(aliUrl => ({\\n            aliUrl\\n        }));\\n    }\\n    let select = array.map((v, i) => v.title || v.aliUrl.replace(/http.*?\\\\/s\\\\//, \\\"\\\"));\\n    return $(select).select((result) => {\\n        let index = MY_INDEX;\\n        return $.require(\\\"redirect\\\").dealResult(result[index]);\\n    }, array);\\n}\\n\\nfunction dealResult(result) {\\n    let resultType = typeof result;\\n    if (resultType === \\\"string\\\") {\\n        return getModeUrl(result);\\n    } else if (Array.isArray(result)) {\\n        return dealArray(result);\\n    } else if (result instanceof EasyNextPage) {\\n        return result.toNextPage();\\n    } else if (resultType === \\\"object\\\") {\\n        return getModeUrl(result.aliUrl, result.sharePwd);\\n    }\\n    return \\\"toast://é”™è¯¯ç±»å‹ï¼š\\\" + resultType;\\n}\\n\\nfunction EasyNextPage(list, col) {\\n    //this.list = list;\\n    col = col || \\\"text_3\\\";\\n    this.toNextPage = function() {\\n        return $().rule((list, col_type) => {\\n            setResult(list.map(v => ({\\n                col_type,\\n                url: $().lazyRule(v => $.require(\\\"redirect\\\").dealResult(v), v),\\n                title: v.title || v.aliUrl.replace(/http.*?\\\\/s\\\\//, \\\"\\\")\\n            })));\\n        }, list, col);\\n    }\\n}\\n\\nfunction setErrorPop(name, author) {\\n    return $(\\\"æœç´¢å¼•æ“ã€Œ\\\" + name + \\\"ã€å¤±æ•ˆè¯·è”ç³»æœç´¢å¼•æ“ä½œè€…\\\" + (author ? \\\"[\\\" + author + \\\"]\\\" : \\\"\\\") + \\\"ä¿®å¤æˆ–åˆ é™¤\\\\n\\\\nå¼•æ“ä½œè€…å¯ä»¥å»å®˜æ–¹é¢‘é“è¯¢é—®\\\\nç‚¹å‡»ç¡®å®šå¿«é€Ÿåˆ é™¤\\\").confirm((name) => {\\n        confirm({\\n            title: \\\"æ¸©é¦¨æç¤º\\\",\\n            content: \\\"ç¡®å®šè¦åˆ é™¤\\\" + name + \\\"å—ï¼Ÿæ³¨æ„åˆ é™¤åæ— æ³•æ¢å¤\\\",\\n            confirm: $.toString((name) => {\\n                let arr = $.require(\\\"configs\\\").getJson();\\n                let index = arr.findIndex(v => v.name === name);\\n                arr.splice(index, 1);\\n                $.require(\\\"configs\\\").saveJson(arr);\\n                clearItem(\\\"rule\\\");\\n                refreshPage(true);\\n                return \\\"toast://åˆ é™¤æˆåŠŸ\\\";\\n            }, name)\\n        });\\n    }, name);\\n}\\n\\nfunction doubleTreating({\\n    findAliUrl,\\n    basicUrl,\\n    name,\\n    author,\\n    aliUrl,\\n    ruleType\\n}) {\\n    if (!findAliUrl) return getModeUrl(aliUrl);\\n    if (ruleType === \\\"JSON\\\") {\\n        let ParseRlue = $.require(\\\"ParseRlue\\\");\\n        let find = findAliUrl;\\n        findAliUrl = (url, basicUrl) => {\\n            return ParseRlue.parseUrlJson(url, find, basicUrl);\\n        }\\n    }else if (ruleType === \\\"HTML\\\") {\\n        let ParseRlue = $.require(\\\"ParseRlue\\\");\\n        let find = findAliUrl;\\n        findAliUrl = (url, basicUrl) => {\\n            return ParseRlue.parseUrlHtml(url, find, basicUrl);\\n        }\\n    } else {\\n        findAliUrl = new Function(\\\"input\\\", \\\"basicUrl\\\", \\\"EasyNextPage\\\", findAliUrl);\\n    }\\n    try {\\n        let result = findAliUrl(aliUrl, basicUrl, EasyNextPage);\\n        return dealResult(result);\\n    } catch (e) {\\n        log(e.toString());\\n        return setErrorPop(name, author);\\n    }\\n}\\n\\nfunction getModeUrl(aliUrl, sharePwd) {\\n    if ($.require(\\\"alitest\\\").test(aliUrl)) {\\n        if (openMode === \\\"æœ¬åœ°è§£æ\\\") {\\n            return \\\"hiker://page/aliyun?page=fypage&realurl=\\\" + encodeURIComponent(aliUrl) + \\\"&sharePwd=\\\" + (sharePwd || \\\"\\\");\\n        } else {\\n            shareId = aliUrl.split(\\\"/\\\")[4];\\n            return \\\"smartdrive://share/browse?shareId=\\\" + shareId + \\\"&sharePwd=\\\" + (sharePwd || \\\"\\\");\\n        }\\n    } else if (aliUrl.includes(\\\"pan.quark.cn/s/\\\")||aliUrl.includes(\\\"drive.uc.cn/s/\\\")) {\\n        if (openMode === \\\"æœ¬åœ°è§£æ\\\") {\\n            let has = fetch(\\\"hiker://home@Quark.ç®€\\\") != \\\"null\\\";\\n            if (has) {\\n                return \\\"hiker://page/quarkList?rule=Quark.ç®€&realurl=\\\" + encodeURIComponent(aliUrl) + \\\"&sharePwd=\\\" + (sharePwd || \\\"\\\");\\n            } else {\\n                return aliUrl;\\n            }\\n        } else {\\n            return \\\"qklink://www.uc.cn/b20b84fd735a8dd3f7541129bacc4e9a?action=open_url&url=\\\" + aliUrl;\\n        }\\n    } else if (aliUrl.startsWith(\\\"http\\\")) {\\n        return aliUrl;\\n    } else if (aliUrl.startsWith(\\\"magnet\\\")) {\\n        if (openMode === \\\"æœ¬åœ°è§£æ\\\") {\\n            return aliUrl;\\n        } else {\\n            return \\\"download://\\\" + aliUrl;\\n        }\\n    } else {\\n        return aliUrl;\\n    }\\n}\\n$.exports.getModeUrl = getModeUrl;\\n$.exports.doubleTreating = doubleTreating;\\n$.exports.dealResult = dealResult;\"},{\"col_type\":\"movie_3\",\"name\":\"è§„åˆ™è§£æ\",\"path\":\"ParseRlue\",\"rule\":\"function toPath(value) {\\n    if (typeof value !== 'string') {\\n        return [];\\n    }\\n    let path = [];\\n    let current = '';\\n    let inBrackets = false;\\n    let escape = false;\\n    for (let i = 0; i < value.length; i++) {\\n        let char = value[i];\\n        if (escape) {\\n            current += char;\\n            escape = false;\\n        } else if (char === '\\\\\\\\') {\\n            escape = true;\\n        } else if (char === '.' && !inBrackets) {\\n            path.push(current);\\n            current = '';\\n        } else if (char === '[') {\\n            inBrackets = true;\\n        } else if (char === ']') {\\n            inBrackets = false;\\n        } else {\\n            current += char;\\n        }\\n    }\\n    if (current) {\\n        path.push(current);\\n    }\\n    return path;\\n}\\n\\nfunction getJson(obj, path) {\\n    if (!obj || !Array.isArray(path)) {\\n        return undefined;\\n    }\\n    if (path.length === 0) {\\n        return obj;\\n    }\\n    let current = obj;\\n    for (let i = 0; i < path.length; i++) {\\n        let key = path[i];\\n\\n        if (current === null || current === undefined || typeof current !== 'object') {\\n            return undefined;\\n        }\\n        current = current[key];\\n    }\\n    return current;\\n}\\n\\nfunction dealRule(json, rule, basicUrl) {\\n    if (!rule) return;\\n    rule = rule.split(\\\"@js=\\\");\\n    let rule0 = rule.at(0);\\n    let t = \\\"\\\";\\n    if (rule0) {\\n        t = getJson(json, toPath(rule0));\\n    } else {\\n        t = json;\\n    }\\n    if (rule.length > 1) {\\n        return new Function(\\\"input\\\", \\\"$$\\\", \\\"basicUrl\\\", '\\\"use strict\\\";return ' + rule.at(1))(t, json, basicUrl);\\n    }\\n    return t;\\n}\\n\\nfunction parseSearchJson(url, rule) {\\n    let json = JSON.parse(fetch(url));\\n    let rules = rule.split(\\\"\\\\n\\\");\\n    let list = getJson(json, toPath(rules.at(0)));\\n    if (!list || !Array.isArray(list)) {\\n        throw new Error(\\\"JSON:åˆ—è¡¨è§£æä¸ºç©º\\\");\\n    }\\n    let data = [];\\n    for (let it of list) {\\n        data.push({\\n            title: dealRule(it, rules.at(1), url),\\n            url: dealRule(it, rules.at(2), url),\\n            desc: dealRule(it, rules.at(3), url),\\n            pic_url: dealRule(it, rules.at(4), url),\\n        });\\n    }\\n    return data;\\n}\\n\\nfunction parseUrlJson(url, rule, basicUrl) {\\n    if (rule.startsWith(\\\"@js=\\\")) {\\n        return dealRule(url, rule, basicUrl);\\n    } else {\\n        let json = JSON.parse(fetch(url));\\n        return dealRule(json, rule, basicUrl);\\n    }\\n\\n}\\n\\nfunction dealRuleForHtml(html, rule, basicUrl) {\\n    if (!rule) return;\\n    rule = rule.split(\\\"@js=\\\");\\n    let rule0 = rule.at(0);\\n    let t = \\\"\\\";\\n    if (rule0) {\\n        t = pdfh(html, rule0);\\n    } else {\\n        t = html\\n    }\\n    if (rule.length > 1) {\\n        return new Function(\\\"input\\\", \\\"$$\\\", \\\"basicUrl\\\", '\\\"use strict\\\";return ' + rule.at(1))(t, html, basicUrl);\\n    }\\n    return t;\\n}\\n\\nfunction parseSearchHtml(url, rule) {\\n    let html = fetch(url);\\n    let rules = rule.split(\\\"\\\\n\\\");\\n    let list = pdfa(html, rules.at(0));\\n    if (!list || !Array.isArray(list)) {\\n        throw new Error(\\\"HTML:åˆ—è¡¨è§£æä¸ºç©º\\\");\\n    }\\n    let data = [];\\n    for (let it of list) {\\n        let curl = dealRuleForHtml(it, rules.at(2), url);\\n        data.push({\\n            title: dealRuleForHtml(it, rules.at(1), url),\\n            url: curl.startsWith(\\\"http\\\") ? curl : (getHome(url) + curl),\\n            desc: dealRuleForHtml(it, rules.at(3), url),\\n            pic_url: dealRuleForHtml(it, rules.at(4), url),\\n        });\\n    }\\n    return data;\\n}\\n\\nfunction parseUrlHtml(url, rule, basicUrl) {\\n    if (rule.startsWith(\\\"@js=\\\")) {\\n        return dealRuleForHtml(url, rule, basicUrl);\\n    } else {\\n        let html = fetch(url);\\n        return dealRuleForHtml(html, rule, basicUrl);\\n    }\\n}\\n$.exports = {\\n    parseSearchJson,\\n    parseUrlJson,\\n    parseSearchHtml,\\n    parseUrlHtml\\n};\"},{\"col_type\":\"movie_3\",\"name\":\"æˆ‘çš„é˜¿é‡Œ\",\"path\":\"myaliyun\",\"rule\":\"js:\\n//@author LoyDgIk\\nconst AliAccessApi = $.require(\\\"aliPlayApi\\\");\\nlet openAPIList = [\\\"alist\\\", \\\"drive\\\", \\\"tvbox\\\", \\\"XBY\\\", \\\"TV\\\"];\\nlet shareInfo = MY_PARAMS.shareInfo;\\nif (MY_PARAMS.transfer) {\\n    if (!shareInfo) {\\n        shareInfo = MY_PARAMS;\\n    }\\n    MY_PARAMS = {\\n        isHome: true,\\n        shareInfo\\n    };\\n}\\n\\nlet fileId = MY_PARAMS.fileId || \\\"root\\\";\\nlet searchKey = decodeURIComponent(getParam(\\\"searchKey\\\", \\\"\\\")) || undefined;\\nlet isSearch = !!searchKey;\\n\\nlet pageId = String(Date.now()).slice(6);\\n\\nlet skipFile = Number(getItem(\\\"myskipFile\\\", \\\"0\\\"));\\n\\nfunction signInReward(aliAccessApi) {\\n    let today = $.dateFormat(Date.now(), \\\"yyyyMMdd\\\");\\n    let lastday = getItem(\\\"AliDay\\\", \\\"0\\\");\\n    if (today != lastday && new Date().getHours() >= 0) {\\n        setItem(\\\"AliDay\\\", today);\\n        let result = \\\"\\\";\\n        try {\\n            if ((result = aliAccessApi.signInReward())) {\\n                toast(result);\\n            } else {\\n                toast(result);\\n            }\\n        } catch (e) {\\n            toast(\\\"ç­¾åˆ°å¤±è´¥:\\\" + e.toString());\\n        }\\n    }\\n}\\n\\nfunction formatDate(_date, fmt) {\\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\\n    return $.dateFormat(date, fmt || \\\"yyyy-MM-dd HH:mm:ss\\\")\\n}\\n\\nfunction formatSize(size) {\\n    if (!size) {\\n        return '';\\n    }\\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\\n    let i = 0;\\n    while (size >= 1024) {\\n        size /= 1024;\\n        i++;\\n    }\\n    size = i ? Number(size.toFixed(2)) : size;\\n    return `${size} ${units[i]}`;\\n}\\n\\nfunction setMyPaCache(key, value) {\\n    MY_PARAMS[key] = value;\\n}\\n\\nfunction saveMyPaCache() {\\n    setPageParams(MY_PARAMS);\\n}\\n\\nfunction setMarker(marker) {\\n    setMyPaCache(\\\"marker\\\", marker);\\n}\\n\\n\\nif (MY_PARAMS.noPic) {\\n    setPagePicUrl();\\n    setMyPaCache(\\\"noPic\\\", false);\\n}\\n/*\\nfunction setVideoItemCache(videoItemCache) {\\n    setMyPaCache(\\\"videoItemCache\\\", videoItemCache);\\n}\\n\\nfunction setSubtitleCache(subtitleCache) {\\n    setMyPaCache(\\\"subtitleCache\\\", subtitleCache);\\n}*/\\n\\nlet iconType = \\\"ai|apk|avi|css|dmg|exe|flv|gif|hiker|html|iso|jpg|js|json|log|mov|mp3|mp4|otf|php|png|ppt|psd|table|txt|wav|xls|zip|css|doc|epub|exc|htm|xlsx\\\".split('|');\\n\\nfunction getIcon(ext, type) {\\n    let root = \\\"https://gitcode.net/qq_32394351/dr/-/raw/master/img/æ–‡ä»¶ç±»å‹2/\\\";\\n    if (type === \\\"folder\\\") {\\n        return root + \\\"æ–‡ä»¶å¤¹.svg\\\";\\n    }\\n    if (iconType.includes((ext || \\\"\\\").toLowerCase())) {\\n        return root + ext + \\\".svg\\\";\\n    }\\n    return root + \\\"æ–‡ä»¶.svg\\\";\\n\\n}\\n\\nfunction load(items) {\\n    const aliAccessApi = AliAccessApi.createDefault();\\n\\n    let orders = {\\n        \\\"åç§°æ­£åº\\\": \\\"name#ASC\\\",\\n        \\\"åç§°å€’åº\\\": \\\"name#DESC\\\",\\n        \\\"æ—¶é—´æ­£åº\\\": \\\"updated_at#ASC\\\",\\n        \\\"æ—¶é—´å€’åº\\\": \\\"updated_at#DESC\\\",\\n        \\\"å¤§å°æ­£åº\\\": \\\"size#ASC\\\",\\n        \\\"å¤§å°å€’åº\\\": \\\"size#DESC\\\"\\n    };\\n    let playMode = getItem(\\\"my_aliyun_playMode\\\", \\\"è½¬ç \\\");\\n    let ordersKeys = Object.keys(orders);\\n    let orderName = getItem(\\\"aliyun_order\\\", ordersKeys[0]);\\n    let order = orders[orderName].split(\\\"#\\\");\\n    let styles = [\\\"text_1\\\", \\\"movie_2\\\", \\\"card_pic_3\\\", \\\"avatar\\\", \\\"è¿½å‰§\\\", \\\"çœ‹å›¾\\\"];\\n    let style = getItem(\\\"aliyun_style\\\", styles[0]);\\n\\n    let isBackupDrivid = MY_PARAMS.isBackupDrivid || getItem(\\\"myAliPanDrivid\\\", \\\"false\\\") === \\\"true\\\";\\n    aliAccessApi.setMyDrividType(isBackupDrivid);\\n    if (MY_PAGE === 1) {\\n        if (!getMyVar(\\\"mountzimu\\\", \\\"\\\")) {\\n            storage0.putMyVar(\\\"mountzimu\\\", {});\\n            addListener(\\\"onClose\\\", $.toString(() => {\\n                clearMyVar(\\\"mountzimu\\\");\\n                clearMyVar(\\\"aliShareToken\\\");\\n                clearVar(\\\"dm_share\\\");\\n                clearMyVar(\\\"dmlist\\\");\\n                clearMyVar(\\\"listSearchKey\\\");\\n                clearMyVar(\\\"dm_listUrlList\\\");\\n            }));\\n        }\\n        setMarker();\\n        if (MY_PARAMS.isHome) {\\n            //signInReward(aliAccessApi);\\n            items.push({\\n                title: \\\"å¤‡ä»½ç›˜\\\" + [\\\"\\\", \\\"âˆš\\\"][Number(isBackupDrivid)],\\n                url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n                    setItem(\\\"myAliPanDrivid\\\", \\\"true\\\");\\n                    refreshPage();\\n                    return \\\"hiker://empty\\\";\\n                }),\\n                col_type: \\\"text_2\\\",\\n            });\\n            items.push({\\n                title: \\\"èµ„æºç›˜\\\" + [\\\"âˆš\\\", \\\"\\\"][Number(isBackupDrivid)],\\n                url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n                    setItem(\\\"myAliPanDrivid\\\", \\\"false\\\");\\n                    refreshPage();\\n                    return \\\"hiker://empty\\\";\\n                }),\\n                col_type: \\\"text_2\\\",\\n            });\\n        }\\n        if (shareInfo) {\\n            items.push({\\n                title: \\\"â€œâ€œè½¬å­˜åˆ°å½“å‰æ–‡ä»¶å¤¹â€â€\\\",\\n                url: $(\\\"#noLoading#\\\").lazyRule((shareInfo, isBackupDrivid, fileId) => {\\n                    const AliAccessApi = $.require(\\\"aliPlayApi\\\");\\n                    let aliAccessApi = AliAccessApi.createDefault(shareInfo.shareId, shareInfo.sharePwd, shareInfo.shareToken);\\n                    aliAccessApi.setMyDrividType(isBackupDrivid);\\n                    aliAccessApi.copyFileToCloudFile(shareInfo.fileId, fileId);\\n                    backToHome();\\n                    return \\\"hiker://empty\\\";\\n                }, shareInfo, isBackupDrivid, fileId),\\n                col_type: \\\"text_center_1\\\",\\n            });\\n        }\\n        if (!isSearch) {\\n            items.push({\\n                title: \\\"æœç´¢\\\",\\n                url: $.toString(() => {\\n                    input = input.trim();\\n                    if (!input) return \\\"toast://è¯·è¾“å…¥å…³é”®è¯\\\";\\n                    return \\\"hiker://page/myaliyun#noHistory##fullTheme#?page=fypage&searchKey=\\\" + encodeURIComponent(input);\\n                }),\\n                col_type: \\\"input\\\",\\n                extra: {\\n                    onChange: \\\"putMyVar('listSearchKey',input)\\\",\\n\\n                }\\n            });\\n        } else {\\n            items.push({\\n                title: \\\"â€œâ€œ\\\" + searchKey + \\\"â€â€çš„æœç´¢ç»“æœ\\\",\\n                url: \\\"hiker://empty\\\",\\n                col_type: \\\"text_center_1\\\",\\n                extra: {\\n                    lineVisible: false\\n                }\\n            });\\n        }\\n        let funcItems = [];\\n        funcItems.push({\\n            title: style,\\n            url: $(styles, 1, \\\"æ’å¸ƒæ ·å¼\\\").select(() => {\\n                setItem(\\\"aliyun_style\\\", input);\\n                refreshPage();\\n                return \\\"toast://å·²åˆ‡æ¢\\\";\\n            }),\\n            pic_url: \\\"http://123.56.105.145/img/ali_icon.svg\\\"\\n        }, {\\n            title: orderName,\\n            url: $(ordersKeys, 2, \\\"æ’åºæ–¹å¼\\\").select(() => {\\n                setItem(\\\"aliyun_order\\\", input);\\n                refreshPage();\\n                return \\\"toast://åˆ‡æ¢æˆåŠŸ\\\";\\n            }),\\n            pic_url: \\\"http://123.56.105.145/img/ali_sort.svg\\\"\\n        }, {\\n            title: playMode,\\n            url: $([\\\"è½¬ç \\\", \\\"åŸç”»\\\", \\\"æé€ŸåŸç”»\\\"], 1, \\\"æ’­æ”¾æ¨¡å¼\\\").select(() => {\\n                setItem(\\\"my_aliyun_playMode\\\", input);\\n                refreshPage();\\n                return \\\"toast://åˆ‡æ¢æˆåŠŸ\\\";\\n            }),\\n            pic_url: \\\"http://123.56.105.145/img/ali_play.svg\\\",\\n        });\\n\\n        funcItems.push({\\n            title: openAPIList[getItem(\\\"openApiMode\\\", \\\"0\\\")],\\n            url: $(openAPIList, 1, \\\"åŸç”»API(ä¸è¦é¢‘ç¹åˆ‡æ¢)\\\").select((openAPIList) => {\\n                setItem(\\\"openApiMode\\\", String(openAPIList.indexOf(input)));\\n                deleteFile($.require(\\\"tokenPath\\\").openTokensFilepath);\\n                refreshPage(false);\\n                return \\\"toast://å·²åˆ‡æ¢ä¸º\\\" + input;\\n            }, openAPIList),\\n            pic_url: \\\"http://123.56.105.145/img/ali_api.svg\\\",\\n        });\\n\\n        if (!isSearch) {\\n            funcItems.push({\\n                title: \\\"åŠŸèƒ½\\\",\\n                url: $([\\\"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\", \\\"è·å–å¼¹å¹•æœç´¢è§„åˆ™\\\", \\\"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\\\", \\\"æ¨é€åˆ°TVBox\\\", \\\"è®¾ç½®æ”¶è—å°é¢\\\", \\\"è·å–æŠ•å±IP\\\" , \\\"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\\\"], 2, \\\"æ›´å¤šåŠŸèƒ½\\\").select(() => {\\n                    switch (input) {\\n                        case \\\"æ‰¹é‡æŒ‚è½½æœ¬åœ°å¼¹å¹•\\\":\\n                            return \\\"hiker://page/dmMount#noHistory##noRecordHistory#\\\";\\n                        case \\\"æŸ¥çœ‹æ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\":\\n                            let zm = storage0.getMyVar(\\\"mountzimu\\\", {});\\n                            let tip = zm.name ? \\\"å½“å‰å­—å¹•æ–‡ä»¶\\\\n\\\" + zm.name + \\\".\\\" + zm.ext : \\\"è¿˜æœªæ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\";\\n                            confirm({\\n                                title: 'æ‰‹åŠ¨æŒ‚è½½å­—å¹•',\\n                                content: tip + \\\"\\\\n(ç‚¹å‡»å–æ¶ˆå¯ä»¥æ¸…é™¤æŒ‚è½½å­—å¹•)\\\",\\n                                cancel: () => {\\n                                    clearMyVar(\\\"mountzimu\\\");\\n                                    return \\\"toast://å·²æ¸…é™¤æ‰‹åŠ¨æŒ‚è½½å­—å¹•\\\";\\n                                }\\n                            });\\n                            return;\\n                        case \\\"è·å–å¼¹å¹•æœç´¢è§„åˆ™\\\":\\n                            let rule = {\\n                                \\\"js\\\": JSON.stringify(\\\"hiker://page/loadDm?rule=\\\" + MY_RULE.title + \\\"&title=\\\") + \\\"+encodeURIComponent(playdata.title.split('-')[0]);\\\",\\n                                \\\"name\\\": MY_RULE.title + \\\"å¼¹å¹•æœç´¢\\\"\\n                            };\\n                            return \\\"rule://\\\" + base64Encode(\\\"ï¿¥projection_screenï¿¥\\\" + JSON.stringify(rule));\\n                        case \\\"æ¨é€åˆ°TVBox\\\":\\n                            return \\\"hiker://page/tvboxPush#noHistory##noRecordHistory#\\\";\\n                        case \\\"è®¾ç½®æ”¶è—å°é¢\\\":\\n                            return $([\\\"è®¾ç½®å°é¢åœ°å€\\\", \\\"æœç´¢å°é¢\\\"], 1).select(() => {\\n                                if (input === \\\"è®¾ç½®å°é¢åœ°å€\\\") {\\n                                    return $(\\\"\\\", \\\"è¯·è¾“å…¥å›¾ç‰‡åœ°å€\\\").input(() => {\\n                                        input = input.trim();\\n                                        if (!input) return \\\"toast://è¯·è¾“å…¥åœ°å€\\\";\\n                                        setPagePicUrl(input);\\n                                        return \\\"toast://ä¿®æ”¹æˆåŠŸ\\\";\\n                                    });\\n                                } else {\\n                                    return \\\"hiker://page/frontCover#noHistory##noRecordHistory#\\\";\\n                                }\\n                            });\\n                        case \\\"è·å–æŠ•å±IP\\\":\\n                            let ip = $.require(\\\"aliUtil\\\").getIPv4Address();\\n                            if (ip.startsWith(\\\"192.168.\\\")) {\\n                                return $(ip + \\\"\\\\nè¯¥IPé€‚ç”¨äºæµé‡+çƒ­ç‚¹çš„æŠ•å±\\\\nè¯·æ›¿æ¢é“¾æ¥ä¸­çš„0.0.0.0\\\").confirm((ip) => {\\n                                    return \\\"copy://\\\" + ip;\\n                                }, ip);\\n                            } else {\\n                                return $(ip + \\\"\\\\nè·å–å¤±è´¥éç¨³å®šIP,è¯·å¼€å¯çƒ­ç‚¹å†ä½¿ç”¨,è¯¥IPå¯èƒ½ä¼šå˜,ä¸èƒ½æŠ•å±\\\").confirm(() => {});\\n                            }\\n                        case \\\"æé€ŸåŸç”»ä¸‹è½½çº¿ç¨‹\\\":\\n                            return $(getItem(\\\"speedThread\\\", \\\"10\\\"), \\\"è¯·è¾“å…¥3-32ä¹‹é—´çš„æ•´æ•°\\\").input(() => {\\n                                let speedThread = parseInt(input);\\n                                if (speedThread < 3 || speedThread > 32) {\\n                                    return \\\"toast://è®¾ç½®ä¸åˆæ³•\\\";\\n                                }\\n                                setItem(\\\"speedThread\\\", String(speedThread));\\n                                return \\\"toast://è®¾ç½®æˆåŠŸ\\\";\\n                            });\\n                    }\\n                }),\\n                pic_url: \\\"http://123.56.105.145/img/ali_fileinto.svg\\\",\\n                extra: {\\n                    pageId: pageId,\\n                    fileId: fileId,\\n                    folderName: getPageTitle()\\n                }\\n            });\\n        } else {\\n            funcItems.push({\\n                title: [\\\"ALL\\\", \\\"ä»…æ–‡ä»¶\\\", \\\"ä»…æ–‡ä»¶å¤¹\\\"][skipFile],\\n                url: $([\\\"ALL\\\", \\\"ä»…æ–‡ä»¶\\\", \\\"ä»…æ–‡ä»¶å¤¹\\\"]).select(() => {\\n                    setItem(\\\"myskipFile\\\", String(MY_INDEX));\\n                    refreshPage(false);\\n                    return \\\"hiker://empty\\\";\\n                }),\\n                pic_url: \\\"hiker://images/icon_search6\\\",\\n            });\\n        }\\n        let funStyle = [\\\"\\\", \\\"\\\", \\\"\\\", \\\"icon_small_3\\\", \\\"icon_round_small_4\\\", \\\"icon_5\\\"][funcItems.length];\\n        items.push.apply(items, funcItems.map(v => (v.col_type = funStyle) && v));\\n        items.push({\\n            col_type: \\\"line_blank\\\"\\n        });\\n    }\\n    let rescod = {};\\n    let marker = MY_PARAMS.marker;\\n    if (isSearch) {\\n        rescod = aliAccessApi.getSearchListFile(searchKey, marker, order[0], order[1], skipFile);\\n    } else {\\n        rescod = aliAccessApi.getListFile(fileId, marker, order[0], order[1]);\\n    }\\n    if (rescod.next_marker) {\\n        setMarker(rescod.next_marker);\\n    } else {\\n        setMarker();\\n    }\\n\\n    var conts = rescod.items;\\n    //å­—å¹•åŒ¹é…å‡†å¤‡\\n    let subExts = [\\\"vtt\\\", \\\"srt\\\", \\\"ass\\\"];\\n    var zimulist = [];\\n    conts.forEach((item) => {\\n        if (subExts.includes(item.file_extension && item.file_extension.toLowerCase())) {\\n            let name = item.name.replace('.' + item.file_extension, '');\\n            zimulist.push({\\n                ext: item.file_extension,\\n                file_id: item.file_id,\\n                name: name\\n            });\\n        }\\n    });\\n    //å¤„ç†å¤¸é¡µåŒ¹é…å­—å¹•\\n    /*\\n    let hasSub = zimulist.length > 0;\\n    if (hasSub&&rescod.next_marker) {\\n        if (zimulist.length > 4) {\\n            setSubtitleCache(zimulist.slice(-4));\\n        } else {\\n            setSubtitleCache(zimulist);\\n        }\\n    }\\n    let lastItem = conts.at(-1);\\n    if (hasSub&&lastItem&&lastItem.category === \\\"video\\\") {\\n        setVideoItemCache(conts.splice(conts.length-1,1));\\n    }\\n    if (MY_PAGE > 1) {\\n        let subtitleCache = MY_PARAMS.subtitleCache || [];\\n        zimulist = zimulist.concat(subtitleCache);\\n        let videoItemCache = MY_PARAMS.videoItemCache || [];\\n        conts = videoItemCache.concat(conts);\\n        setSubtitleCache();\\n        setVideoItemCache();\\n    }*/\\n    //ç®€ä½“ä¼˜å…ˆ\\n    zimulist.sort((a, b) => (b.name.endsWith(\\\".sc\\\") || b.name.endsWith(\\\".chs\\\")) - (a.name.endsWith(\\\".sc\\\") || a.name.endsWith(\\\".chs\\\")));\\n    //end\\n    let titleHead = {\\n        video: \\\"ğŸ¬\\\",\\n        audio: \\\"ğŸµ\\\",\\n        doc: \\\"ğŸ“‘\\\",\\n        image: \\\"ğŸ–¼\\\",\\n        zip: \\\"ğŸ“¦\\\",\\n        folder: \\\"ğŸ“‚\\\"\\n    };\\n\\n    function getHead(type, ext) {\\n        let head = titleHead[type];\\n        if (subExts.includes(ext)) {\\n            head = \\\"ğŸ•¸\\\";\\n        }\\n        return head || \\\"â“\\\";\\n    }\\n\\n    function getPreviewPic(fileItem) {\\n        if (fileItem.thumbnail) {\\n            return $(\\\"https://empty?\\\" + fileItem.file_id).image((pic) => {\\n                try {\\n                    return fetch(pic, {\\n                        inputStream: true\\n                    });\\n                } catch (e) {\\n                    return null;\\n                }\\n            }, fileItem.thumbnail);\\n        }\\n    }\\n\\n    function deleteDFile(fileId, isBackupDrivid, name) {\\n        return $(\\\"ç¡®è®¤æ°¸ä¹…åˆ é™¤[\\\" + name + \\\"]\\\").confirm((fileId, isBackupDrivid) => {\\n            const AliAccessApi = $.require(\\\"aliPlayApi\\\");\\n            let aliAccessApi = AliAccessApi.createDefault();\\n            aliAccessApi.setMyDrividType(isBackupDrivid);\\n            aliAccessApi.deleteeCloudFile(fileId);\\n            refreshPage(false);\\n            return \\\"hiker://empty\\\";\\n        }, fileId, isBackupDrivid);\\n    }\\n    let folderStyle, fileStyle;\\n    let filterType = [];\\n    if (style === \\\"è¿½å‰§\\\") {\\n        folderStyle = \\\"avatar\\\";\\n        fileStyle = \\\"movie_2\\\";\\n        filterType.push(\\\"video\\\");\\n        items.push({\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"è¿½å‰§æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œè§†é¢‘\\\".small().fontcolor(\\\"grey\\\"),\\n            url: \\\"hiker://empty\\\",\\n            col_type: \\\"text_center_1\\\",\\n            extra: {\\n                lineVisible: false\\n            }\\n        });\\n    } else if (style === \\\"çœ‹å›¾\\\") {\\n        folderStyle = \\\"avatar\\\";\\n        fileStyle = \\\"card_pic_3\\\";\\n        filterType.push(\\\"image\\\");\\n        items.push({\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"çœ‹å›¾æ¨¡å¼åªæ˜¾ç¤ºæ–‡ä»¶å¤¹å’Œå›¾ç‰‡\\\".small().fontcolor(\\\"grey\\\"),\\n            url: \\\"hiker://empty\\\",\\n            col_type: \\\"text_center_1\\\",\\n            extra: {\\n                lineVisible: false\\n            }\\n        });\\n    } else {\\n        folderStyle = fileStyle = style;\\n    }\\n    let noSkipFile = true;\\n    for (let i = 0; i < conts.length; i++) {\\n        let fileItem = conts[i];\\n        let cate = fileItem.category;\\n        let desc = formatDate(fileItem.updated_at);\\n        let pic_url = getIcon(fileItem.file_extension, fileItem.type);\\n\\n        if (fileItem.type === \\\"folder\\\") {\\n            let title = (folderStyle === \\\"text_1\\\" ? titleHead.folder : \\\"\\\") + fileItem.name;\\n            items.push({\\n                title: title,\\n                url: 'hiker://page/myaliyun?page=fypage',\\n                col_type: folderStyle,\\n                desc: formatDate(fileItem.updated_at),\\n                pic_url: pic_url,\\n                extra: {\\n                    fileId: fileItem.file_id,\\n                    isBackupDrivid,\\n                    pageTitle: fileItem.name,\\n                    shareInfo,\\n                    noPic: true,\\n                    longClick: [{\\n                        title: \\\"åˆ é™¤æ–‡ä»¶å¤¹\\\",\\n                        js: $.toString(deleteDFile, fileItem.file_id, isBackupDrivid, fileItem.name)\\n                    }]\\n                }\\n            });\\n        } else if (noSkipFile) {\\n            if (filterType.length > 0 && !filterType.includes(cate)) {\\n                continue;\\n            }\\n            let subtitle, cls, longc = [{\\n                title: \\\"åˆ é™¤æ–‡ä»¶\\\",\\n                js: $.toString(deleteDFile, fileItem.file_id, isBackupDrivid, fileItem.name)\\n            }];\\n            let title = fileItem.name;\\n            let nameNotExt = fileItem.name.replace('.' + fileItem.file_extension, '');\\n            if (subExts.includes(fileItem.file_extension)) {\\n                longc.push({\\n                    title: \\\"æŒ‚è½½å­—å¹•\\\",\\n                    js: $.toString((zm) => {\\n                        storage0.putMyVar('mountzimu', zm);\\n                        return 'toast://æŒ‚è½½å®Œæˆï¼Œå½“å‰å­—å¹•æ–‡ä»¶: ' + zm.name + '.' + zm.ext;\\n                    }, {\\n                        ext: fileItem.file_extension,\\n                        file_id: fileItem.file_id,\\n                        name: nameNotExt\\n                    }),\\n                });\\n            }\\n            if (cate === \\\"video\\\") {\\n                if (zimulist.length) {\\n                    subtitle = zimulist.find(v => v.name.includes(nameNotExt));\\n                }\\n                cls = \\\"playlist v\\\" + pageId;\\n            }\\n            if (fileStyle === \\\"text_1\\\") {\\n                desc += \\\"\\\\t\\\\t\\\" + formatSize(fileItem.size);\\n                title = getHead(cate, fileItem.file_extension) + title;\\n            } else if ([\\\"video\\\", \\\"image\\\"].includes(cate)) {\\n                pic_url = getPreviewPic(fileItem) || pic_url;\\n            }\\n            items.push({\\n                title: title,\\n                url: $(\\\"#noPre#\\\").lazyRule((fileId, cate, isBackupDrivid, subtitle) => {\\n                    return $.require(\\\"myalilazy\\\")(fileId, cate, isBackupDrivid, subtitle);\\n                }, fileItem.file_id, cate, isBackupDrivid, subtitle),\\n                desc: desc,\\n                pic_url: pic_url,\\n                extra: {\\n                    id: fileItem.file_id,\\n                    longClick: longc,\\n                    cls: cls,\\n                    //inheritTitle: false,\\n                    pageTitle: fileItem.name\\n                },\\n                col_type: fileStyle\\n            });\\n        }\\n    }\\n    if (conts.length === 0) {\\n        items.push({\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\\\".fontcolor(\\\"Gray\\\"),\\n            extra: {\\n                lineVisible: false,\\n            }\\n        });\\n    }\\n}\\n\\nlet items = [];\\ntry {\\n    if (MY_PAGE > 1 && !MY_PARAMS.marker) {\\n        items.push({\\n            col_type: \\\"text_center_1\\\",\\n            url: \\\"hiker://empty\\\",\\n            title: \\\"â€œâ€œâ€â€\\\" + \\\"~~~ä»€ä¹ˆéƒ½æ²¡æœ‰äº†å“¦~~~\\\".fontcolor(\\\"Gray\\\"),\\n            extra: {\\n                lineVisible: false,\\n            }\\n        });\\n    } else {\\n        load(items);\\n    }\\n} catch (e) {\\n\\n    log(\\\"åˆ—è¡¨åŠ è½½å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n    items.push({\\n        title: 'æ¬§æ¬§ï¼ŒæŠ¥é”™äº†ã€‚åœ¨åˆ·æ–°å‡ æ¬¡ï¼Ÿæˆ–è€…æ›´æ¢æ–‡ä»¶å¤¹ã€‚',\\n        url: \\\"hiker://empty\\\",\\n        desc: e.toString(),\\n        col_type: 'text_center_1'\\n    });\\n    //throw e;\\n}\\nsaveMyPaCache();\\nsetResult(items);\"},{\"col_type\":\"movie_3\",\"name\":\"æˆ‘çš„é˜¿é‡ŒLazy\",\"path\":\"myalilazy\",\"rule\":\"const AliAccessApi = $.require(\\\"aliPlayApi\\\");\\nconst {\\n    openTokensFilepath,\\n    aliTokensFilepath\\n} = $.require(\\\"tokenPath\\\");\\n\\nfunction aliM3u8Proxy(fileId, aliToken, isBackupDrivid, title) {\\n    let suffix = \\\"media.m3u8\\\";\\n    let urlname = \\\"url\\\";\\n    let cacheFilePath = \\\"hiker://files/_cache/\\\" + fileId + MY_PARAMS.timestamp[0]+ \\\".m3u8\\\"\\n    //è¿‡æœŸè·å–æ’­æ”¾åŸå§‹é“¾æ¥\\n    function getAliPlayUrl(fileId, line) {\\n        let aliurl;\\n        try {\\n            const AliAccessApi = $.require(\\\"hiker://page/aliPlayApi?rule=\\\" + title);\\n            let aliAccessApi = AliAccessApi.createDefault(null, null, null, aliToken, null, title).setMyDrividType(isBackupDrivid);\\n            let playUrlList =  aliAccessApi.getVideoCloudPreview(fileId) || [];\\n\\n            aliurl = playUrlList.find(v => v.template_id == line)[urlname];\\n        } catch (e) {\\n            log(e.toString());\\n            throw e;\\n        }\\n        return aliurl;\\n    }\\n\\n    function getM3u8Content(playurl) {\\n        //media.m3u8\\n        let home = playurl.split(suffix)[0];\\n        let f = fetch(playurl, {\\n            headers: {\\n                \\\"User-Agent\\\": PC_UA,\\n                \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n            },\\n            timeout: 3000\\n        }).split(\\\"\\\\n\\\");\\n        let ff = f.map(it => {\\n            if (it.startsWith(\\\"media-\\\")) {\\n                return \\\"/proxy?url=\\\" + base64Encode(home + it)+\\\"&timestamp=\\\"+MY_PARAMS.timestamp[0];\\n            }\\n            return it;\\n        }).join(\\\"\\\\n\\\");\\n\\n        writeFile(cacheFilePath, ff);\\n        return ff;\\n    }\\n\\n    function updateTsUrl(url) {\\n        let fid = url.split('&f=')[1].split('&')[0];\\n        //log('sfid-' + fid);\\n        let f = fetch(cacheFilePath).split(\\\"\\\\n\\\");\\n        f.forEach(it => {\\n            if (it && it.startsWith('/proxy?url=')) {\\n                let furl = base64Decode(it.replace('/proxy?url=', '').split(\\\"&\\\")[0]);\\n                if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\\n                    url = furl;\\n                }\\n            }\\n        })\\n        let expires = url.split('x-oss-expires=')[1].split('&')[0];\\n        const lasttime = parseInt(expires) - Date.now() / 1000;\\n        if (lasttime < 60) {\\n            //log('è¿‡æœŸæ›´æ–°')\\n            let line = url.split('/media')[0]; //å–ä¹‹å‰æ’­æ”¾çš„tsæ®µçº¿è·¯\\n            line = line.substring(line.lastIndexOf('/') + 1);\\n            let f = getM3u8Content(getAliPlayUrl(fid, line)).split(\\\"\\\\n\\\");\\n            f.forEach(it => {\\n                if (it && it.startsWith('/proxy?url=')) {\\n                    let furl = base64Decode(it.replace('/proxy?url=', ''));\\n                    if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\\n                        url = furl;\\n                    }\\n                }\\n            })\\n\\n        }\\n        return url;\\n    }\\n    try {\\n        let url = base64Decode(MY_PARAMS.url[0]);\\n        if (url.includes(\\\".ts\\\")) {\\n            return JSON.stringify({\\n                statusCode: 302,\\n                headers: {\\n                    \\\"Location\\\": updateTsUrl(url),\\n                    \\\"User-Agent\\\": PC_UA,\\n                    \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n                }\\n            });\\n        } else {\\n            let templateId = MY_PARAMS.templateId[0];\\n            if(fileExist(cacheFilePath)){\\n                return getM3u8Content(getAliPlayUrl(fileId, templateId));\\n            }else{\\n                return getM3u8Content(url);\\n            }\\n        }\\n    } catch (e) {\\n        log(\\\"#ä»£ç†æ’­æ”¾å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n    }\\n}\\nconst transcoding = {\\n    UHD: \\\"4K è¶…æ¸…\\\",\\n    QHD: \\\"2K è¶…æ¸…\\\",\\n    FHD: \\\"1080 å…¨é«˜æ¸…\\\",\\n    HD: \\\"720 é«˜æ¸…\\\",\\n    SD: \\\"540 æ ‡æ¸…\\\",\\n    LD: \\\"360 æµç•…\\\"\\n};\\n\\nfunction getVideo(aliAccessApi, fileId) {\\n\\n    let playUrlList = aliAccessApi.getVideoCloudPreview(fileId) || [];\\n\\n    let serverAddress = startProxyServer($.toString(aliM3u8Proxy, fileId, aliAccessApi.aliToken,aliAccessApi.myDrividType,MY_RULE.title));\\n\\n    if (playUrlList.length > 0) {\\n        let urls = [],\\n            names = [];\\n        playUrlList.forEach((item) => {\\n            urls.push(serverAddress + \\\"?url=\\\" + base64Encode(item.url) + \\\"&timestamp=\\\"+Date.now()+\\\"&templateId=\\\" + item.template_id + \\\"#.m3u8\\\");\\n            names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\\n        });\\n        let heads = new Array(playUrlList.length).fill({\\n            'Referer': 'https://www.aliyundrive.com/'\\n        });\\n        return {\\n            urls: urls,\\n            names: names,\\n            headers: heads,\\n        };\\n    } else {\\n        return {};\\n    }\\n\\n}\\n\\n\\nfunction getPlayFormat(playUrl, title) {\\n    return {\\n        names: [title],\\n        urls: [playUrl + \\\"#isVideo=true##ignoreMusic=true#\\\"],\\n        headers: [{\\n            'Referer': 'https://www.aliyundrive.com/',\\n            \\\"User-Agent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36\\\"\\n        }]\\n    };\\n}\\n\\n\\n$.exports = function(fileId, cate, isBackupDrivid,  zimu) {\\n    if (!fileExist(aliTokensFilepath)) {\\n        toast(\\\"è¯·å…ˆç™»é™†ç™»å½•è´¦å·\\\");\\n        return \\\"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\\\";\\n    }\\n    let aliToken = $.require(aliTokensFilepath);\\n    let aliAccessApi = AliAccessApi.createDefault(null, null, null, aliToken, null);\\n    aliAccessApi.setMyDrividType(isBackupDrivid);\\n    if (cate === \\\"video\\\") {\\n        let playList = [];\\n        let playMode = getItem(\\\"my_aliyun_playMode\\\", \\\"è½¬ç \\\");\\n        try {\\n            \\n            if (playMode === \\\"è½¬ç \\\") {\\n                playList = getVideo(aliAccessApi, fileId) || {};\\n            } else if (playMode === \\\"åŸç”»\\\") {\\n                playList = getPlayFormat(aliAccessApi.openCloudFileToDownUrl(fileId), playMode);\\n            }else if (playMode === \\\"æé€ŸåŸç”»\\\") {\\n                playList = getPlayFormat(aliAccessApi.openCloudFileToDownUrl(fileId)+ \\\"#fastPlayMode##threads=\\\" + getItem(\\\"speedThread\\\", \\\"10\\\") + \\\"#\\\", playMode);\\n            }\\n        } catch (e) {\\n            log(\\\"#\\\" + playMode + \\\"æ’­æ”¾å¤±è´¥#\\\\né”™è¯¯ä¿¡æ¯>\\\" + e.toString() + \\\"\\\\né”™è¯¯è¡Œ>\\\" + e.lineNumber);\\n            if (e.code === \\\"InvalidParameter.RefreshToken\\\") {\\n                toast(\\\"ç™»é™†è¿‡æœŸï¼Œè¯·é‡æ–°ç™»é™†\\\");\\n                return \\\"hiker://page/login#noRecordHistory##noHistory#?noRefresh=1\\\";\\n            } else if (e.code === \\\"QuotaExhausted.Drive\\\") {\\n                return \\\"toast://ç½‘ç›˜ç©ºé—´ä¸è¶³ï¼Œæ— æ³•æ’­æ”¾è¯·æ¸…ç†ã€‚\\\";\\n            }\\n            return \\\"toast://æ’­æ”¾å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å·²æ‰“å°ã€‚\\\\nè¯·æŸ¥çœ‹æ—¥å¿—(LOG)\\\";\\n        }\\n        let mountsub = storage0.getMyVar('mountzimu', {});\\n        if (Object.keys(mountsub).length > 0) {\\n            zimu = mountsub;\\n        }\\n        let subtitle;\\n        if (Object.keys(zimu || {}).length > 0 && playList && playList.urls && playList.urls.length > 0) {\\n            java.lang.Thread.sleep(100);\\n            try {\\n                var zmurl = aliAccessApi.openCloudFileToDownUrl(zimu.file_id);\\n                let path = 'hiker://files/cache/äº‘ç›˜å›/sub.' + zimu.ext;\\n                downloadFile(zmurl, path, {\\n                    'Referer': 'https://www.aliyundrive.com/'\\n                });\\n                subtitle = getPath(path);\\n            } catch (e) {\\n                toast(\\\"å­—å¹•åŠ è½½å¤±è´¥\\\");\\n                log(e.message);\\n            }\\n        }\\n        let dmlist = storage0.getMyVar(\\\"dmlist\\\", []);\\n        let dmlist_cache = getMyVar(\\\"dmlist_cache\\\", \\\"\\\");\\n        if (dmlist_cache && dmlist_cache.startsWith(fileId + \\\"#\\\")) {\\n            playList.danmu = dmlist_cache.replace(fileId + \\\"#\\\", \\\"\\\");\\n        } else if (dmlist.length > 0) {\\n            playList.danmu = \\\"hiker://files/cache/danmu/\\\" + dmlist.splice(0, 1)[0];\\n            putMyVar(\\\"dmlist_cache\\\", fileId + \\\"#\\\" + playList.danmu);\\n            storage0.putMyVar(\\\"dmlist\\\", dmlist);\\n            if (dmlist.length === 0) {\\n                toast(\\\"å¼¹å¹•åˆ—è¡¨å·²å…¨éƒ¨æŒ‚è½½\\\");\\n            }\\n        } /*else {\\n            playList.danmu = getVar(\\\"dm_share\\\", \\\"\\\");\\n        }*/\\n        playList.subtitle = subtitle;\\n        return JSON.stringify(playList);\\n    }\\n\\n    let url = aliAccessApi.openCloudFileToDownUrl(fileId);\\n\\n    if (cate === \\\"image\\\") {\\n        return url + \\\"#.jpg\\\";\\n    } else if (cate === \\\"audio\\\") {\\n        return url + \\\"#isMusic=true#\\\";\\n    } else {\\n        return \\\"download://\\\" + url;\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"openApi:tv\",\"path\":\"openApi_tv\",\"rule\":\"js:\\nfunction OpenApi($this, postApi) {\\n    this.$this = $this;\\n}\\n\\n// ç”Ÿæˆ unique_id\\nfunction generateUUID() {\\n    return 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'.replace(/[x]/g, function() {\\n        return (Math.random() * 16 | 0).toString(16);\\n    });\\n}\\n\\n\\n// ç”Ÿæˆ wifimac\\nfunction generateWifiMac() {\\n    const min = 10 ** 11;\\n    const max = 10 ** 12 - 1;\\n    return Math.floor(Math.random() * (max - min + 1)) + min;\\n}\\nfunction h(charArray, modifier) {\\n    // å»é™¤é‡å¤å­—ç¬¦\\n    var uniqueChars = [];\\n    for (var i = 0; i < charArray.length; i++) {\\n        if (uniqueChars.indexOf(charArray[i]) === -1) {\\n            uniqueChars.push(charArray[i]);\\n        }\\n    }\\n    \\n    var numericModifier = parseInt(modifier.slice(7));\\n    var transformedString = '';\\n    \\n    for (var j = 0; j < uniqueChars.length; j++) {\\n        var c = uniqueChars[j];\\n        var code = Math.abs(c.charCodeAt(0) - (numericModifier % 127) - 1);\\n        transformedString += String.fromCharCode(code < 33 ? code + 33 : code);\\n    }\\n    \\n    return transformedString;\\n}\\n//eval(getCryptoJS());\\n/*\\nconst CryptoUtil = $.require(\\\"hiker://assets/crypto-java.js\\\");\\n\\n        let key = CryptoUtil.Data.parseUTF8(\\\"^(i/x>>5(ebyhumz*i1wkpk^orIs^Na.\\\");\\n        let niv = CryptoUtil.Data.parseHex(iv);\\n        let encrypted0 = CryptoUtil.AES.decrypt(ciphertext, key, {\\n            mode: \\\"AES/CBC/PKCS7Padding\\\",\\n            iv: niv\\n        });\\n\\n        return JSON.parse(encrypted0.toString());\\n        */\\nfunction decrypt(ciphertext, iv, t, unique_id, wifimac) {\\n    try {\\n        var key = generateKey(t, unique_id, wifimac);\\n        /*var cipherParams = CryptoJS.lib.CipherParams.create({\\n            ciphertext: CryptoJS.enc.Base64.parse(ciphertext)\\n        });\\n\\n        var decrypted = CryptoJS.AES.decrypt(cipherParams, CryptoJS.enc.Utf8.parse(key), {\\n            iv: CryptoJS.enc.Hex.parse(iv),\\n            mode: CryptoJS.mode.CBC,\\n            padding: CryptoJS.pad.Pkcs7\\n        });\\n\\n        var dec = decrypted.toString(CryptoJS.enc.Utf8);*/\\n        const CryptoUtil = $.require(\\\"hiker://assets/crypto-java.js\\\");\\n        let keydata = CryptoUtil.Data.parseUTF8(key);\\n        let ivdata = CryptoUtil.Data.parseHex(iv);\\n        let encrypted0 = CryptoUtil.AES.decrypt(ciphertext, keydata, {\\n            mode: \\\"AES/CBC/PKCS7Padding\\\",\\n            iv: ivdata\\n        });\\n        return encrypted0.toString();\\n    } catch (error) {\\n        log(\\\"Decryption failed \\\"+error.toString());\\n        throw error;\\n    }\\n}\\n\\nfunction getParams(t, unique_id, wifimac) {\\n    let params = {\\n        'akv': '2.8.1496',\\n        'apv': '1.3.6',\\n        'b': 'OnePlus',\\n        'd': unique_id,\\n        'm': 'PJX110',\\n        'mac': '',\\n        'n': 'PJX110',\\n        't': String(t),\\n        'wifiMac': String(wifimac),\\n    };\\n    return params;\\n}\\nfunction generateKey(t, unique_id, wifimac) {\\n    var params = getParams(t, unique_id, wifimac);\\n    var sortedKeys = Object.keys(params).sort();\\n    \\n    var concatenatedParams = '';\\n    for (var i = 0; i < sortedKeys.length; i++) {\\n        var key = sortedKeys[i];\\n        if (key !== 't') {\\n            concatenatedParams += params[key];\\n        }\\n    }\\n\\n    var hashedKey = h(concatenatedParams.split(''), t);\\n    return md5(hashedKey);\\n}\\nObject.assign(OpenApi.prototype, {\\n    getOpenTokenCode() {\\n        function get_qrcode_code(sid) {\\n            let res = fetch(\\\"https://openapi.aliyundrive.com/oauth/qrcode/\\\" + sid + \\\"/status\\\");\\n            return JSON.parse(res).authCode;\\n        }\\n\\n        let res = post(\\\"http://api.extscreen.com/aliyundrive/qrcode\\\", {\\n            body: JSON.stringify({\\n                \\\"scopes\\\": 'user:base,file:all:read,file:all:write',\\n                \\\"width\\\": 500,\\n                \\\"height\\\": 500,\\n            }),\\n        });\\n        let data = JSON.parse(res).data;\\n        let sid = data[\\\"sid\\\"];\\n        let body = {\\n            \\\"authorize\\\": 1,\\n            \\\"scope\\\": \\\"user:base,file:all:read,file:all:write\\\",\\n            \\\"drives\\\": [\\\"backup\\\", \\\"resource\\\"],\\n            \\\"scopes\\\": [\\\"user:base\\\", \\\"file:all:read\\\", \\\"file:all:write\\\"],\\n            \\\"sid\\\": sid\\n        }\\n        let headers = {\\n            'authorization': this.$this.reaccessTk\\n        };\\n        let res2 = this.$this.postApi(\\\"https://open.aliyundrive.com/oauth/users/qrcode/authorize?sid=\\\" + sid).body(body).headers(headers).errorWithRetry((e, _, http) => {\\n            this.$this.trySolve(e);\\n            http.mergeHeadAndBody({\\n                headers: {\\n                    'authorization': this.$this.reaccessTk,\\n                }\\n            });\\n            return true;\\n        }).start(true);\\n        return get_qrcode_code(sid);\\n    },\\n    getToken(body) {\\n\\n        let timestamp = String(JSON.parse(fetch(\\\"http://api.extscreen.com/timestamp\\\")).data.timestamp);\\n        let unique_id = generateUUID();\\n        let wifimac = generateWifiMac().toString();\\n        let res = post(\\\"http://api.extscreen.com/aliyundrive/v3/token\\\", {\\n            body: JSON.stringify(body),\\n            headers: Object.assign({\\n\\n                \\\"token\\\": \\\"6733b42e28cdba32\\\",\\n                'User-Agent': 'Mozilla/5.0 (Linux; U; Android 9; zh-cn; SM-S908E Build/TP1A.220624.014) AppleWebKit/533.1 (KHTML, like Gecko) Mobile Safari/533.1',\\n                //'Host': 'api.extscreen.com'\\n            }, getParams(timestamp, unique_id, wifimac))\\n        });\\n        let data = JSON.parse(res);\\n        let {\\n            iv,\\n            ciphertext\\n        } = data.data;\\n        return JSON.parse(decrypt(ciphertext, iv, timestamp, unique_id, wifimac));\\n    },\\n    getOpenToken() {\\n        return this.getToken({\\n            code: this.getOpenTokenCode(),\\n            grant_type: \\\"authorization_code\\\"\\n        });\\n    },\\n    refreshOpenToken() {\\n        return this.getToken({\\n            grant_type: \\\"refresh_token\\\",\\n            refresh_token: this.$this.openTokens.RefreshTokenOpen,\\n        });\\n    }\\n});\\n$.exports = OpenApi;\"},{\"col_type\":\"movie_3\",\"name\":\"å¼¹å¼¹PLAY\",\"path\":\"danmu#ttplay\",\"rule\":\"js:\\nfunction search(name) {\\n    const danmu = $.require(\\\"danmu\\\");\\n    let dmList = danmu.getDanMu(name);\\n    let d = [];\\n    for (let anime of dmList.animes) {\\n        d.push({\\n            title: \\\"[\\\" + anime.typeDescription + \\\"]\\\" + anime.animeTitle,\\n            url: $().lazyRule((episodes, animeTitle) => {\\n                let d = [];\\n                for (let episode of episodes) {\\n                    let dmTitle = animeTitle + \\\"_\\\" + episode.episodeTitle;\\n                    d.push({\\n                        title: episode.episodeTitle,\\n                        url: $(episode.episodeId).lazyRule((title) => {\\n                            const danmu = $.require(\\\"danmu\\\");\\n                            let path = danmu.getLocalDanMu(input, title) || danmu.downloadDanMu(input, title);\\n                            let danmuText = fetch(path);\\n                            if (!danmuText) return \\\"toast://è¿˜æ²¡æœ‰å¼¹å¹•å“Ÿ~\\\";\\n                            return path;\\n                        }, dmTitle),\\n                    });\\n                }\\n                return d;\\n            }, anime.episodes, anime.animeTitle),\\n        });\\n\\n    }\\n    return d;\\n}\\nsearch(input)\"}]","proxy":"","icon":"https://img.alicdn.com/imgextra/i2/O1CN01DOYcs71v3B6bOemVM_!!6000000006116-2-tps-512-512.png"}