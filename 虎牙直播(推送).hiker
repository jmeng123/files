{"last_chapter_rule":"","pageList":[],"title":"虎牙直播(推送)","author":"香雅情","version":1,"type":"live","url":"hiker://empty##fypage##","col_type":"movie_2","class_name":"","class_url":"","area_name":"","area_url":"","sort_name":"","year_name":"","sort_url":"","year_url":"","find_rule":"js:\nvar items = [];\n\nif (MY_PAGE == 1) {\n    items.push({\n        title: (getMyVar('huyazb', '0') == '1' ? '推送🟢' : '推送🔴'),\n        url: `hiker://empty@lazyRule=.js:getMyVar('huyazb','0')=='1'?putMyVar('huyazb','0'):putMyVar('huyazb','1');refreshPage();'toast://切换成功！'`,\n\n        col_type: 'scroll_button'\n    });\n    if (getMyVar('cathtml', '') == '') {\n        var cathtml = fetch('https://www.huya.com/g/', {\n            headers: {\n                'User-Agent': PC_UA\n            }\n        });\n        putMyVar('cathtml', cathtml);\n    }\n    //log(cathtml);\n    putMyVar('defacat', parseDomForHtml(getMyVar('cathtml', ''), '.game-list&&li&&a&&data-gid'));\n    var cate = parseDomForArray(getMyVar('cathtml', ''), '.game-list&&li');\n\n    for (let i = 0; i < cate.length; i++) {\n        //log(parseDomForHtml(cate[i], 'a&&Text'));\n        //log(parseDomForHtml(cate[i], 'a&&data-gid'));\n        items.push({\n            title: (getItem('huyazb', '0') == i ? '👇🏻' : '') + parseDomForHtml(cate[i], 'a&&Text'),\n            url: `hiker://empty@lazyRule=.js:setItem('huyazb', '` + i + `');setItem('huyacat','` + parseDomForHtml(cate[i], 'a&&data-gid') + `');refreshPage();'toast://切换成功！'`,\n\n            col_type: 'scroll_button'\n        });\n    }\n\n}\n\nvar html = fetch('https://www.huya.com/cache.php?m=LiveList&do=getLiveListByPage&gameId=' + getItem('huyacat', getMyVar('defacat')) + '&tagAll=0&page=' + MY_PAGE, {\n    headers: {\n        'User-Agent': PC_UA\n    }\n});\nvar list = JSON.parse(html).data.datas;\n//log(list[0]);\n\nfor (let j = 0; j < list.length; j++) {\n    var desc = list[j].introduction;\n    var img = list[j].screenshot;\n    var url = list[j].profileRoom;\n    var title = list[j].nick;\n    items.push({\n        title: title,\n        pic_url: img,\n        url: $(url).lazyRule((title, img) => {            \n            let html = ('video://https://m.huya.com/' + input);\n            return html\n          \n            if (getMyVar('huyazb', '0') == '1') {\n                return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(purl.replace(/\\&/g, '&'));\n            } else {\n                return html\n            }\n            //以下代码来自TyrantG虎牙直播\n            function getRealUrl(live_url) {\n                let [i, b] = live_url.split('?');\n                let r = i.split('/').pop();\n                let s = r.replace(/\\.(flv|m3u8)/, '');\n                let c_tmp = b.split('&').filter(n => n);\n                // let c = []\n                let n = {};\n                let c_tmp2 = [];\n                c_tmp.forEach((tmp, index) => {\n                    if (index < 3) {\n                        // c.push(tmp)\n                        n[tmp.split('=')[0]] = tmp.split('=')[1]\n                    } else {\n                        c_tmp2.push(tmp)\n                    }\n                });\n                let tmp2 = c_tmp2.join('&');\n                n[tmp2.split('=')[0]] = tmp2.split('=')[1];\n\n                let fm = decodeURIComponent(n.fm).split('&')[0];\n                let u = base64Decode(fm);\n                let p = u.split('_')[0];\n                let f = new Date().getTime() + '0000';\n                let ll = n.wsTime;\n                let t = '0';\n                let h = [p, t, s, f, ll].join('_');\n                let m = md5(h);\n                return (i + \"?wsSecret=\" + m + \"&wsTime=\" + ll + \"&u=\" + t + \"&seqid=\" + f + \"&\" + c_tmp2.pop()).replace('hls', 'flv').replace('m3u8', 'flv');\n            }\n\n        }, title, img),\n        desc: desc\n    });\n}\n\nsetHomeResult({\n    data: items\n});","searchFind":"js:\nvar json = JSON.parse(getResCode());\nvar res = {};\nvar d = [];\nfor (var i = 0; i < json.response[\"3\"].docs.length; i++) {\n    var j = json.response[\"3\"].docs[i];\n    d.push({\n        content: j.game_introduction,\n        url: 'video://https://m.huya.com/' +  j.room_id,\n        desc: j.gameName,\n        title: j.game_nick,\n        img: j.game_screenshot\n    })\n\n}\nres.data = d;\nsetSearchResult(res);","search_url":"https://search.cdn.huya.com/?m=Search&do=getSearchContent&plt=m&q=**&uid=0&app=11&v=4&typ=-5&start=fypage@-1@*40@&rows=40;get;utf-8;{User-Agent@Mozilla/5.0 (Linux; Android 10) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.132 Mobile Safari/537.36}","group":"⑤推送TBox","detail_col_type":"text_2","detail_find_rule":"","sdetail_col_type":"text_2","sdetail_find_rule":"","ua":"auto","preRule":"","pages":"[]","proxy":"","icon":""}