{"last_chapter_rule":"","pageList":[],"title":"翻译2重写","author":"","version":0,"type":"tool","url":"https://fanyi.youdao.com/index.html","col_type":"movie_3","class_name":"","class_url":"","area_name":"","area_url":"","sort_name":"","year_name":"","sort_url":"","year_url":"","find_rule":"js:\naddListener(\"onClose\", () => {\n    for (let it of listMyVarKeys()) {\n        clearMyVar(it);\n    }\n});\naddListener(\"onRefresh\", () => {\n    clearMyVar(\"t\");\n    clearMyVar(\"wd\");\n});\nvar dd = [];\ndd.push({\n    title: \"翻译\",\n    desc: \"请输入关键词\",\n    col_type: \"input\",\n    url: $.toString(() => {\n        if (!input) return 'toast://请输入需要翻译的关键词'\n        putMyVar('wd', input);\n        log(input)\n        refreshPage()\n        return \"hiker://empty\";\n    }),\n    extra: {\n        defaultValue: getMyVar('wd', '') || \"你好\",\n    }\n})\n\nlog(getMyVar('wd'))\nvar u = \"fanyideskweb\",\n    d = \"webfanyi\",\n    m = \"client,mysticTime,product\",\n    p = \"1.0.0\",\n    g = \"web\",\n    f = \"fanyi.web\",\n    h = 1,\n    A = 1,\n    v = 1,\n    y = \"wifi\",\n    T = 0;\nvar o = (new Date).getTime();\n//log(o)\n\nfunction S(e, t) {\n    return md5(`client=${u}&mysticTime=${e}&product=${d}&key=${t}`)\n}\nvar e = 'fsdsogkndfokasodnaso';\nvar sign = S(o, e);\n//log(sign);\nvar sign1 = S('1712281177683', 'fsdsogkndfokasodnaso')\n//log(sign1)\n\nvar data = {\n    'i': getMyVar('wd', '你好'),\n    'from': 'auto',\n    'to': '',\n    'dictResult': 'true',\n    'keyid': 'webfanyi',\n    'sign': S(o, e),\n    'client': 'fanyideskweb',\n    'product': 'webfanyi',\n    'appVersion': '1.0.0',\n    'vendor': 'web',\n    'pointParam': 'client,mysticTime,product',\n    'mysticTime': o.toString(),\n    'keyfrom': 'fanyi.web',\n    'mid': '1',\n    'screen': '1',\n    'model': '1',\n    'network': 'wifi',\n    'abtest': '0',\n    'yduuid': 'abcdefg'\n};\n\nvar headers = {\n    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36',\n    'Accept': 'application/json, text/plain, */*',\n    'Content-Type': 'application/x-www-form-urlencoded',\n    'Pragma': 'no-cache',\n    'Cache-Control': 'no-cache',\n    'sec-ch-ua': '\"Chromium\";v=\"118\", \"Google Chrome\";v=\"118\", \"Not=A?Brand\";v=\"99\"',\n    'sec-ch-ua-mobile': '?0',\n    'sec-ch-ua-platform': '\"Windows\"',\n    'Origin': 'https://fanyi.youdao.com',\n    'Sec-Fetch-Site': 'same-site',\n    'Sec-Fetch-Mode': 'cors',\n    'Sec-Fetch-Dest': 'empty',\n    'Referer': 'https://fanyi.youdao.com/',\n    'Accept-Language': 'zh-CN,zh;q=0.9',\n    /*'Cookie': 'OUTFOX_SEARCH_USER_ID=467699585@10.108.162.134; OUTFOX_SEARCH_USER_ID_NCOO=1567881656.3082445; DICT_DOCTRANS_SESSION_ID=OTdiZDA0ZmUtNDEzMS00MjcwLTg1YWItMDRjYWQ0NDk1ZGRi'*/\n};\n\nvar options = {\n    method: 'POST',\n    headers: headers,\n    body: data\n};\n\nvar res = post('https://dict.youdao.com/webtranslate', options);\n\nlog(res)\n\neval(getCryptoJS())\n\nvar key = 'ydsecret://query/key/B*RGygVywfNBwpmBaZg*WT7SIOUP2T0C9WHMZN39j^DAdaZhAnxvGcCY6VYFwnHl';\n\nvar key = 'ydsecret://query/key/B*RGygVywfNBwpmBaZg*WT7SIOUP2T0C9WHMZN39j^DAdaZhAnxvGcCY6VYFwnHl';\nvar iv = 'ydsecret://query/iv/C@lZe2YzHtZ2CYgaXKSVfsb7Y4QWHjITPPZ0nQp87fBeJ!Iv6v^6fvi2WN@bYpJ4';\n//res,key,iv\n\nfunction b(e) {\n    return r.createHash(\"md5\").update(e).digest()\n}\n\nfunction _(e) {\n    return r.createHash(\"md5\").update(e.toString()).digest(\"hex\")\n}\n\nfunction y(e) {\n    var bytes = hexToBytes(md5(e));\n    var arr = new Uint8Array(bytes);\n    return arr;\n    //return //CryptoJS.createHash(\"md5\").update(e).digest()\n}\n\nfunction toHexString(uint8Array) {\n    return hexString = Array.from(uint8Array).map(byte => byte.toString(16).padStart(2, '0')).join('');\n}\n\nfunction decodeData(res, key, iv) {\n    key = CryptoJS.MD5(key);\n    iv = CryptoJS.MD5(iv);\n    res = res.replace(/_/g, \"/\").replace(/-/g, \"+\");\n    const decipher = CryptoJS.AES.decrypt(res, key, {\n        'iv': iv,\n        'mode': CryptoJS.mode.CBC,\n        'padding': CryptoJS.pad.Pkcs7\n    });\n    let decrypted = decipher.toString(CryptoJS.enc.Utf8);\n    return decrypted\n}\n\nvar json = decodeData(res, key, iv);\nlog(json);\nvar a = json.replace(/\\\\|#/g, '');\nsaveFile('hiker://files/Jm/fanyi.json', a);\neval('data=' + fetch('hiker://files/Jm/fanyi.json'));\neval('y=' + JSON.stringify(data.translateResult).replace(/\\[|\\]/g, ''));\nvar dt = data.dictResult;\ntry {\n    dd.push({\n        title: y.srcPronounce ? y.srcPronounce : y.tgtPronounce,\n        url: 'copy://' + y.tgt,\n        desc: '原文：' + y.src + '\\t\\t\\t\\t\\t译文：' + y.tgt,\n        col_type: \"text_1\",\n    });\n    try {\n        dt.ce.word.trs.map(t => {\n            dd.push({\n                title: t.text,\n                url: 'copy://' + t.text,\n                desc: t.tran,\n                col_type: \"text_1\",\n            });\n        });\n    } catch {\n        var a = dt.ec.word;\n        a.trs.map(t => {\n            a.wfs.map(n => {\n\n                dd.push({\n                    title: t.pos + n.wf.value ? t.pos + n.wf.value : t.tran,\n                    url: 'copy://' + t.pos + n.wf.value ? t.pos + n.wf.value : t.tran,\n                    desc: t.tran + n.wf.namel ? t.tran + n.wf.name : '',\n                    col_type: \"text_1\",\n                });\n            });\n        });\n    }\n} catch {}\nsetResult(dd);","searchFind":"","search_url":"","group":"⑨其它","detail_col_type":"movie_1","detail_find_rule":"","sdetail_col_type":"movie_1","sdetail_find_rule":"","ua":"pc","preRule":"","pages":"[]","proxy":"","icon":""}